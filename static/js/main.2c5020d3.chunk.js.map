{"version":3,"sources":["workers/dds.worker.ts","workers/deal.worker.ts","webpack:///./src/workers/dds.worker.ts?517b","webpack:///./src/workers/deal.worker.ts?9d69","serviceWorker.ts","lib/index.ts","model/deck.ts","model/bridge.ts","model/system.ts","model/constraints.ts","parse/bid.peg.g.ts","parse/hand.peg.g.ts","parse/bid.ts","model/serialization.ts","parse/hand.ts","parse/index.ts","reducers/system.ts","lib/concurrency.ts","workers/index.ts","reducers/selection.ts","app/hooks.ts","components/Editor.tsx","model/score.ts","model/analyze.ts","services/server.ts","reducers/generator.ts","reducers/settings.ts","reducers/index.ts","components/SelectionDetails.tsx","components/Settings.tsx","model/stats.ts","components/core/BidPath.tsx","components/core/HandView.tsx","components/core/DoubleDummyResultView.tsx","components/Stats.tsx","components/core/Monad.tsx","components/SelectionGenerators.tsx","components/HandEditor.tsx","components/TestHands.tsx","components/index.tsx","app/store.ts","index.tsx"],"names":["inst","wrap","Worker","module","exports","f","this","Boolean","window","location","hostname","match","assertUnreachable","x","Error","JSON","stringify","ordAscending","array","pipe","number","Ord","ord","contramap","indexOf","ordDescending","flow","reverse","suits","eqSuit","eq","eqStrict","ordSuitDescending","rankStrings","RankB","t","i","RankC","is","validate","r","eqRank","ordRankAscending","ordRankDescending","ranks","readonlyArray","mapWithIndex","idx","_","decode","right","honors","takeRight","rankFromString","findIndex","r2","string","Eq","equals","option","chain","lookup","eqCard","struct","suit","rank","ordCardDescending","getMonoid","concat","c","cards","RNEA","makeBy","Math","floor","getOrdGroupedHand","zeroGroupedHand","S","H","D","C","groupHandBySuits","hand","readonlySet","toReadonlyArray","fromReadonlyArray","fold","groupBy","readonlyRecord","map","union","getUnionMonoid","newDeck","shuffle","browserCrypto","directions","eqDirection","eqHand","RS","getEq","eqDeal","strains","eqStrain","ordStrain","minors","boneChart","dealer","deal","boardNumber","nonContractBids","eqNonContractBid","isNonContractBid","b","RA","elem","eqContractBid","level","strain","ordContractBid","contractBids","apply","sequenceS","Apply","sort","isContractBid","eqBid","fromEquals","y","getHcp","modifier","foldMap","MonoidSum","card","max","zeroShape","sortShape","s","makeShape","counts","eqShape","zeroSpecificShape","groupHandBySuit","empty","getHandSpecificShape","length","semigroup","first","getHandShape","RT","snd","suitCounts","getOrElse","pathsWithoutRoot","K","tree","tail","getAllLeafPaths","Functor","node","paths","O","getSemigroup","prepend","filterMap","extendWithSiblingsInternal","siblings","make","value","forest","difference","toArray","extendWithSiblings","constConstraintTrue","constant","type","constConstraintFalse","contextualConstraintTypes","isContextualConstraint","separate","either","left","anyP","P","getMonoidAny","allP","getMonoidAll","constraintFalse","constFalse","exists","constTrue","forall","isPointRange","range","between","min","isSuitRange","getSuitsToCheck","shape","suitCompare","op","lt","leq","geq","gt","getComparator","toRankSet","isShape","handShape","isBalanced","isSemiBalanced","zeroContext","bid","path","force","none","primarySuit","secondarySuit","peers","contextL","Lens","fromProp","bidL","pathL","forceL","primarySuitL","secondarySuitL","peersL","contextO","lens","composeTraversal","fromTraversable","Traversable","Optional","fromOptionProp","forceO","quantifierT","quantifier","satisfies","traverseArray","existsT","identity","forallT","satisfiesBasic","suitHonors","cardSet","intersection","honorSet","isSubset","suitTop","filter","compare","minRank","count","or","not","record","ofS","of","satisfiesContextual","recur","constraints","constraint","gets","context","get","takeLeftWhile","cb","modify","set","findFirst","otherBid","some","splitAt","readonlyTuple","bimap","higher","lower","flatten","optionT","Do","apS","otherSuit","getOrElseW","satisfiesS","ap","evaluate","alternate","opener","responder","unfold","g","val","next","done","Gen","ASTKinds","preTraversal","info","postTraversal","satisfiesPath","zip","bindTo","bind","relay","boolean","MonoidAll","ordBid","fromCompare","a","ordConstrainedBid","bidTreeSorted","bids","validateS","isSome","resetForce","continueForce","constVoid","updateForce","isGameLevel","isSlamLevel","updateForceS","getOption","traverse","Applicative","checkPassS","checkPass","checkFinal","isNone","pathIsSound","forceCheck","result","finalCheck","treeIsSound","validateTree","and","Digit","literal","kind","parseInt","Number","Parser","input","pos","negating","memoSafe","$scope$Constraint$memo","Map","overallPos","line","offset","clear","$$dpth","$$cr","run","$scope$spec","$$res","matchBidSpec","match$EOF","Start","spec","$scope$bid","$scope$constraints","matchBid","matchBidSpecConstraintList","BidSpec","regexAccept","String","raw","matchConstraintList","BidSpecConstraintList","choice","matchBid_1","matchBid_2","matchContractBid","matchNonContractBid","$scope$level","$scope$specifier","matchDigit","matchBidSpecifier","ContractBid","specifier","matchBidSpecifier_1","matchBidSpecifier_2","matchWildcard","matchSuitSpecifier","$scope$v","Wildcard","v","matchSuitSpecifier_1","matchSuitSpecifier_2","matchSuitSpecifier_3","matchMajor","matchMinor","matchStrain","Major","Minor","matchPass","Pass","matchStrain_1","matchStrain_2","matchSuit","matchNotrump","matchSuit_1","matchSuit_2","matchSuit_3","matchSuit_4","matchClub","matchDiamond","matchHeart","matchSpade","Club","Diamond","Heart","Spade","Notrump","Honor","loop","matchConstraintListItem","$scope$constraint","matchConstraint","ConstraintListItem","$scope$pos","mark","memo","undefined","reset","$scope$oldMemoSafe","lastRes","lastPos","res","matchConstraint_1","matchConstraint_2","matchConstraint_3","matchConstraint_4","matchConstraint_5","matchConstraint_6","matchConstraint_7","matchConstraint_8","matchConstraint_9","matchConstraint_10","matchConstraint_11","matchConstraint_12","matchConstraint_13","matchConstraint_14","matchConstraint_15","matchConstraint_16","end","matchConst","matchOr","matchAnd","matchNot","matchOtherwise","matchDistribution","matchResponse","matchSuitRange","matchSuitBound","matchSuitComparison","matchSuitHonors","matchSuitTop","matchSuitRank","matchPointRange","matchPointBound","matchOtherBid","matchConst_1","matchConst_2","matchTrue","matchFalse","True","False","$scope$left","$scope$right","Or","And","matchNot_$0","Not","matchNot_$0_1","matchNot_$0_2","Otherwise","$scope$lower","$scope$upper","matchNumber","PointRange","upper","$scope$value","$scope$qualifier","matchBoundQualifier","PointBound","qualifier","$scope$suit","matchSuitRangeSpecifier","SuitRange","SuitBound","$scope$op","matchSuitComparisonOperator","SuitComparison","matchSuitComparisonOperator_1","matchSuitComparisonOperator_2","matchSuitComparisonOperator_3","matchSuitComparisonOperator_4","matchSuitComparisonOperator_5","SuitComparisonOperator_1","SuitComparisonOperator_2","SuitComparisonOperator_3","SuitComparisonOperator_4","SuitComparisonOperator_5","$scope$honors","matchHonor","SuitHonors","$scope$x","$scope$y","SuitTop","matchBoundQualifier_1","matchBoundQualifier_2","matchBoundQualifier_3","matchPlus","matchMinus","matchEquals","Plus","Minus","Equals","$scope$strain","OtherBid","matchDistribution_1","matchDistribution_2","matchDistribution_3","matchDistribution_4","matchDistribution_5","matchBalanced","matchSemiBalanced","matchUnbalanced","matchAnyShape","matchSpecificShape","Balanced","SemiBalanced","Unbalanced","AnyShape","$scope$S","$scope$H","$scope$D","$scope$C","SpecificShape","matchSuitRank_1","matchSuitRank_2","matchPrimary","matchSecondary","Primary","Secondary","matchResponse_1","matchResponse_2","matchResponse_3","matchResponse_4","matchForceOneRound","matchForceGame","matchForceSlam","matchRelay","ForceOneRound","ForceGame","ForceSlam","Relay","$scope$literal","mrk","ans","matchStart","ast","errs","rec","ErrorTracker","clearMemos","err","getErr","func","star","push","fn","fns","dpth","cr","reg","RegExp","lastIndex","tryConsume","substring","negated","exec","lineJmp","lind","oneg","rule","$scope$memoRes","$scope$result","et","finished","$EOF","SyntaxErr","expmatches","mxpos","regexset","Set","pmatches","att","has","add","getConnectiveItems","items","readonlyNonEmptyArray","constraintFromAST","fromPredicate","connectiveFromAST","zero","eitherT","suitFromAST","AST","strainFromAST","suitSpecifierFromAST","bindValueFromASTQualifier","head","slice","fromArray","h","split","bidFromAST","parseBid","parse","Card","$scope$hand","matchHand","Hand","$scope$cards","matchCard","Suit","$scope$c","handFromAST","parseHand","handE","encode","reduce","cur","intersperse","Monoid","convertErrors","d","foldMapWithIndex","FS","DE","toString","parseResultToEither","fromNullable","getDecoder","parser","mapLeft","decodeBid","bidSpec","constrainedBidFromAST","decodeHand","getRoot","blockKey","text","initialState","system","getPath","findFirstMap","append","createSlice","name","reducers","setSystem","state","action","root","parents","forEach","item","curr","depth","key","buildTree","payload","castDraft","actions","selectPathByKey","toNullable","selectErrors","n","compact","separated","getCompleteByTree","fromEither","getCompleteTree","withImplicitPasses","bs","selectCompleteBidSubtree","options","implicitPass","selectAllCompleteBidPaths","selectSystemValid","serializedHandL","iso","decodedSerializedHandL","reverseGet","getUuidQuads","UuidTool","isUuid","Uuid","uuid","id","toBytes","takeLeft","byte","DealUuidB","replicate","directionIndex","every","dealUuidToDeal","fst","encodeDealAsUuid","trivial","direction","p","chunksOf","serializedDealL","serializedBoardL","serializedContractBidL","charAt","serializedBidL","SerializedBidPathB","serializedBidPathL","maxProcessors","navigator","hardwareConcurrency","parallelize","from","observeDealsSerial","batchSize","w","DealWorker","genDeals","observable","fromTask","repeat","observeBatchedDealsInfinite","ceil","log","take","observeResultsSerial","boards","DDSWorker","board","getResult","observeResultsParallel","concurrency","perWorker","remainder","selectedBlockKey","setHands","hands","createAsyncThunk","l","N","E","W","genBoardFromHands","toTask","genUntilCondition","limit","condition","tailRec","deck","genMatchingOf","partition","setSelectedBlockKey","setHand","reducer","meta","prepare","genOnce","getHandsMatchingPath","genHandsNotMatchingAnyOf","predicate","openerMinHcp","genHandsMatchingExactlyOneOf","genHandsMatchingMoreThanOneOf","extraReducers","builder","addCase","fulfilled","selectHand","useAppDispatch","useDispatch","useAppSelector","useSelector","Editor","useState","EditorState","createEmpty","editorState","setEditorState","dispatch","onChange","useCallback","localStorage","setItem","convertToRaw","getCurrentContent","getBlockMap","getKey","getText","getDepth","getItemsFromBlocks","getSelection","getFocusKey","useEffect","savedEditorState","getItem","createWithContent","convertFromRaw","RichUtils","toggleBlockType","keyBindingFn","e","keyCode","newEditorState","onTab","getDefaultKeyBinding","contractPointMultiplier","contractModMultiplier","subtractBookTricks","tricks","making","contract","oddTricks","getOddTricks","whenMaking","contractPoints","vulnerableMultiplier","isVulnerable","getModified","doubledPenalties","partScorePoints","score","scoreComponents","overtrickPoints","overtricks","multiplier","slamPoints","modifierPoints","penaltyPoints","swap","undertricks","gamePoints","ScoreC","flattenNestedCounts","flap","traverseWithIndex","writer","getApplicative","tell","cs","pass","table","RR","inner","outer","outerKey","innerKey","transpose","initialBids","baseUrl","process","safeFetch","taskEither","tryCatchK","toError","ping","fetch","chainTaskK","response","filterOrElse","getRequestBody","hcp","toUndefined","getRequestBodyWithoutSolution","postDeals","deals","task","body","method","putDeals","getProgress","updateProgress","M","decrement","progress","current","results","working","generate","mapSnd","getResults","reportDeals","reportResults","getUnionSemigroup","selectAllDeals","generateCount","setInitial","Object","keys","setProperty","setSettingsProperty","setInitialSettings","selection","generator","settings","rootEpic","combineEpics","action$","state$","observeDealsParallel","bufferCount","concatWith","vulnerability","observableEither","fromObservable","chainFirst","fromTaskEither","EMPTY","selectHandsSatisfySelectedPath","o","sequence","selectBidsByKey","selectPathsSatisfyHands","ordStats","selectSatisfyStats","ra","SelectionDetails","selected","last","selectNodeByKey","join","SettingsItem","label","prop","onChanged","children","newValue","target","style","width","Settings","stored","newSettings","checked","SerializedKeyL","columns","sequenceT","getStats","ddt","fromFoldable","Foldable","aq","aggregate","rollup","object","mapFst","average","mean","stdev","SuitSpan","styled","span","ContractBidView","className","NonContractBidView","BidPath","RankList","ol","RankListItem","li","RankView","SuitList","SuitListItem","SuitView","HandView","groupedHand","StrainSpan","DoubleDummyTableView","fontWeight","verticalAlign","round","DoubleDummyResultView","StatsPath","dds","selectResultsByPath","stats","averages","stdevs","onClick","SatisfyStats","Progress","selectProgress","Stats","generating","rules","errors","valid","showGenerate","draw","Option","onSuccess","onNone","GenerateOnce","GenerateMatchZero","bidPaths","minHcp","setMinHcp","GenerateMatchOne","GenerateMatchMany","GenerateMatchSelected","selectBlockKey","bidPath","nodes","unfoldTree","n0","ns","selectCompleteByKey","SelectionGenerators","HandInput","setValue","storageKey","encodedHand","onSetHand","savedHand","placeholder","onBlur","HandCol","th","HandEditor","getResultCallback","TestHands","App","display","float","rel","href","epicMiddleware","createEpicMiddleware","store","configureStore","middleware","getDefaultMiddleware","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.2c5020d3.chunk.js","sourcesContent":["var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/runner/work/bridge/bridge/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/runner/work/bridge/bridge/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/runner/work/bridge/bridge/src/workers/dds.worker.ts\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/runner/work/bridge/bridge/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/runner/work/bridge/bridge/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/runner/work/bridge/bridge/src/workers/deal.worker.ts\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"a38611fc77beb72bce00.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"044157630f2fba7c9ee6.worker.js\");\n};","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import { number, ord, readonlyNonEmptyArray } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\n\nexport const assertUnreachable = (x: never) => {\n  throw new Error (`shouldn't get here with ${JSON.stringify(x)}`)\n}\n\nexport const debug = <T>(x: T) => { debugger; return x }\n\nexport const ordAscending = <T>(array: readonlyNonEmptyArray.ReadonlyNonEmptyArray<T>) =>\n  pipe(number.Ord, ord.contramap<number, T>(x => array.indexOf(x)))\n\nexport const ordDescending = flow(ordAscending, ord.reverse)\n\n","import { either, eq, number, option, ord, readonlyArray, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet, string } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport * as t from 'io-ts';\nimport { browserCrypto, shuffle } from 'random-js';\nimport { ordAscending, ordDescending } from '../lib';\n\n\nexport const suits = ['C', 'D', 'H', 'S'] as const\nexport type Suit = typeof suits[number]\nexport const eqSuit : eq.Eq<Suit> = eq.eqStrict\nexport const ordSuitDescending : ord.Ord<Suit> = ordDescending(suits)\nexport const ordSuitAscending : ord.Ord<Suit> = ordAscending(suits)\n\nexport const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A'] as const\nexport type RankString = typeof rankStrings[number]\nconst RankB = t.brand(t.number, (i) : i is t.Branded<number, { readonly Rank: unique symbol }> => i >= 2 && i <= 14, 'Rank')\nexport const RankC = new t.Type('Rank', RankB.is, RankB.validate, r => rankStrings[r - 2])\nexport type Rank = t.TypeOf<typeof RankC>\nexport const eqRank : eq.Eq<Rank> = eq.eqStrict\nexport const ordRankAscending : ord.Ord<Rank> = number.Ord\nexport const ordRankDescending : ord.Ord<Rank> = pipe(ordRankAscending, ord.reverse)\nexport const ranks =\n  pipe(rankStrings,\n    readonlyArray.mapWithIndex((idx, _) =>\n      pipe(idx + 2,\n        RankC.decode,\n        x => (x as either.Right<Rank>).right)))\nexport const honors =\n  pipe(ranks, readonlyArray.takeRight(5))\nexport const rankFromString = (r: string) =>\n  pipe(rankStrings,\n    readonlyArray.findIndex(r2 => { return string.Eq.equals(r, r2) }),\n    option.chain(idx =>\n      pipe(ranks, readonlyArray.lookup(idx))))\n\nexport interface Card {\n  suit: Suit\n  rank: Rank\n}\nexport const cardToString = (c: Card) =>\n  `${c.suit}${RankC.encode(c.rank)}`\nexport const eqCard : eq.Eq<Card> = eq.struct({\n  suit: eqSuit,\n  rank: eqRank\n})\nexport const ordCardDescending : ord.Ord<Card> = ord.getMonoid<Card>().concat(\n  pipe(ordSuitDescending, ord.contramap(c => c.suit)),\n  pipe(ordRankDescending, ord.contramap(c => c.rank))\n)\n\nexport const cards: RNEA.ReadonlyNonEmptyArray<Card> =\n  pipe(52, RNEA.makeBy(i => ({\n    suit: suits[Math.floor(i / 13)],\n    rank: (RankC.decode((i % 13) + 2) as either.Right<Rank>).right\n  })))\n\nexport type Hand = ReadonlySet<Card>\nexport type GroupedHand = readonlyRecord.ReadonlyRecord<Suit, ReadonlyArray<Rank>>\nexport const getOrdGroupedHand = <T>() =>\n  ord.contramap(([suit, _]: readonly [Suit, T]) => suit)(ordSuitDescending)\nexport const zeroGroupedHand : GroupedHand = ({\n  S: [],\n  H: [],\n  D: [],\n  C: [],\n})\n\nexport const groupHandBySuits = (hand: Hand) : GroupedHand =>\n  pipe(hand,\n    readonlySet.toReadonlyArray(ordCardDescending),\n    RNEA.fromReadonlyArray,\n    option.fold(() => zeroGroupedHand, flow(\n      RNEA.groupBy(c => c.suit),\n      readonlyRecord.map(RNEA.map(c => c.rank)),\n      readonlyRecord.union(readonlyArray.getUnionMonoid(eqRank))(zeroGroupedHand)\n    )))\n\nexport type Deck = RNEA.ReadonlyNonEmptyArray<Card>\n\nexport const newDeck = () : Deck =>\n  shuffle(browserCrypto, [...cards]) as unknown as Deck\n","import { apply, eq, number, option, ord, readonlyArray as RA, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet as RS, readonlyTuple as RT, refinement, semigroup, string } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\n\nimport { ordAscending } from '../lib';\nimport { Card, Deck, eqCard, Hand, ordCardDescending, Suit, suits } from './deck';\n\nexport const directions = ['N', 'E', 'S', 'W'] as const\nexport type Direction = typeof directions[number]\nexport const eqDirection : eq.Eq<Direction> = string.Eq\nexport const ordDirection = ordAscending(directions)\n\nexport const partnerships = [\"NorthSouth\", \"EastWest\"] as const\nexport type Partnership = typeof partnerships[number]\nexport const eqPartnership : eq.Eq<Partnership> = string.Eq\nexport const ordPartnership = ordAscending(partnerships)\n\nexport const getPartnershipByDirection = (d: Direction): Partnership =>\n  (d === 'N' || d === 'S') ? \"NorthSouth\" : \"EastWest\"\n\nexport type Deal = readonlyRecord.ReadonlyRecord<Direction, Hand>\nexport type Player = {\n  direction: Direction\n  hand: Hand\n}\nexport const eqHand : eq.Eq<Hand> = RS.getEq(eqCard)\n\nexport const deal = (deck: Deck) : Deal =>\n  pipe(directions,\n    RNEA.zip(RNEA.chunksOf(13)(deck)),\n    RNEA.groupBy(RT.fst),\n    readonlyRecord.map(flow(RNEA.head, RT.snd, RS.fromReadonlyArray(eqCard))),\n    (x: readonlyRecord.ReadonlyRecord<Direction, Hand>) => x)\nexport const eqDeal : eq.Eq<Deal> =\n  readonlyRecord.getEq<Direction, Hand>(eqHand)\n\nexport const vulnerabilities = [\"Neither\", \"NorthSouth\", \"EastWest\", \"Both\"] as const\nexport type Vulnerability = typeof vulnerabilities[number]\n\nexport const getIsVulnerable = (dir: Direction, vul: Vulnerability) =>  \n  !(vul === \"Neither\") && ((vul === \"Both\") || getPartnershipByDirection(dir) === vul)\n\nexport const strains = [...suits, 'N'] as const\nexport type Strain = typeof strains[number]\nexport const eqStrain : eq.Eq<Strain> = eq.eqStrict\nexport const ordStrain : ord.Ord<Strain> = ordAscending(strains)\n\nexport const minors: ReadonlyArray<Strain> = ['C', 'D']\nexport const majors: ReadonlyArray<Strain> = ['H', 'S']\n\nexport interface Board {\n  dealer: Direction\n  deal: Deal\n}\nexport const eqBoard : eq.Eq<Board> = eq.struct({\n  dealer: eqDirection,\n  deal: eqDeal\n})\n\nexport interface BoardWithDetail extends Board {\n  number: number\n  vulnerability: Vulnerability\n}\n\nconst boneChart = (boardNumber: number) : Vulnerability => {\n  switch ((boardNumber % 16) + 1) {\n    case 1: case 8: case 11: case 14: return \"Neither\"\n    case 2: case 5: case 12: case 15: return \"NorthSouth\"\n    case 3: case 6: case 9:  case 16: return \"EastWest\"\n    case 4: case 7: case 10: case 13: return \"Both\"\n    default: throw Error(\"Not possible\")\n  }\n}\n\nexport const makeBoard = (number: number) => (deal: Deal) : BoardWithDetail => ({\n  number,\n  dealer: directions[(number - 1) % directions.length],\n  deal,\n  vulnerability: boneChart(number)\n})\n\nexport const nonContractBids = [\"Pass\", \"Double\", \"Redouble\"] as const\nexport type NonContractBid = typeof nonContractBids[number]\nexport const eqNonContractBid : eq.Eq<NonContractBid> = string.Eq\nexport const isNonContractBid = (b: unknown) : b is NonContractBid =>\n  typeof b === \"string\" && pipe(nonContractBids, RA.elem<string>(string.Eq)(b))\n\nexport interface ContractBid {\n  level: number\n  strain: Strain\n}\nexport const eqContractBid : eq.Eq<ContractBid> = eq.struct({\n  level: number.Eq,\n  strain: string.Eq\n})\nexport const ordContractBid : ord.Ord<ContractBid> =\n  ord.getMonoid<ContractBid>().concat(\n    pipe(number.Ord, ord.contramap(c => c.level)),\n    pipe(ordStrain, ord.contramap(c => c.strain))\n  )\nexport const contractBids : ReadonlyArray<ContractBid> =\n  pipe(\n    apply.sequenceS(RA.Apply)(({\n      level: RA.makeBy(7, level => level + 1),\n      strain: strains\n    })),\n    RA.sort(ordContractBid))\n\nexport type Bid = NonContractBid | ContractBid\nexport const isContractBid = (b: Bid): b is ContractBid => !isNonContractBid(b)\n\nexport const eqBid : eq.Eq<Bid> = eq.fromEquals((x, y) =>\n  (isNonContractBid(x) && isNonContractBid(y) && eqNonContractBid.equals(x, y)) ||\n  (!isNonContractBid(x) && !isNonContractBid(y) && eqContractBid.equals(x, y)))\n\nexport const isGameLevel = (bid: Bid) =>\n  isContractBid(bid) && ord.geq(ordContractBid)(bid, { level: 3, strain: \"N\" })\nexport const isSlamLevel = (bid: Bid) =>\n  isContractBid(bid) && ord.gt(ordContractBid)(bid, { level: 5, strain: \"N\" })\n\nexport const contractModifiers = [\"Undoubled\", \"Doubled\", \"Redoubled\"] as const\nexport type ContractModifier = typeof contractModifiers[number]\nexport interface Contract extends ContractBid {\n  modifier: ContractModifier\n}\nexport const eqContract : eq.Eq<Contract> = eq.struct({\n  level: number.Eq,\n  strain: string.Eq,\n  modifier: string.Eq\n})\nexport const fromBid = (bid: ContractBid): Contract =>\n  ({ ...bid, modifier: \"Undoubled\" })\n\nexport type Auction = RNEA.ReadonlyNonEmptyArray<Bid>\nconst consecutivePasses = [\"Pass\", \"Pass\", \"Pass\"] as const\nexport type NonPassAuction = Auction & [...Auction, ...typeof consecutivePasses]\nconst passout = [\"Pass\", \"Pass\", \"Pass\", \"Pass\"] as const\nexport type PassAuction = typeof passout\nexport type CompletedAuction = NonPassAuction | PassAuction\nexport const eqAuction : eq.Eq<Auction> = RNEA.getEq(eqBid)\nexport const isCompletedAuction : refinement.Refinement<Auction, CompletedAuction> = (a): a is CompletedAuction =>\n  a.length >= 4 &&\n  (eqAuction.equals(a, passout) || eqAuction.equals(a.slice(a.length - 3) as unknown as Auction, consecutivePasses))\n\nexport interface BoardWithAuction extends Board {\n  auction: Auction \n}\nexport interface BoardWithCompletedAuction extends BoardWithAuction {\n  auction: CompletedAuction\n}\n\nexport const getCardHcp = (card: Card) =>\n  Math.max(0, card.rank - 10)\n\nexport const getHcp =\n  flow(\n    RS.toReadonlyArray(ordCardDescending),\n    RA.foldMap(number.MonoidSum)(getCardHcp))\n\nexport type Shape = readonly [number, number, number, number]\nexport const zeroShape: Shape = [0, 0, 0, 0]\nexport const sortShape = (s: Shape) => pipe(s, RA.sort(ord.reverse(number.Ord))) as Shape\nexport const makeShape = (...counts: Shape) =>\n  pipe(counts, sortShape)\nexport const eqShape : eq.Eq<Shape> =\n  eq.contramap(sortShape)(RA.getEq(number.Eq))\n\nexport type SpecificShape = Record<Suit, number>\nexport const makeSpecificShape = (s: number, h: number, d: number, c: number) : SpecificShape => ({\n  S: s,\n  H: h,\n  D: d,\n  C: c\n})\nexport const zeroSpecificShape = makeSpecificShape(0, 0, 0, 0)\n\nexport const groupHandBySuit = (hand: Hand) =>\n  pipe(hand,\n    RS.toReadonlyArray(ordCardDescending),\n    RNEA.fromReadonlyArray,\n    option.fold(() => readonlyRecord.empty, flow(\n      RNEA.groupBy(c => c.suit),\n      readonlyRecord.mapWithIndex((s: Suit, cards: RNEA.ReadonlyNonEmptyArray<Card>) => cards))))\n\nexport const getHandSpecificShape = (hand: Hand) : SpecificShape =>\n  pipe(hand,\n    groupHandBySuit,\n    readonlyRecord.map(x => x.length),\n    readonlyRecord.union(semigroup.first<number>())(zeroSpecificShape),\n    (suits: readonlyRecord.ReadonlyRecord<Suit, number>) => suits)\n\nexport const getHandShape = (hand: Hand) : Shape =>\n  pipe(hand,\n    getHandSpecificShape,\n    readonlyRecord.toReadonlyArray,\n    RA.map(RT.snd),\n    suitCounts => RA.mapWithIndex((idx, _) =>\n      pipe(suitCounts, RA.lookup(idx), option.getOrElse(() => 0)))(zeroShape)) as Shape\n","import { either, eq, hkt, option as O, readonlyArray as RA, readonlyNonEmptyArray as RNEA, tree } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { Functor1 } from 'fp-ts/lib/Functor';\n\nimport { ConstrainedBid, Constraint } from '../model/constraints';\nimport { Bid } from './bridge';\n\nexport type Path<T> = RNEA.ReadonlyNonEmptyArray<T>\nexport type Paths<T> = RNEA.ReadonlyNonEmptyArray<Path<T>>\n\nexport const pathsWithoutRoot = <F extends hkt.URIS>(K: Functor1<F>) => <A, B>(f: (a: A, bs: ReadonlyArray<hkt.Kind<F, RNEA.ReadonlyNonEmptyArray<B>>>) => hkt.Kind<F, RNEA.ReadonlyNonEmptyArray<B>>) =>\n  flow(tree.fold(f),\n    x => K.map(x, RNEA.tail))\n\n// root node is fake, so descend one level and then reconstruct the tree\nexport const filterIncomplete = <E, A>(t: tree.Tree<O.Option<either.Either<E, A>>>) =>\n  pipe(\n    t.forest,\n    RA.map(tree.traverse(O.Applicative)(O.chain(O.fromEither))),\n    forest => tree.make<A | null>(null, pipe(forest, RA.compact, RA.toArray))) as tree.Tree<A> // null hack at root node\n\nexport const getAllLeafPaths = <T>(tree: tree.Tree<T>) =>\n  pipe(tree,\n    pathsWithoutRoot(RNEA.Functor)((node: T, paths: ReadonlyArray<Paths<T>>) =>\n      pipe(paths,\n        RNEA.fromReadonlyArray,\n        O.fold(() => [[node]],\n          RNEA.foldMap(RNEA.getSemigroup<Path<T>>())(RNEA.map(RA.prepend(node)))))),\n    RA.filterMap(RNEA.fromReadonlyArray))\n\nexport interface BidInfo {\n  bid: Bid\n  siblings: ReadonlyArray<ConstrainedBid>\n  constraint: Constraint\n}\nexport type BidPath = Path<BidInfo>\nexport type BidPaths = Paths<BidInfo>\nexport type BidTree = tree.Tree<BidInfo>\n\nconst extendWithSiblingsInternal = <T>(eq: eq.Eq<T>) => (siblings: ReadonlyArray<T>) => (t: tree.Tree<T>) : tree.Tree<T & { siblings: ReadonlyArray<T> }> =>\n  tree.make(\n    ({ ...t.value, siblings }),\n    pipe(t.forest, RA.map(\n      pipe(t.forest,\n        RA.map(t => t.value),\n        x => t.value === null ? x : RA.difference(eq)([t.value])(x), // end null hack\n        extendWithSiblingsInternal(eq))),\n      RA.toArray))\n\nexport const extendWithSiblings = <T>(eq: eq.Eq<T>) => extendWithSiblingsInternal(eq)([])","import { boolean, either, eq, hkt, identity as id, number, option as O, optionT, ord, predicate as P, readonlyArray as RA, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet, readonlyTuple, record, state as S, string } from 'fp-ts';\nimport { eqStrict } from 'fp-ts/lib/Eq';\nimport { constant, constFalse, constTrue, constVoid, flow, identity, pipe } from 'fp-ts/lib/function';\nimport { fromTraversable, Lens, lens, Optional } from 'monocle-ts';\n\nimport { assertUnreachable } from '../lib';\nimport { Bid, ContractBid, eqBid, eqShape, getHandShape, getHandSpecificShape, getHcp, groupHandBySuit, isContractBid, isGameLevel, isSlamLevel, makeShape, ordContractBid, Shape as AnyShape, SpecificShape } from './bridge';\nimport { eqRank, eqSuit, Hand, honors, ordRankAscending, Rank, Suit, suits } from './deck';\nimport { BidInfo, BidPath, BidTree, getAllLeafPaths } from './system';\n\nexport interface ConstraintPointRange {\n  type: \"PointRange\"\n  min: number\n  max: number\n}\n\nexport type SuitRangeSpecifier = \"Major\" | \"Minor\" | Suit // | \"OtherMajor\" | \"OtherMinor\"\nexport interface ConstraintSuitRange {\n  type: \"SuitRange\"\n  suit: SuitRangeSpecifier\n  min: number\n  max: number\n}\n\nexport type SuitComparisonOperator = \"<\" | \"<=\" | \"=\" | \">=\" | \">\"\nexport interface ConstraintSuitComparison {\n  type: \"SuitComparison\",\n  left: Suit,\n  right: Suit,\n  op: SuitComparisonOperator\n}\n\nexport interface ConstraintSuitHonors {\n  type: \"SuitHonors\",\n  suit: Suit,\n  honors: ReadonlyArray<Rank>\n}\n\nexport interface ConstraintSuitTop {\n  type: \"SuitTop\",\n  suit: Suit,\n  count: number,\n  minRank: Rank\n}\n\nexport interface ConstraintSuitPrimary {\n  type: \"SuitPrimary\",\n  suit: Suit\n}\nexport interface ConstraintSuitSecondary {\n  type: \"SuitSecondary\",\n  suit: Suit\n}\nexport type ConstraintSuitRank = ConstraintSuitPrimary | ConstraintSuitSecondary\n\nexport interface ConstraintConst {\n  type: \"Constant\",\n  value: boolean\n}\nexport const constConstraintTrue  = constant<Constraint>({ type: \"Constant\", value: true })\nexport const constConstraintFalse = constant<Constraint>({ type: \"Constant\", value: false })\n\nexport interface ConstraintConjunction {\n  type: \"Conjunction\"\n  constraints: RNEA.ReadonlyNonEmptyArray<Constraint>\n}\nexport interface ConstraintDisjunction {\n  type: \"Disjunction\"\n  constraints: RNEA.ReadonlyNonEmptyArray<Constraint>\n}\nexport interface ConstraintNegation {\n  type: \"Negation\"\n  constraint: Constraint\n}\n\ninterface ConstraintAnyShape {\n  type: \"AnyShape\"\n  counts: AnyShape\n}\n\nexport interface ConstraintSpecificShape {\n  type: \"SpecificShape\",\n  suits: SpecificShape\n}\n\nexport interface ConstraintDistribution {\n  type: \"Balanced\" | \"SemiBalanced\" | \"Unbalanced\"\n}\n\nexport interface ConstraintResponse {\n  type: \"ForceOneRound\" | \"ForceGame\" | \"ForceSlam\"\n}\n\nexport interface ConstraintOtherwise {\n  type: \"Otherwise\"\n}\n\nexport interface ConstraintRelayResponse {\n  type: \"Relay\",\n  bid: ContractBid\n}\n\nexport interface ConstraintOtherBid {\n  type: \"OtherBid\",\n  bid: ContractBid\n}\n\nexport type ConstraintForce =\n    ConstraintResponse\n  | ConstraintRelayResponse\n\nexport type Constraint =\n  | ConstraintConst\n  | ConstraintConjunction\n  | ConstraintDisjunction\n  | ConstraintNegation\n  | ConstraintOtherwise\n  | ConstraintOtherBid\n  | ConstraintPointRange\n  | ConstraintSuitRange\n  | ConstraintSuitComparison\n  | ConstraintSuitRank\n  | ConstraintSuitHonors\n  | ConstraintSuitTop\n  | ConstraintDistribution\n  | ConstraintAnyShape\n  | ConstraintSpecificShape\n  | ConstraintForce\n\nconst contextualConstraintTypes = [\n  \"Conjunction\",\n  \"Disjunction\",\n  \"Negation\",\n  \"Otherwise\",\n  \"OtherBid\",\n  \"ForceOneRound\",\n  \"ForceGame\",\n  \"ForceSlam\",\n  \"Relay\",\n  \"SuitPrimary\",\n  \"SuitSecondary\",\n] as const\n\ntype ContextualConstraintType = typeof contextualConstraintTypes[number]\ntype BasicConstraint = Exclude<Constraint, { type: ContextualConstraintType }>\ntype ContextualConstraint = Extract<Constraint, { type: ContextualConstraintType }>\n\nconst isContextualConstraint = (c: Constraint) : c is ContextualConstraint =>\n  RA.elem(string.Eq as eq.Eq<Constraint[\"type\"]>)(c.type)(contextualConstraintTypes)\n\nconst separate = (c: Constraint) : either.Either<ContextualConstraint, BasicConstraint> =>\n  isContextualConstraint(c) ? either.left(c) : either.right(c as BasicConstraint)\n\nexport interface ConstrainedBid {\n  bid: Bid\n  constraint: Constraint\n}\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst anyP = P.getMonoidAny<Hand>()\nconst allP = P.getMonoidAll<Hand>()\nconst constraintFalse : P.Predicate<Hand> = constFalse\nconst constraintTrue : P.Predicate<Hand> = constTrue\nconst exists = pipe(anyP, RA.foldMap)\nconst forall = pipe(allP, RA.foldMap)\n/* eslint-enable @typescript-eslint/no-unused-vars */\n\nconst rangeCheck = (range: { min: number, max: number }) => ord.between(number.Ord)(range.min, range.max)\n\nexport const isPointRange =\n  flow(rangeCheck, P.contramap(getHcp))\n\nexport const isSpecificShape = (shape: SpecificShape) =>\n  flow(getHandSpecificShape, suits => record.getEq(eqStrict).equals(suits, shape))\n\nexport const isSuitRange = (range: ConstraintSuitRange) => {\n  const getSuitsToCheck: readonly Suit[] =\n    range.suit === \"Major\" ? [\"S\", \"H\"] :\n    range.suit === \"Minor\" ? [\"D\", \"C\"] :\n    [range.suit]\n  return flow(getHandSpecificShape, shape =>\n    pipe(getSuitsToCheck, RA.exists(s => ord.between(number.Ord)(range.min, range.max)(shape[s]))))\n}\n\nconst getComparator = (op: SuitComparisonOperator) => {\n  switch (op) {\n    case \"<\" : return ord.lt(number.Ord)\n    case \"<=\": return ord.leq(number.Ord)\n    case \"=\" : return number.Eq.equals\n    case \">=\": return ord.geq(number.Ord)\n    case \">\" : return ord.gt(number.Ord)\n    default  : return assertUnreachable(op)\n  }\n}\n\nexport const suitCompare = (op: SuitComparisonOperator) => (left: Suit, right: Suit) =>\n  flow(getHandSpecificShape,\n    shape => getComparator(op)(shape[left], shape[right]))\n\nexport const suitPrimary = (suit: Suit) =>\n  pipe(suits,\n    RA.splitAt(suits.indexOf(suit)),\n    readonlyTuple.bimap(\n      flow(RA.tail,\n        O.fold(() => [],\n          RA.map(higher => suitCompare(\"<\")(higher, suit)))),\n      RA.map(lower => suitCompare(\"<=\")(lower, suit))),\n    RA.flatten,\n    RA.prepend(isSuitRange({ type: \"SuitRange\", suit, min: 5, max: 13 })),\n    forall(identity))\n\nexport const suitSecondary = (secondarySuit: Suit) => (primarySuit: Suit) =>\n  pipe(RA.Do,\n    RA.apS('suit', [secondarySuit, primarySuit]),\n    RA.apS('otherSuit', pipe(suits, RA.difference(eqSuit)([secondarySuit, primarySuit]))),\n    RA.filter(({ suit, otherSuit }) => !eqSuit.equals(suit, otherSuit)),\n    RA.map(({ suit, otherSuit }) => suitCompare(\">\")(suit, otherSuit)),\n    RA.concat([\n      isSuitRange({ type: \"SuitRange\", suit: secondarySuit, min: 4, max: 13 }),\n      suitCompare(\">=\")(primarySuit, secondarySuit)\n    ]),\n    forall(identity))\n\nconst toRankSet = readonlySet.fromReadonlyArray(eqRank)\n\nconst suitHonors = (suitHonors: ConstraintSuitHonors) =>\n  flow(\n    groupHandBySuit,\n    readonlyRecord.lookup(suitHonors.suit),\n    O.fold(constFalse, cards => {\n      const cardSet = pipe(cards,\n        RA.map(c => c.rank),\n        toRankSet,\n        readonlySet.intersection(eqRank)(toRankSet(honors)))\n      const honorSet = pipe(suitHonors.honors, toRankSet)\n      return pipe(honorSet, readonlySet.isSubset(eqRank)(cardSet))\n    }))\n\nconst suitTop = (suitTop: ConstraintSuitTop) =>\n  flow(groupHandBySuit,\n    readonlyRecord.lookup(suitTop.suit),\n    O.fold(constFalse, flow(\n      RA.map(c => c.rank),\n      RA.filter(r => ordRankAscending.compare(r, suitTop.minRank) >= 0),\n      cards => cards.length >= suitTop.count)))\n\nexport const isShape = (shape: AnyShape) =>\n  flow(getHandShape, handShape =>\n    eqShape.equals(shape, handShape))\n\nexport const isBalanced =\n  pipe([\n    makeShape(4, 3, 3, 3),\n    makeShape(5, 3, 3, 2),\n    makeShape(4, 4, 3, 2),\n    makeShape(5, 5, 3, 2),\n  ], exists(isShape))\n\nexport const isSemiBalanced =\n  pipe([\n    makeShape(5, 4, 2, 2),\n    makeShape(6, 3, 2, 2)\n  ], exists(isShape))\n\nexport interface BidContext {\n  bid: Bid,\n  path: ReadonlyArray<Bid>\n  force: O.Option<ConstraintForce>\n  primarySuit: O.Option<Suit>\n  secondarySuit: O.Option<Suit>,\n  peers: ReadonlyArray<ConstrainedBid>,\n}\nexport const zeroContext : BidContext = {\n  bid: {} as Bid,\n  path: [],\n  force: O.none,\n  primarySuit: O.none,\n  secondarySuit: O.none,\n  peers: [],\n}\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst contextL = Lens.fromProp<BidContext>()\nconst bidL = contextL('bid')\nconst pathL = contextL('path')\nconst forceL = contextL('force')\nconst primarySuitL = contextL('primarySuit')\nconst secondarySuitL = contextL('secondarySuit')\nconst peersL = contextL('peers')\nconst peersT = pipe(peersL,\n  lens.composeTraversal(fromTraversable(RA.Traversable)<ConstrainedBid>()))\nconst contextO = Optional.fromOptionProp<BidContext>()\nconst forceO = contextO('force')\nconst primarySuitO = contextO('primarySuit')\nconst secondarySuitO = contextO('secondarySuit')\n/* eslint-enable @typescript-eslint/no-unused-vars */\n\ntype X = BidContext\ntype C = Constraint\ntype A = P.Predicate<Hand>\n\nconst quantifierT = (quantifier: (c: ReadonlyArray<A>) => A) => (satisfies: (c: S.State<X, C>) => S.State<X, A>) =>\n  flow(\n    S.traverseArray(satisfies),\n    S.map(quantifier))\nconst existsT = quantifierT(exists(identity))\nconst forallT = quantifierT(forall(identity))\n\ntype SatisfiesShape<R, C, A> = (recur: (c: R) => A) => (constraint: C) => A\ntype SatisfiesT1<F extends hkt.URIS , C extends Constraint> = SatisfiesShape<hkt.Kind  <F,    Constraint>, hkt.Kind <F,    C>, hkt.Kind <F,    A>>\ntype SatisfiesT2<F extends hkt.URIS2, C extends Constraint> = SatisfiesShape<hkt.Kind2 <F, X, Constraint>, hkt.Kind2<F, X, C>, hkt.Kind2<F, X, A>>\n\nconst satisfiesBasic : ReturnType<SatisfiesT1<id.URI, BasicConstraint>> = c => {\n  switch (c.type) {\n    case \"Constant\":\n      return constant(c.value)\n    case \"PointRange\":\n      return isPointRange(c)\n    case \"SuitRange\":\n      return isSuitRange(c)\n    case \"SuitComparison\":\n      return suitCompare(c.op)(c.left, c.right)\n    case \"SuitHonors\":\n      return suitHonors(c)\n    case \"SuitTop\":\n      return suitTop(c)\n    case \"Balanced\":\n      return isBalanced\n    case \"SemiBalanced\":\n      return P.or(isBalanced)(isSemiBalanced)\n    case \"Unbalanced\":\n      return P.not(P.or(isBalanced)(isSemiBalanced))\n    case \"AnyShape\":\n      return isShape(c.counts)\n    case \"SpecificShape\":\n      return isSpecificShape(c.suits)\n    default:\n      return assertUnreachable(c)\n  }\n}\n\nconst ofS = <T>(x: T) => S.of<BidContext, T>(x)\n\nconst satisfiesContextual : SatisfiesT2<S.URI, ContextualConstraint> = recur =>\n  S.chain(c => {\n    switch (c.type) {\n      case \"Conjunction\":\n        return pipe(c.constraints, RNEA.map(ofS), forallT(recur))\n      case \"Disjunction\":\n        return pipe(c.constraints, RNEA.map(ofS), existsT(recur))\n      case \"Negation\": \n        return pipe(c.constraint, ofS, recur, S.map(P.not))\n      case \"Otherwise\":\n        return pipe(\n          S.gets((context: BidContext) =>\n            pipe(context,\n              peersL.get,\n              // stops cycles, since bids can only check upwards\n              RA.takeLeftWhile(b => !eqBid.equals(b.bid, context.bid)))),\n          S.chain(flow(\n            RA.map(cb => pipe(\n              S.modify(bidL.set(cb.bid)),\n              S.map(() => cb.constraint))),\n            forallT(flow(recur, S.map(P.not))))))\n      case \"OtherBid\":\n        return pipe(\n          S.gets(flow(\n            peersL.get,\n            RA.findFirst(b => eqBid.equals(b.bid, c.bid)))),\n          S.chain(O.fold(\n            constant(ofS(constraintFalse)),\n            otherBid => pipe(\n              S.gets(bidL.get),\n              S.chain(bid =>\n                eqBid.equals(bid, otherBid.bid) // stops cycles\n                ? S.of(constFalse)\n                : recur(S.of(otherBid.constraint)))))))\n      case \"ForceOneRound\":\n      case \"ForceGame\":\n      case \"ForceSlam\":\n      case \"Relay\":\n        return pipe(\n          S.modify<BidContext>(forceL.set(O.some(c))),\n          S.map(constant(constTrue)))\n      case \"SuitPrimary\":\n        return pipe(\n          S.modify<BidContext>(primarySuitL.set(O.some(c.suit))),\n          S.map(constant(suitPrimary(c.suit))))\n      case \"SuitSecondary\":\n        return pipe(\n          S.modify<BidContext>(secondarySuitL.set(O.some(c.suit))),\n          S.chain(constant(S.gets(context => context.primarySuit))),\n          optionT.map(S.Functor)(suitSecondary(c.suit)),\n          S.map(O.getOrElseW(constant(constraintFalse))))\n      default:\n        return assertUnreachable(c)\n    }\n  })\n\nconst satisfiesS : ReturnType<SatisfiesT2<S.URI, Constraint>> = s =>\n  pipe(s,\n    S.map(separate),\n    S.chain(either.fold(\n      flow(S.of, satisfiesContextual(satisfiesS)),\n      right => pipe(S.of<X, typeof satisfiesBasic>(satisfiesBasic), S.ap(S.of(right))))))\n\nexport const satisfiesWithContext = (x: Constraint) =>\n  pipe(x, S.of, satisfiesS)\n  \nexport const satisfies =\n  flow(satisfiesWithContext, S.evaluate(zeroContext))\n\nmodule Gen {\n  export function* alternate(opener: Hand, responder: Hand) {\n    while (true) { yield opener; yield responder }\n  }\n\n  export const unfold = (length: number) => <T>(g: Generator<T>) : readonly T[] => {\n    const val = g.next()\n    return val.done || length === 0 ? [] : [val.value, ...unfold(length - 1)(g)]\n  }\n}\n\nconst specialRelayCase = (bid: Bid) => (s: S.State<BidContext, Constraint>) =>\n  pipe(s,\n    S.bindTo('constraint'),\n    S.bind('relay', ({ constraint }) =>\n      S.gets(flow(\n        forceL.get,\n        O.fold(constFalse, force =>\n          constraint.type === \"Constant\" && !constraint.value && force.type === \"Relay\" && eqBid.equals(force.bid, bid))))),\n    S.map(s => s.relay ? constConstraintTrue() : s.constraint))\n\nconst preTraversal = (info: BidInfo) =>\n  pipe(\n    S.modify(peersL.set(info.siblings)),\n    S.chain(() => S.modify(bidL.set(info.bid))),\n    S.map(() => info.constraint))\n\nconst postTraversal = (info: BidInfo) =>\n    S.chain((s: boolean) => pipe(\n      S.modify(pathL.modify(RA.prepend(info.bid))),\n      S.map(() => s)))\n  \nexport const satisfiesPath = (opener: Hand, responder: Hand) => (path: BidPath) =>\n  pipe(\n    Gen.alternate(opener, responder),\n    Gen.unfold(path.length),\n    RA.zip(path),\n    S.traverseArray(([hand, info]) =>\n      pipe(\n        preTraversal(info),\n        flow(\n          specialRelayCase(info.bid),\n          satisfiesS),\n        S.ap(S.of(hand)),\n        postTraversal(info))),\n    S.map(RA.foldMap(boolean.MonoidAll)(identity)),\n    S.evaluate(zeroContext))\n\n// Only use for one-off checks, as it doesn't descend the entire bid tree\nexport const satisfiesPathWithoutSiblingCheck = (opener: Hand, responder: Hand) =>\n  flow(RNEA.map((x: ConstrainedBid) => ({ ...x, siblings: [] })), satisfiesPath(opener, responder))\n\nconst ordBid: ord.Ord<Bid> =\n  ord.fromCompare((a, b) =>\n    isContractBid(a) && !isContractBid(b) ? -1 :\n    isContractBid(b) && !isContractBid(a) ? 1 :\n    isContractBid(a) && isContractBid(b) ? ordContractBid.compare(a, b) :\n    0)\n\nconst ordConstrainedBid = ord.contramap<Bid, ConstrainedBid>(b => b.bid)(ordBid)\n\nconst bidPathSorted : P.Predicate<BidPath> = path =>\n  pipe(path,\n    RA.zip(RNEA.tail(path)),\n    RA.foldMap(boolean.MonoidAll)(bids =>\n      ord.lt(ordConstrainedBid)(...bids)))\n\nconst bidTreeSorted : P.Predicate<BidTree> =\n  flow(getAllLeafPaths,\n    RA.foldMap(boolean.MonoidAll)(bidPathSorted))\n\nexport const validateS = (s: S.State<BidContext, Constraint>): S.State<BidContext, boolean> =>\n  pipe(s, S.chain(c => {\n    if (isContextualConstraint(c)) {\n      switch (c.type) {\n        case \"Conjunction\":\n        case \"Disjunction\":\n          return pipe(c.constraints, RNEA.map(ofS), S.traverseArray(validateS), S.map(RA.foldMap(boolean.MonoidAll)(identity)))\n        case \"Negation\": \n          return pipe(c.constraint, ofS, validateS)\n        case \"OtherBid\":\n          return S.gets(flow(\n            peersL.get,\n            RA.map(cb => cb.bid),\n            RA.elem(eqBid)(c.bid)))\n        case \"ForceOneRound\":\n        case \"ForceGame\":\n        case \"ForceSlam\":\n        case \"Relay\":\n          return pipe(\n            S.modify(forceL.set(O.some(c))),\n            S.map(constTrue))\n        case \"SuitPrimary\":\n          return pipe(\n            S.modify(primarySuitL.set(O.some(c.suit))),\n            S.map(constTrue))\n        case \"SuitSecondary\":\n          return pipe(\n            S.modify(secondarySuitL.set(O.some(c.suit))),\n            S.chain(constant(S.gets(context => context.primarySuit))),\n            S.map(O.isSome))\n        case \"Otherwise\":\n          return S.of(true)\n        default:\n          return assertUnreachable(c)\n      }\n    } else {\n      return S.of(true)\n    }\n  }))\n\nconst resetForce = S.modify(forceL.set(O.none))\nconst continueForce: typeof resetForce = S.of(constVoid())\nconst updateForce = (bid: Bid) => (force: ConstraintForce) => {\n  switch (force.type) {\n    case \"ForceOneRound\":\n    case \"Relay\":\n      return resetForce\n    case \"ForceGame\":\n      return isGameLevel(bid) ? resetForce : continueForce\n    case \"ForceSlam\":\n      return isSlamLevel(bid) ? resetForce : continueForce\n    default:\n      return assertUnreachable(force)\n  }\n}\n\nconst updateForceS : (s: S.State<BidContext, Constraint>) => S.State<BidContext, Constraint> =\n  flow(\n    S.bindTo('constraint'),\n    S.apS('bid', S.gets(bidL.get)),\n    S.apS('force', S.gets(forceO.getOption)),\n    S.chain(({ bid, force, constraint }) =>\n      pipe(force,\n        O.traverse(S.Applicative)(updateForce(bid)),\n        S.map(constant(constraint)))))\n\nconst checkPass = (bid: Bid) => (force: O.Option<ConstraintForce>) =>\n  !(bid === \"Pass\" && O.isSome(force))\n\nconst checkPassS : (s: S.State<BidContext, Constraint>) => S.State<BidContext, boolean> =\n  flow(\n    S.apS('bid', S.gets(bidL.get)),\n    S.apS('force', S.gets(forceL.get)),\n    S.map(({ bid, force }) => checkPass(bid)(force)))\n\nconst checkFinal =\n  pipe(\n    S.gets(forceO.getOption),\n    S.map(O.isNone))\n\nconst pathIsSound : P.Predicate<BidPath> =\n  flow(\n    S.traverseArray(info =>\n      pipe(\n        preTraversal(info),\n        S.bindTo('constraint'),\n        S.bind('forceCheck', ({ constraint }) => checkPassS(S.of(constraint))),\n        S.chain(({ constraint, forceCheck }) =>\n          !forceCheck\n          ? S.of(false)\n          : pipe(\n            S.of(constraint),\n            updateForceS,\n            validateS,\n            postTraversal(info))))),\n    S.bindTo('result'),\n    S.apS('finalCheck', checkFinal),\n    S.map(({ result, finalCheck }) =>\n      finalCheck && pipe(result, RA.foldMap(boolean.MonoidAll)(identity))),\n    S.evaluate(zeroContext))\n\nconst treeIsSound : P.Predicate<BidTree> =\nflow(getAllLeafPaths,\n  RA.foldMap(boolean.MonoidAll)(pathIsSound))\n\nexport const validateTree : P.Predicate<BidTree> =\n  P.and(bidTreeSorted)(treeIsSound)","/* AutoGenerated Code, changes may be overwritten\n* INPUT GRAMMAR:\n* Start := spec=BidSpec $\n* BidSpec := bid=Bid constraints=BidSpecConstraintList?\n* BidSpecConstraintList := ': ' constraints=ConstraintList\n* Bid := ContractBid | NonContractBid\n* ContractBid := level=Digit specifier=BidSpecifier\n* BidSpecifier := Wildcard | SuitSpecifier\n* Wildcard := v='x'\n* SuitSpecifier := Major | Minor | Strain\n* Major := v='M'\n* Minor := v='m'\n* NonContractBid := Pass\n* Pass := v='P'\n* Strain := Suit | Notrump\n* Suit := Club | Diamond | Heart | Spade\n* Club := v='[Cc]'\n* Diamond := v='[Dd]'\n* Heart := v='[Hh]'\n* Spade := v='[Ss]'\n* Notrump := v='[Nn]' '[Tt]'?\n* Honor := v='[AKQJT]'\n* ConstraintList := ConstraintListItem+\n* ConstraintListItem := constraint=Constraint ' '?\n* Constraint :=\n*     Const\n*   | Or\n*   | And\n*   | Not\n*   | Otherwise\n*   | Distribution\n*   | Response\n*   | SuitRange\n*   | SuitBound\n*   | SuitComparison\n*   | SuitHonors\n*   | SuitTop\n*   | SuitRank\n*   | PointRange\n*   | PointBound\n*   | OtherBid\n* Const := True | False\n* True := v='true'\n* False := v='false'\n* Or := left=Constraint ' or ' right=Constraint\n* And := '\\(' constraints=ConstraintList '\\)'\n* Not := {'not' | '!'} ' '? constraint=Constraint\n* Otherwise := v='else'\n* PointRange := lower=Number '-' upper=Number\n* PointBound := value=Number qualifier=BoundQualifier\n* SuitRange := lower=Digit '-' upper=Digit suit=SuitRangeSpecifier\n* SuitBound := value=Number qualifier=BoundQualifier suit=SuitRangeSpecifier\n* SuitRangeSpecifier := Suit //| Major | Minor | OtherMajor | OtherMinor\n* // OtherMajor := v='oM'\n* // OtherMinor := v='om'\n* SuitComparison := left=Suit op=SuitComparisonOperator right=Suit\n* SuitComparisonOperator := v='<' | v='<=' | v='=' | v='>=' | v='>'\n* SuitHonors := suit=Suit honors=Honor+\n* SuitTop := suit=Suit x='[0-5]' '/' y='[1-5]'\n* BoundQualifier := Plus | Minus | Equals\n* Plus := v='\\+'\n* Minus := v='\\-'\n* Equals := v='='\n* OtherBid := level=Number strain=Strain\n* Distribution := Balanced | SemiBalanced | Unbalanced | AnyShape | SpecificShape\n* Balanced := v='BAL'\n* SemiBalanced := v='semiBAL'\n* Unbalanced := v='unBAL'\n* AnyShape := v='[0-9]{4}' '\\*'\n* SpecificShape := S=Digit H=Digit D=Digit C=Digit\n* SuitRank := Primary | Secondary\n* Primary := suit=Suit '1'\n* Secondary := suit=Suit '2'\n* Response := ForceOneRound | ForceGame | ForceSlam | Relay\n* ForceOneRound := v='F1'\n* ForceGame := v='FG'\n* ForceSlam := v='FS'\n* Relay := '->' bid=OtherBid\n* Digit := literal='[0-9]'\n*   .value = number { return parseInt(literal) }\n* Number := literal='[0-9]+'\n*   .value = number { return parseInt(literal) }\n*/\ntype Nullable<T> = T | null;\ntype $$RuleType<T> = () => Nullable<T>;\ninterface ASTNodeIntf {\n    kind: ASTKinds;\n}\nexport enum ASTKinds {\n    Start = \"Start\",\n    BidSpec = \"BidSpec\",\n    BidSpecConstraintList = \"BidSpecConstraintList\",\n    Bid_1 = \"Bid_1\",\n    Bid_2 = \"Bid_2\",\n    ContractBid = \"ContractBid\",\n    BidSpecifier_1 = \"BidSpecifier_1\",\n    BidSpecifier_2 = \"BidSpecifier_2\",\n    Wildcard = \"Wildcard\",\n    SuitSpecifier_1 = \"SuitSpecifier_1\",\n    SuitSpecifier_2 = \"SuitSpecifier_2\",\n    SuitSpecifier_3 = \"SuitSpecifier_3\",\n    Major = \"Major\",\n    Minor = \"Minor\",\n    NonContractBid = \"NonContractBid\",\n    Pass = \"Pass\",\n    Strain_1 = \"Strain_1\",\n    Strain_2 = \"Strain_2\",\n    Suit_1 = \"Suit_1\",\n    Suit_2 = \"Suit_2\",\n    Suit_3 = \"Suit_3\",\n    Suit_4 = \"Suit_4\",\n    Club = \"Club\",\n    Diamond = \"Diamond\",\n    Heart = \"Heart\",\n    Spade = \"Spade\",\n    Notrump = \"Notrump\",\n    Honor = \"Honor\",\n    ConstraintList = \"ConstraintList\",\n    ConstraintListItem = \"ConstraintListItem\",\n    Constraint_1 = \"Constraint_1\",\n    Constraint_2 = \"Constraint_2\",\n    Constraint_3 = \"Constraint_3\",\n    Constraint_4 = \"Constraint_4\",\n    Constraint_5 = \"Constraint_5\",\n    Constraint_6 = \"Constraint_6\",\n    Constraint_7 = \"Constraint_7\",\n    Constraint_8 = \"Constraint_8\",\n    Constraint_9 = \"Constraint_9\",\n    Constraint_10 = \"Constraint_10\",\n    Constraint_11 = \"Constraint_11\",\n    Constraint_12 = \"Constraint_12\",\n    Constraint_13 = \"Constraint_13\",\n    Constraint_14 = \"Constraint_14\",\n    Constraint_15 = \"Constraint_15\",\n    Constraint_16 = \"Constraint_16\",\n    Const_1 = \"Const_1\",\n    Const_2 = \"Const_2\",\n    True = \"True\",\n    False = \"False\",\n    Or = \"Or\",\n    And = \"And\",\n    Not = \"Not\",\n    Not_$0_1 = \"Not_$0_1\",\n    Not_$0_2 = \"Not_$0_2\",\n    Otherwise = \"Otherwise\",\n    PointRange = \"PointRange\",\n    PointBound = \"PointBound\",\n    SuitRange = \"SuitRange\",\n    SuitBound = \"SuitBound\",\n    SuitRangeSpecifier = \"SuitRangeSpecifier\",\n    SuitComparison = \"SuitComparison\",\n    SuitComparisonOperator_1 = \"SuitComparisonOperator_1\",\n    SuitComparisonOperator_2 = \"SuitComparisonOperator_2\",\n    SuitComparisonOperator_3 = \"SuitComparisonOperator_3\",\n    SuitComparisonOperator_4 = \"SuitComparisonOperator_4\",\n    SuitComparisonOperator_5 = \"SuitComparisonOperator_5\",\n    SuitHonors = \"SuitHonors\",\n    SuitTop = \"SuitTop\",\n    BoundQualifier_1 = \"BoundQualifier_1\",\n    BoundQualifier_2 = \"BoundQualifier_2\",\n    BoundQualifier_3 = \"BoundQualifier_3\",\n    Plus = \"Plus\",\n    Minus = \"Minus\",\n    Equals = \"Equals\",\n    OtherBid = \"OtherBid\",\n    Distribution_1 = \"Distribution_1\",\n    Distribution_2 = \"Distribution_2\",\n    Distribution_3 = \"Distribution_3\",\n    Distribution_4 = \"Distribution_4\",\n    Distribution_5 = \"Distribution_5\",\n    Balanced = \"Balanced\",\n    SemiBalanced = \"SemiBalanced\",\n    Unbalanced = \"Unbalanced\",\n    AnyShape = \"AnyShape\",\n    SpecificShape = \"SpecificShape\",\n    SuitRank_1 = \"SuitRank_1\",\n    SuitRank_2 = \"SuitRank_2\",\n    Primary = \"Primary\",\n    Secondary = \"Secondary\",\n    Response_1 = \"Response_1\",\n    Response_2 = \"Response_2\",\n    Response_3 = \"Response_3\",\n    Response_4 = \"Response_4\",\n    ForceOneRound = \"ForceOneRound\",\n    ForceGame = \"ForceGame\",\n    ForceSlam = \"ForceSlam\",\n    Relay = \"Relay\",\n    Digit = \"Digit\",\n    Number = \"Number\",\n    $EOF = \"$EOF\",\n}\nexport interface Start {\n    kind: ASTKinds.Start;\n    spec: BidSpec;\n}\nexport interface BidSpec {\n    kind: ASTKinds.BidSpec;\n    bid: Bid;\n    constraints: Nullable<BidSpecConstraintList>;\n}\nexport interface BidSpecConstraintList {\n    kind: ASTKinds.BidSpecConstraintList;\n    constraints: ConstraintList;\n}\nexport type Bid = Bid_1 | Bid_2;\nexport type Bid_1 = ContractBid;\nexport type Bid_2 = NonContractBid;\nexport interface ContractBid {\n    kind: ASTKinds.ContractBid;\n    level: Digit;\n    specifier: BidSpecifier;\n}\nexport type BidSpecifier = BidSpecifier_1 | BidSpecifier_2;\nexport type BidSpecifier_1 = Wildcard;\nexport type BidSpecifier_2 = SuitSpecifier;\nexport interface Wildcard {\n    kind: ASTKinds.Wildcard;\n    v: string;\n}\nexport type SuitSpecifier = SuitSpecifier_1 | SuitSpecifier_2 | SuitSpecifier_3;\nexport type SuitSpecifier_1 = Major;\nexport type SuitSpecifier_2 = Minor;\nexport type SuitSpecifier_3 = Strain;\nexport interface Major {\n    kind: ASTKinds.Major;\n    v: string;\n}\nexport interface Minor {\n    kind: ASTKinds.Minor;\n    v: string;\n}\nexport type NonContractBid = Pass;\nexport interface Pass {\n    kind: ASTKinds.Pass;\n    v: string;\n}\nexport type Strain = Strain_1 | Strain_2;\nexport type Strain_1 = Suit;\nexport type Strain_2 = Notrump;\nexport type Suit = Suit_1 | Suit_2 | Suit_3 | Suit_4;\nexport type Suit_1 = Club;\nexport type Suit_2 = Diamond;\nexport type Suit_3 = Heart;\nexport type Suit_4 = Spade;\nexport interface Club {\n    kind: ASTKinds.Club;\n    v: string;\n}\nexport interface Diamond {\n    kind: ASTKinds.Diamond;\n    v: string;\n}\nexport interface Heart {\n    kind: ASTKinds.Heart;\n    v: string;\n}\nexport interface Spade {\n    kind: ASTKinds.Spade;\n    v: string;\n}\nexport interface Notrump {\n    kind: ASTKinds.Notrump;\n    v: string;\n}\nexport interface Honor {\n    kind: ASTKinds.Honor;\n    v: string;\n}\nexport type ConstraintList = ConstraintListItem[];\nexport interface ConstraintListItem {\n    kind: ASTKinds.ConstraintListItem;\n    constraint: Constraint;\n}\nexport type Constraint = Constraint_1 | Constraint_2 | Constraint_3 | Constraint_4 | Constraint_5 | Constraint_6 | Constraint_7 | Constraint_8 | Constraint_9 | Constraint_10 | Constraint_11 | Constraint_12 | Constraint_13 | Constraint_14 | Constraint_15 | Constraint_16;\nexport type Constraint_1 = Const;\nexport type Constraint_2 = Or;\nexport type Constraint_3 = And;\nexport type Constraint_4 = Not;\nexport type Constraint_5 = Otherwise;\nexport type Constraint_6 = Distribution;\nexport type Constraint_7 = Response;\nexport type Constraint_8 = SuitRange;\nexport type Constraint_9 = SuitBound;\nexport type Constraint_10 = SuitComparison;\nexport type Constraint_11 = SuitHonors;\nexport type Constraint_12 = SuitTop;\nexport type Constraint_13 = SuitRank;\nexport type Constraint_14 = PointRange;\nexport type Constraint_15 = PointBound;\nexport type Constraint_16 = OtherBid;\nexport type Const = Const_1 | Const_2;\nexport type Const_1 = True;\nexport type Const_2 = False;\nexport interface True {\n    kind: ASTKinds.True;\n    v: string;\n}\nexport interface False {\n    kind: ASTKinds.False;\n    v: string;\n}\nexport interface Or {\n    kind: ASTKinds.Or;\n    left: Constraint;\n    right: Constraint;\n}\nexport interface And {\n    kind: ASTKinds.And;\n    constraints: ConstraintList;\n}\nexport interface Not {\n    kind: ASTKinds.Not;\n    constraint: Constraint;\n}\nexport type Not_$0 = Not_$0_1 | Not_$0_2;\nexport type Not_$0_1 = string;\nexport type Not_$0_2 = string;\nexport interface Otherwise {\n    kind: ASTKinds.Otherwise;\n    v: string;\n}\nexport interface PointRange {\n    kind: ASTKinds.PointRange;\n    lower: Number;\n    upper: Number;\n}\nexport interface PointBound {\n    kind: ASTKinds.PointBound;\n    value: Number;\n    qualifier: BoundQualifier;\n}\nexport interface SuitRange {\n    kind: ASTKinds.SuitRange;\n    lower: Digit;\n    upper: Digit;\n    suit: SuitRangeSpecifier;\n}\nexport interface SuitBound {\n    kind: ASTKinds.SuitBound;\n    value: Number;\n    qualifier: BoundQualifier;\n    suit: SuitRangeSpecifier;\n}\nexport type SuitRangeSpecifier = Suit;\nexport interface SuitComparison {\n    kind: ASTKinds.SuitComparison;\n    left: Suit;\n    op: SuitComparisonOperator;\n    right: Suit;\n}\nexport type SuitComparisonOperator = SuitComparisonOperator_1 | SuitComparisonOperator_2 | SuitComparisonOperator_3 | SuitComparisonOperator_4 | SuitComparisonOperator_5;\nexport interface SuitComparisonOperator_1 {\n    kind: ASTKinds.SuitComparisonOperator_1;\n    v: string;\n}\nexport interface SuitComparisonOperator_2 {\n    kind: ASTKinds.SuitComparisonOperator_2;\n    v: string;\n}\nexport interface SuitComparisonOperator_3 {\n    kind: ASTKinds.SuitComparisonOperator_3;\n    v: string;\n}\nexport interface SuitComparisonOperator_4 {\n    kind: ASTKinds.SuitComparisonOperator_4;\n    v: string;\n}\nexport interface SuitComparisonOperator_5 {\n    kind: ASTKinds.SuitComparisonOperator_5;\n    v: string;\n}\nexport interface SuitHonors {\n    kind: ASTKinds.SuitHonors;\n    suit: Suit;\n    honors: Honor[];\n}\nexport interface SuitTop {\n    kind: ASTKinds.SuitTop;\n    suit: Suit;\n    x: string;\n    y: string;\n}\nexport type BoundQualifier = BoundQualifier_1 | BoundQualifier_2 | BoundQualifier_3;\nexport type BoundQualifier_1 = Plus;\nexport type BoundQualifier_2 = Minus;\nexport type BoundQualifier_3 = Equals;\nexport interface Plus {\n    kind: ASTKinds.Plus;\n    v: string;\n}\nexport interface Minus {\n    kind: ASTKinds.Minus;\n    v: string;\n}\nexport interface Equals {\n    kind: ASTKinds.Equals;\n    v: string;\n}\nexport interface OtherBid {\n    kind: ASTKinds.OtherBid;\n    level: Number;\n    strain: Strain;\n}\nexport type Distribution = Distribution_1 | Distribution_2 | Distribution_3 | Distribution_4 | Distribution_5;\nexport type Distribution_1 = Balanced;\nexport type Distribution_2 = SemiBalanced;\nexport type Distribution_3 = Unbalanced;\nexport type Distribution_4 = AnyShape;\nexport type Distribution_5 = SpecificShape;\nexport interface Balanced {\n    kind: ASTKinds.Balanced;\n    v: string;\n}\nexport interface SemiBalanced {\n    kind: ASTKinds.SemiBalanced;\n    v: string;\n}\nexport interface Unbalanced {\n    kind: ASTKinds.Unbalanced;\n    v: string;\n}\nexport interface AnyShape {\n    kind: ASTKinds.AnyShape;\n    v: string;\n}\nexport interface SpecificShape {\n    kind: ASTKinds.SpecificShape;\n    S: Digit;\n    H: Digit;\n    D: Digit;\n    C: Digit;\n}\nexport type SuitRank = SuitRank_1 | SuitRank_2;\nexport type SuitRank_1 = Primary;\nexport type SuitRank_2 = Secondary;\nexport interface Primary {\n    kind: ASTKinds.Primary;\n    suit: Suit;\n}\nexport interface Secondary {\n    kind: ASTKinds.Secondary;\n    suit: Suit;\n}\nexport type Response = Response_1 | Response_2 | Response_3 | Response_4;\nexport type Response_1 = ForceOneRound;\nexport type Response_2 = ForceGame;\nexport type Response_3 = ForceSlam;\nexport type Response_4 = Relay;\nexport interface ForceOneRound {\n    kind: ASTKinds.ForceOneRound;\n    v: string;\n}\nexport interface ForceGame {\n    kind: ASTKinds.ForceGame;\n    v: string;\n}\nexport interface ForceSlam {\n    kind: ASTKinds.ForceSlam;\n    v: string;\n}\nexport interface Relay {\n    kind: ASTKinds.Relay;\n    bid: OtherBid;\n}\nexport class Digit {\n    public kind: ASTKinds.Digit = ASTKinds.Digit;\n    public literal: string;\n    public value: number;\n    constructor(literal: string){\n        this.literal = literal;\n        this.value = ((): number => {\n        return parseInt(literal)\n        })();\n    }\n}\nexport class Number {\n    public kind: ASTKinds.Number = ASTKinds.Number;\n    public literal: string;\n    public value: number;\n    constructor(literal: string){\n        this.literal = literal;\n        this.value = ((): number => {\n        return parseInt(literal)\n        })();\n    }\n}\nexport class Parser {\n    private readonly input: string;\n    private pos: PosInfo;\n    private negating: boolean = false;\n    private memoSafe: boolean = true;\n    constructor(input: string) {\n        this.pos = {overallPos: 0, line: 1, offset: 0};\n        this.input = input;\n    }\n    public reset(pos: PosInfo) {\n        this.pos = pos;\n    }\n    public finished(): boolean {\n        return this.pos.overallPos === this.input.length;\n    }\n    public clearMemos(): void {\n        this.$scope$Constraint$memo.clear();\n    }\n    protected $scope$Constraint$memo: Map<number, [Nullable<Constraint>, PosInfo]> = new Map();\n    public matchStart($$dpth: number, $$cr?: ErrorTracker): Nullable<Start> {\n        return this.run<Start>($$dpth,\n            () => {\n                let $scope$spec: Nullable<BidSpec>;\n                let $$res: Nullable<Start> = null;\n                if (true\n                    && ($scope$spec = this.matchBidSpec($$dpth + 1, $$cr)) !== null\n                    && this.match$EOF($$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Start, spec: $scope$spec};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpec($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpec> {\n        return this.run<BidSpec>($$dpth,\n            () => {\n                let $scope$bid: Nullable<Bid>;\n                let $scope$constraints: Nullable<Nullable<BidSpecConstraintList>>;\n                let $$res: Nullable<BidSpec> = null;\n                if (true\n                    && ($scope$bid = this.matchBid($$dpth + 1, $$cr)) !== null\n                    && (($scope$constraints = this.matchBidSpecConstraintList($$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.BidSpec, bid: $scope$bid, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpecConstraintList($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecConstraintList> {\n        return this.run<BidSpecConstraintList>($$dpth,\n            () => {\n                let $scope$constraints: Nullable<ConstraintList>;\n                let $$res: Nullable<BidSpecConstraintList> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:: )`, $$dpth + 1, $$cr) !== null\n                    && ($scope$constraints = this.matchConstraintList($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.BidSpecConstraintList, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchBid($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid> {\n        return this.choice<Bid>([\n            () => this.matchBid_1($$dpth + 1, $$cr),\n            () => this.matchBid_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBid_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid_1> {\n        return this.matchContractBid($$dpth + 1, $$cr);\n    }\n    public matchBid_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid_2> {\n        return this.matchNonContractBid($$dpth + 1, $$cr);\n    }\n    public matchContractBid($$dpth: number, $$cr?: ErrorTracker): Nullable<ContractBid> {\n        return this.run<ContractBid>($$dpth,\n            () => {\n                let $scope$level: Nullable<Digit>;\n                let $scope$specifier: Nullable<BidSpecifier>;\n                let $$res: Nullable<ContractBid> = null;\n                if (true\n                    && ($scope$level = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$specifier = this.matchBidSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ContractBid, level: $scope$level, specifier: $scope$specifier};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier> {\n        return this.choice<BidSpecifier>([\n            () => this.matchBidSpecifier_1($$dpth + 1, $$cr),\n            () => this.matchBidSpecifier_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBidSpecifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier_1> {\n        return this.matchWildcard($$dpth + 1, $$cr);\n    }\n    public matchBidSpecifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier_2> {\n        return this.matchSuitSpecifier($$dpth + 1, $$cr);\n    }\n    public matchWildcard($$dpth: number, $$cr?: ErrorTracker): Nullable<Wildcard> {\n        return this.run<Wildcard>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Wildcard> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:x)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Wildcard, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier> {\n        return this.choice<SuitSpecifier>([\n            () => this.matchSuitSpecifier_1($$dpth + 1, $$cr),\n            () => this.matchSuitSpecifier_2($$dpth + 1, $$cr),\n            () => this.matchSuitSpecifier_3($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitSpecifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_1> {\n        return this.matchMajor($$dpth + 1, $$cr);\n    }\n    public matchSuitSpecifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_2> {\n        return this.matchMinor($$dpth + 1, $$cr);\n    }\n    public matchSuitSpecifier_3($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_3> {\n        return this.matchStrain($$dpth + 1, $$cr);\n    }\n    public matchMajor($$dpth: number, $$cr?: ErrorTracker): Nullable<Major> {\n        return this.run<Major>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Major> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:M)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Major, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchMinor($$dpth: number, $$cr?: ErrorTracker): Nullable<Minor> {\n        return this.run<Minor>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Minor> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:m)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Minor, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchNonContractBid($$dpth: number, $$cr?: ErrorTracker): Nullable<NonContractBid> {\n        return this.matchPass($$dpth + 1, $$cr);\n    }\n    public matchPass($$dpth: number, $$cr?: ErrorTracker): Nullable<Pass> {\n        return this.run<Pass>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Pass> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:P)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Pass, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchStrain($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain> {\n        return this.choice<Strain>([\n            () => this.matchStrain_1($$dpth + 1, $$cr),\n            () => this.matchStrain_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchStrain_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain_1> {\n        return this.matchSuit($$dpth + 1, $$cr);\n    }\n    public matchStrain_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain_2> {\n        return this.matchNotrump($$dpth + 1, $$cr);\n    }\n    public matchSuit($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit> {\n        return this.choice<Suit>([\n            () => this.matchSuit_1($$dpth + 1, $$cr),\n            () => this.matchSuit_2($$dpth + 1, $$cr),\n            () => this.matchSuit_3($$dpth + 1, $$cr),\n            () => this.matchSuit_4($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuit_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_1> {\n        return this.matchClub($$dpth + 1, $$cr);\n    }\n    public matchSuit_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_2> {\n        return this.matchDiamond($$dpth + 1, $$cr);\n    }\n    public matchSuit_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_3> {\n        return this.matchHeart($$dpth + 1, $$cr);\n    }\n    public matchSuit_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_4> {\n        return this.matchSpade($$dpth + 1, $$cr);\n    }\n    public matchClub($$dpth: number, $$cr?: ErrorTracker): Nullable<Club> {\n        return this.run<Club>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Club> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Cc])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Club, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchDiamond($$dpth: number, $$cr?: ErrorTracker): Nullable<Diamond> {\n        return this.run<Diamond>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Diamond> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Dd])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Diamond, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchHeart($$dpth: number, $$cr?: ErrorTracker): Nullable<Heart> {\n        return this.run<Heart>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Heart> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Hh])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Heart, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSpade($$dpth: number, $$cr?: ErrorTracker): Nullable<Spade> {\n        return this.run<Spade>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Spade> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Ss])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Spade, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchNotrump($$dpth: number, $$cr?: ErrorTracker): Nullable<Notrump> {\n        return this.run<Notrump>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Notrump> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Nn])`, $$dpth + 1, $$cr)) !== null\n                    && ((this.regexAccept(String.raw`(?:[Tt])`, $$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.Notrump, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchHonor($$dpth: number, $$cr?: ErrorTracker): Nullable<Honor> {\n        return this.run<Honor>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Honor> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[AKQJT])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Honor, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchConstraintList($$dpth: number, $$cr?: ErrorTracker): Nullable<ConstraintList> {\n        return this.loop<ConstraintListItem>(() => this.matchConstraintListItem($$dpth + 1, $$cr), false);\n    }\n    public matchConstraintListItem($$dpth: number, $$cr?: ErrorTracker): Nullable<ConstraintListItem> {\n        return this.run<ConstraintListItem>($$dpth,\n            () => {\n                let $scope$constraint: Nullable<Constraint>;\n                let $$res: Nullable<ConstraintListItem> = null;\n                if (true\n                    && ($scope$constraint = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                    && ((this.regexAccept(String.raw`(?: )`, $$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.ConstraintListItem, constraint: $scope$constraint};\n                }\n                return $$res;\n            });\n    }\n    public matchConstraint($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint> {\n        const fn = () => {\n            return this.choice<Constraint>([\n                () => this.matchConstraint_1($$dpth + 1, $$cr),\n                () => this.matchConstraint_2($$dpth + 1, $$cr),\n                () => this.matchConstraint_3($$dpth + 1, $$cr),\n                () => this.matchConstraint_4($$dpth + 1, $$cr),\n                () => this.matchConstraint_5($$dpth + 1, $$cr),\n                () => this.matchConstraint_6($$dpth + 1, $$cr),\n                () => this.matchConstraint_7($$dpth + 1, $$cr),\n                () => this.matchConstraint_8($$dpth + 1, $$cr),\n                () => this.matchConstraint_9($$dpth + 1, $$cr),\n                () => this.matchConstraint_10($$dpth + 1, $$cr),\n                () => this.matchConstraint_11($$dpth + 1, $$cr),\n                () => this.matchConstraint_12($$dpth + 1, $$cr),\n                () => this.matchConstraint_13($$dpth + 1, $$cr),\n                () => this.matchConstraint_14($$dpth + 1, $$cr),\n                () => this.matchConstraint_15($$dpth + 1, $$cr),\n                () => this.matchConstraint_16($$dpth + 1, $$cr),\n            ]);\n        };\n        const $scope$pos = this.mark();\n        const memo = this.$scope$Constraint$memo.get($scope$pos.overallPos);\n        if(memo !== undefined) {\n            this.reset(memo[1]);\n            return memo[0];\n        }\n        const $scope$oldMemoSafe = this.memoSafe;\n        this.memoSafe = false;\n        this.$scope$Constraint$memo.set($scope$pos.overallPos, [null, $scope$pos]);\n        let lastRes: Nullable<Constraint> = null;\n        let lastPos: PosInfo = $scope$pos;\n        for(;;) {\n            this.reset($scope$pos);\n            const res = fn();\n            const end = this.mark();\n            if(end.overallPos <= lastPos.overallPos)\n                break;\n            lastRes = res;\n            lastPos = end;\n            this.$scope$Constraint$memo.set($scope$pos.overallPos, [lastRes, lastPos]);\n        }\n        this.reset(lastPos);\n        this.memoSafe = $scope$oldMemoSafe;\n        return lastRes;\n    }\n    public matchConstraint_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_1> {\n        return this.matchConst($$dpth + 1, $$cr);\n    }\n    public matchConstraint_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_2> {\n        return this.matchOr($$dpth + 1, $$cr);\n    }\n    public matchConstraint_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_3> {\n        return this.matchAnd($$dpth + 1, $$cr);\n    }\n    public matchConstraint_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_4> {\n        return this.matchNot($$dpth + 1, $$cr);\n    }\n    public matchConstraint_5($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_5> {\n        return this.matchOtherwise($$dpth + 1, $$cr);\n    }\n    public matchConstraint_6($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_6> {\n        return this.matchDistribution($$dpth + 1, $$cr);\n    }\n    public matchConstraint_7($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_7> {\n        return this.matchResponse($$dpth + 1, $$cr);\n    }\n    public matchConstraint_8($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_8> {\n        return this.matchSuitRange($$dpth + 1, $$cr);\n    }\n    public matchConstraint_9($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_9> {\n        return this.matchSuitBound($$dpth + 1, $$cr);\n    }\n    public matchConstraint_10($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_10> {\n        return this.matchSuitComparison($$dpth + 1, $$cr);\n    }\n    public matchConstraint_11($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_11> {\n        return this.matchSuitHonors($$dpth + 1, $$cr);\n    }\n    public matchConstraint_12($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_12> {\n        return this.matchSuitTop($$dpth + 1, $$cr);\n    }\n    public matchConstraint_13($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_13> {\n        return this.matchSuitRank($$dpth + 1, $$cr);\n    }\n    public matchConstraint_14($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_14> {\n        return this.matchPointRange($$dpth + 1, $$cr);\n    }\n    public matchConstraint_15($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_15> {\n        return this.matchPointBound($$dpth + 1, $$cr);\n    }\n    public matchConstraint_16($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_16> {\n        return this.matchOtherBid($$dpth + 1, $$cr);\n    }\n    public matchConst($$dpth: number, $$cr?: ErrorTracker): Nullable<Const> {\n        return this.choice<Const>([\n            () => this.matchConst_1($$dpth + 1, $$cr),\n            () => this.matchConst_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchConst_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Const_1> {\n        return this.matchTrue($$dpth + 1, $$cr);\n    }\n    public matchConst_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Const_2> {\n        return this.matchFalse($$dpth + 1, $$cr);\n    }\n    public matchTrue($$dpth: number, $$cr?: ErrorTracker): Nullable<True> {\n        return this.run<True>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<True> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:true)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.True, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchFalse($$dpth: number, $$cr?: ErrorTracker): Nullable<False> {\n        return this.run<False>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<False> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:false)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.False, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchOr($$dpth: number, $$cr?: ErrorTracker): Nullable<Or> {\n        return this.run<Or>($$dpth,\n            () => {\n                let $scope$left: Nullable<Constraint>;\n                let $scope$right: Nullable<Constraint>;\n                let $$res: Nullable<Or> = null;\n                if (true\n                    && ($scope$left = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?: or )`, $$dpth + 1, $$cr) !== null\n                    && ($scope$right = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Or, left: $scope$left, right: $scope$right};\n                }\n                return $$res;\n            });\n    }\n    public matchAnd($$dpth: number, $$cr?: ErrorTracker): Nullable<And> {\n        return this.run<And>($$dpth,\n            () => {\n                let $scope$constraints: Nullable<ConstraintList>;\n                let $$res: Nullable<And> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:\\()`, $$dpth + 1, $$cr) !== null\n                    && ($scope$constraints = this.matchConstraintList($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\))`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.And, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchNot($$dpth: number, $$cr?: ErrorTracker): Nullable<Not> {\n        return this.run<Not>($$dpth,\n            () => {\n                let $scope$constraint: Nullable<Constraint>;\n                let $$res: Nullable<Not> = null;\n                if (true\n                    && this.matchNot_$0($$dpth + 1, $$cr) !== null\n                    && ((this.regexAccept(String.raw`(?: )`, $$dpth + 1, $$cr)) || true)\n                    && ($scope$constraint = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Not, constraint: $scope$constraint};\n                }\n                return $$res;\n            });\n    }\n    public matchNot_$0($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0> {\n        return this.choice<Not_$0>([\n            () => this.matchNot_$0_1($$dpth + 1, $$cr),\n            () => this.matchNot_$0_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchNot_$0_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0_1> {\n        return this.regexAccept(String.raw`(?:not)`, $$dpth + 1, $$cr);\n    }\n    public matchNot_$0_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0_2> {\n        return this.regexAccept(String.raw`(?:!)`, $$dpth + 1, $$cr);\n    }\n    public matchOtherwise($$dpth: number, $$cr?: ErrorTracker): Nullable<Otherwise> {\n        return this.run<Otherwise>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Otherwise> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:else)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Otherwise, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchPointRange($$dpth: number, $$cr?: ErrorTracker): Nullable<PointRange> {\n        return this.run<PointRange>($$dpth,\n            () => {\n                let $scope$lower: Nullable<Number>;\n                let $scope$upper: Nullable<Number>;\n                let $$res: Nullable<PointRange> = null;\n                if (true\n                    && ($scope$lower = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:-)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$upper = this.matchNumber($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.PointRange, lower: $scope$lower, upper: $scope$upper};\n                }\n                return $$res;\n            });\n    }\n    public matchPointBound($$dpth: number, $$cr?: ErrorTracker): Nullable<PointBound> {\n        return this.run<PointBound>($$dpth,\n            () => {\n                let $scope$value: Nullable<Number>;\n                let $scope$qualifier: Nullable<BoundQualifier>;\n                let $$res: Nullable<PointBound> = null;\n                if (true\n                    && ($scope$value = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$qualifier = this.matchBoundQualifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.PointBound, value: $scope$value, qualifier: $scope$qualifier};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRange($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRange> {\n        return this.run<SuitRange>($$dpth,\n            () => {\n                let $scope$lower: Nullable<Digit>;\n                let $scope$upper: Nullable<Digit>;\n                let $scope$suit: Nullable<SuitRangeSpecifier>;\n                let $$res: Nullable<SuitRange> = null;\n                if (true\n                    && ($scope$lower = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:-)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$upper = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$suit = this.matchSuitRangeSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitRange, lower: $scope$lower, upper: $scope$upper, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitBound($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitBound> {\n        return this.run<SuitBound>($$dpth,\n            () => {\n                let $scope$value: Nullable<Number>;\n                let $scope$qualifier: Nullable<BoundQualifier>;\n                let $scope$suit: Nullable<SuitRangeSpecifier>;\n                let $$res: Nullable<SuitBound> = null;\n                if (true\n                    && ($scope$value = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$qualifier = this.matchBoundQualifier($$dpth + 1, $$cr)) !== null\n                    && ($scope$suit = this.matchSuitRangeSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitBound, value: $scope$value, qualifier: $scope$qualifier, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRangeSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRangeSpecifier> {\n        return this.matchSuit($$dpth + 1, $$cr);\n    }\n    public matchSuitComparison($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparison> {\n        return this.run<SuitComparison>($$dpth,\n            () => {\n                let $scope$left: Nullable<Suit>;\n                let $scope$op: Nullable<SuitComparisonOperator>;\n                let $scope$right: Nullable<Suit>;\n                let $$res: Nullable<SuitComparison> = null;\n                if (true\n                    && ($scope$left = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$op = this.matchSuitComparisonOperator($$dpth + 1, $$cr)) !== null\n                    && ($scope$right = this.matchSuit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparison, left: $scope$left, op: $scope$op, right: $scope$right};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator> {\n        return this.choice<SuitComparisonOperator>([\n            () => this.matchSuitComparisonOperator_1($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_2($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_3($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_4($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_5($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitComparisonOperator_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_1> {\n        return this.run<SuitComparisonOperator_1>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_1> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:<)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_1, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_2> {\n        return this.run<SuitComparisonOperator_2>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_2> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:<=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_2, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_3($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_3> {\n        return this.run<SuitComparisonOperator_3>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_3> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_3, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_4($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_4> {\n        return this.run<SuitComparisonOperator_4>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_4> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:>=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_4, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_5($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_5> {\n        return this.run<SuitComparisonOperator_5>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_5> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:>)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_5, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitHonors($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitHonors> {\n        return this.run<SuitHonors>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $scope$honors: Nullable<Honor[]>;\n                let $$res: Nullable<SuitHonors> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$honors = this.loop<Honor>(() => this.matchHonor($$dpth + 1, $$cr), false)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitHonors, suit: $scope$suit, honors: $scope$honors};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitTop($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitTop> {\n        return this.run<SuitTop>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $scope$x: Nullable<string>;\n                let $scope$y: Nullable<string>;\n                let $$res: Nullable<SuitTop> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$x = this.regexAccept(String.raw`(?:[0-5])`, $$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:/)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$y = this.regexAccept(String.raw`(?:[1-5])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitTop, suit: $scope$suit, x: $scope$x, y: $scope$y};\n                }\n                return $$res;\n            });\n    }\n    public matchBoundQualifier($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier> {\n        return this.choice<BoundQualifier>([\n            () => this.matchBoundQualifier_1($$dpth + 1, $$cr),\n            () => this.matchBoundQualifier_2($$dpth + 1, $$cr),\n            () => this.matchBoundQualifier_3($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBoundQualifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_1> {\n        return this.matchPlus($$dpth + 1, $$cr);\n    }\n    public matchBoundQualifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_2> {\n        return this.matchMinus($$dpth + 1, $$cr);\n    }\n    public matchBoundQualifier_3($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_3> {\n        return this.matchEquals($$dpth + 1, $$cr);\n    }\n    public matchPlus($$dpth: number, $$cr?: ErrorTracker): Nullable<Plus> {\n        return this.run<Plus>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Plus> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:\\+)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Plus, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchMinus($$dpth: number, $$cr?: ErrorTracker): Nullable<Minus> {\n        return this.run<Minus>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Minus> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:\\-)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Minus, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchEquals($$dpth: number, $$cr?: ErrorTracker): Nullable<Equals> {\n        return this.run<Equals>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Equals> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Equals, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchOtherBid($$dpth: number, $$cr?: ErrorTracker): Nullable<OtherBid> {\n        return this.run<OtherBid>($$dpth,\n            () => {\n                let $scope$level: Nullable<Number>;\n                let $scope$strain: Nullable<Strain>;\n                let $$res: Nullable<OtherBid> = null;\n                if (true\n                    && ($scope$level = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$strain = this.matchStrain($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.OtherBid, level: $scope$level, strain: $scope$strain};\n                }\n                return $$res;\n            });\n    }\n    public matchDistribution($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution> {\n        return this.choice<Distribution>([\n            () => this.matchDistribution_1($$dpth + 1, $$cr),\n            () => this.matchDistribution_2($$dpth + 1, $$cr),\n            () => this.matchDistribution_3($$dpth + 1, $$cr),\n            () => this.matchDistribution_4($$dpth + 1, $$cr),\n            () => this.matchDistribution_5($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchDistribution_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_1> {\n        return this.matchBalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_2> {\n        return this.matchSemiBalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_3> {\n        return this.matchUnbalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_4> {\n        return this.matchAnyShape($$dpth + 1, $$cr);\n    }\n    public matchDistribution_5($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_5> {\n        return this.matchSpecificShape($$dpth + 1, $$cr);\n    }\n    public matchBalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<Balanced> {\n        return this.run<Balanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Balanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:BAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Balanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSemiBalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<SemiBalanced> {\n        return this.run<SemiBalanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SemiBalanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:semiBAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SemiBalanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchUnbalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<Unbalanced> {\n        return this.run<Unbalanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Unbalanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:unBAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Unbalanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchAnyShape($$dpth: number, $$cr?: ErrorTracker): Nullable<AnyShape> {\n        return this.run<AnyShape>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<AnyShape> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[0-9]{4})`, $$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\*)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.AnyShape, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSpecificShape($$dpth: number, $$cr?: ErrorTracker): Nullable<SpecificShape> {\n        return this.run<SpecificShape>($$dpth,\n            () => {\n                let $scope$S: Nullable<Digit>;\n                let $scope$H: Nullable<Digit>;\n                let $scope$D: Nullable<Digit>;\n                let $scope$C: Nullable<Digit>;\n                let $$res: Nullable<SpecificShape> = null;\n                if (true\n                    && ($scope$S = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$H = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$D = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$C = this.matchDigit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SpecificShape, S: $scope$S, H: $scope$H, D: $scope$D, C: $scope$C};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRank($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank> {\n        return this.choice<SuitRank>([\n            () => this.matchSuitRank_1($$dpth + 1, $$cr),\n            () => this.matchSuitRank_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitRank_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank_1> {\n        return this.matchPrimary($$dpth + 1, $$cr);\n    }\n    public matchSuitRank_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank_2> {\n        return this.matchSecondary($$dpth + 1, $$cr);\n    }\n    public matchPrimary($$dpth: number, $$cr?: ErrorTracker): Nullable<Primary> {\n        return this.run<Primary>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $$res: Nullable<Primary> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:1)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Primary, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSecondary($$dpth: number, $$cr?: ErrorTracker): Nullable<Secondary> {\n        return this.run<Secondary>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $$res: Nullable<Secondary> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:2)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Secondary, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchResponse($$dpth: number, $$cr?: ErrorTracker): Nullable<Response> {\n        return this.choice<Response>([\n            () => this.matchResponse_1($$dpth + 1, $$cr),\n            () => this.matchResponse_2($$dpth + 1, $$cr),\n            () => this.matchResponse_3($$dpth + 1, $$cr),\n            () => this.matchResponse_4($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchResponse_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_1> {\n        return this.matchForceOneRound($$dpth + 1, $$cr);\n    }\n    public matchResponse_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_2> {\n        return this.matchForceGame($$dpth + 1, $$cr);\n    }\n    public matchResponse_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_3> {\n        return this.matchForceSlam($$dpth + 1, $$cr);\n    }\n    public matchResponse_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_4> {\n        return this.matchRelay($$dpth + 1, $$cr);\n    }\n    public matchForceOneRound($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceOneRound> {\n        return this.run<ForceOneRound>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceOneRound> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:F1)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceOneRound, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchForceGame($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceGame> {\n        return this.run<ForceGame>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceGame> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:FG)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceGame, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchForceSlam($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceSlam> {\n        return this.run<ForceSlam>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceSlam> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:FS)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceSlam, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchRelay($$dpth: number, $$cr?: ErrorTracker): Nullable<Relay> {\n        return this.run<Relay>($$dpth,\n            () => {\n                let $scope$bid: Nullable<OtherBid>;\n                let $$res: Nullable<Relay> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:->)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$bid = this.matchOtherBid($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Relay, bid: $scope$bid};\n                }\n                return $$res;\n            });\n    }\n    public matchDigit($$dpth: number, $$cr?: ErrorTracker): Nullable<Digit> {\n        return this.run<Digit>($$dpth,\n            () => {\n                let $scope$literal: Nullable<string>;\n                let $$res: Nullable<Digit> = null;\n                if (true\n                    && ($scope$literal = this.regexAccept(String.raw`(?:[0-9])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Digit($scope$literal);\n                }\n                return $$res;\n            });\n    }\n    public matchNumber($$dpth: number, $$cr?: ErrorTracker): Nullable<Number> {\n        return this.run<Number>($$dpth,\n            () => {\n                let $scope$literal: Nullable<string>;\n                let $$res: Nullable<Number> = null;\n                if (true\n                    && ($scope$literal = this.regexAccept(String.raw`(?:[0-9]+)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Number($scope$literal);\n                }\n                return $$res;\n            });\n    }\n    public test(): boolean {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        const ans = res !== null;\n        this.reset(mrk);\n        return ans;\n    }\n    public parse(): ParseResult {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        if (res)\n            return {ast: res, errs: []};\n        this.reset(mrk);\n        const rec = new ErrorTracker();\n        this.clearMemos();\n        this.matchStart(0, rec);\n        const err = rec.getErr()\n        return {ast: res, errs: err !== null ? [err] : []}\n    }\n    public mark(): PosInfo {\n        return this.pos;\n    }\n    private loop<T>(func: $$RuleType<T>, star: boolean = false): Nullable<T[]> {\n        const mrk = this.mark();\n        const res: T[] = [];\n        for (;;) {\n            const t = func();\n            if (t === null) {\n                break;\n            }\n            res.push(t);\n        }\n        if (star || res.length > 0) {\n            return res;\n        }\n        this.reset(mrk);\n        return null;\n    }\n    private run<T>($$dpth: number, fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn()\n        if (res !== null)\n            return res;\n        this.reset(mrk);\n        return null;\n    }\n    private choice<T>(fns: Array<$$RuleType<T>>): Nullable<T> {\n        for (const f of fns) {\n            const res = f();\n            if (res !== null) {\n                return res;\n            }\n        }\n        return null;\n    }\n    private regexAccept(match: string, dpth: number, cr?: ErrorTracker): Nullable<string> {\n        return this.run<string>(dpth,\n            () => {\n                const reg = new RegExp(match, \"y\");\n                const mrk = this.mark();\n                reg.lastIndex = mrk.overallPos;\n                const res = this.tryConsume(reg);\n                if(cr) {\n                    cr.record(mrk, res, {\n                        kind: \"RegexMatch\",\n                        // We substring from 3 to len - 1 to strip off the\n                        // non-capture group syntax added as a WebKit workaround\n                        literal: match.substring(3, match.length - 1),\n                        negated: this.negating,\n                    });\n                }\n                return res;\n            });\n    }\n    private tryConsume(reg: RegExp): Nullable<string> {\n        const res = reg.exec(this.input);\n        if (res) {\n            let lineJmp = 0;\n            let lind = -1;\n            for (let i = 0; i < res[0].length; ++i) {\n                if (res[0][i] === \"\\n\") {\n                    ++lineJmp;\n                    lind = i;\n                }\n            }\n            this.pos = {\n                overallPos: reg.lastIndex,\n                line: this.pos.line + lineJmp,\n                offset: lind === -1 ? this.pos.offset + res[0].length : (res[0].length - lind - 1)\n            };\n            return res[0];\n        }\n        return null;\n    }\n    private noConsume<T>(fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn();\n        this.reset(mrk);\n        return res;\n    }\n    private negate<T>(fn: $$RuleType<T>): Nullable<boolean> {\n        const mrk = this.mark();\n        const oneg = this.negating;\n        this.negating = !oneg;\n        const res = fn();\n        this.negating = oneg;\n        this.reset(mrk);\n        return res === null ? true : null;\n    }\n    private memoise<K>(rule: $$RuleType<K>, memo: Map<number, [Nullable<K>, PosInfo]>): Nullable<K> {\n        const $scope$pos = this.mark();\n        const $scope$memoRes = memo.get($scope$pos.overallPos);\n        if(this.memoSafe && $scope$memoRes !== undefined) {\n        this.reset($scope$memoRes[1]);\n        return $scope$memoRes[0];\n        }\n        const $scope$result = rule();\n        if(this.memoSafe)\n        memo.set($scope$pos.overallPos, [$scope$result, this.mark()]);\n        return $scope$result;\n    }\n    private match$EOF(et?: ErrorTracker): Nullable<{kind: ASTKinds.$EOF}> {\n        const res: {kind: ASTKinds.$EOF} | null = this.finished() ? { kind: ASTKinds.$EOF } : null;\n        if(et)\n            et.record(this.mark(), res, { kind: \"EOF\", negated: this.negating });\n        return res;\n    }\n}\nexport function parse(s: string): ParseResult {\n    const p = new Parser(s);\n    return p.parse();\n}\nexport interface ParseResult {\n    ast: Nullable<Start>;\n    errs: SyntaxErr[];\n}\nexport interface PosInfo {\n    readonly overallPos: number;\n    readonly line: number;\n    readonly offset: number;\n}\nexport interface RegexMatch {\n    readonly kind: \"RegexMatch\";\n    readonly negated: boolean;\n    readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\nexport class SyntaxErr {\n    public pos: PosInfo;\n    public expmatches: MatchAttempt[];\n    constructor(pos: PosInfo, expmatches: MatchAttempt[]) {\n        this.pos = pos;\n        this.expmatches = [...expmatches];\n    }\n    public toString(): string {\n        return `Syntax Error at line ${this.pos.line}:${this.pos.offset}. Expected one of ${this.expmatches.map(x => x.kind === \"EOF\" ? \" EOF\" : ` ${x.negated ? 'not ': ''}'${x.literal}'`)}`;\n    }\n}\nclass ErrorTracker {\n    private mxpos: PosInfo = {overallPos: -1, line: -1, offset: -1};\n    private regexset: Set<string> = new Set();\n    private pmatches: MatchAttempt[] = [];\n    public record(pos: PosInfo, result: any, att: MatchAttempt) {\n        if ((result === null) === att.negated)\n            return;\n        if (pos.overallPos > this.mxpos.overallPos) {\n            this.mxpos = pos;\n            this.pmatches = [];\n            this.regexset.clear()\n        }\n        if (this.mxpos.overallPos === pos.overallPos) {\n            if(att.kind === \"RegexMatch\") {\n                if(!this.regexset.has(att.literal))\n                    this.pmatches.push(att);\n                this.regexset.add(att.literal);\n            } else {\n                this.pmatches.push(att);\n            }\n        }\n    }\n    public getErr(): SyntaxErr | null {\n        if (this.mxpos.overallPos !== -1)\n            return new SyntaxErr(this.mxpos, this.pmatches);\n        return null;\n    }\n}","/* AutoGenerated Code, changes may be overwritten\n* INPUT GRAMMAR:\n* Start := hand=Hand $\n* Hand := S=Suit '\\.' H=Suit '\\.' D=Suit '\\.' C=Suit\n* Suit := cards=Card*\n* Card := c='[AKQJT2-9]'\n*   .rank = number {\n*     const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A']\n*     return rankStrings.indexOf(c) + 2\n*   }\n* // ValidChar := '[AKQJT2-9.]{16}' // 13 + 3 dots\n*/\ntype Nullable<T> = T | null;\ntype $$RuleType<T> = () => Nullable<T>;\ninterface ASTNodeIntf {\n    kind: ASTKinds;\n}\nexport enum ASTKinds {\n    Start = \"Start\",\n    Hand = \"Hand\",\n    Suit = \"Suit\",\n    Card = \"Card\",\n    $EOF = \"$EOF\",\n}\nexport interface Start {\n    kind: ASTKinds.Start;\n    hand: Hand;\n}\nexport interface Hand {\n    kind: ASTKinds.Hand;\n    S: Suit;\n    H: Suit;\n    D: Suit;\n    C: Suit;\n}\nexport interface Suit {\n    kind: ASTKinds.Suit;\n    cards: Card[];\n}\nexport class Card {\n    public kind: ASTKinds.Card = ASTKinds.Card;\n    public c: string;\n    public rank: number;\n    constructor(c: string){\n        this.c = c;\n        this.rank = ((): number => {\n        const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A']\n    return rankStrings.indexOf(c) + 2\n        })();\n    }\n}\nexport class Parser {\n    private readonly input: string;\n    private pos: PosInfo;\n    private negating: boolean = false;\n    private memoSafe: boolean = true;\n    constructor(input: string) {\n        this.pos = {overallPos: 0, line: 1, offset: 0};\n        this.input = input;\n    }\n    public reset(pos: PosInfo) {\n        this.pos = pos;\n    }\n    public finished(): boolean {\n        return this.pos.overallPos === this.input.length;\n    }\n    public clearMemos(): void {\n    }\n    public matchStart($$dpth: number, $$cr?: ErrorTracker): Nullable<Start> {\n        return this.run<Start>($$dpth,\n            () => {\n                let $scope$hand: Nullable<Hand>;\n                let $$res: Nullable<Start> = null;\n                if (true\n                    && ($scope$hand = this.matchHand($$dpth + 1, $$cr)) !== null\n                    && this.match$EOF($$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Start, hand: $scope$hand};\n                }\n                return $$res;\n            });\n    }\n    public matchHand($$dpth: number, $$cr?: ErrorTracker): Nullable<Hand> {\n        return this.run<Hand>($$dpth,\n            () => {\n                let $scope$S: Nullable<Suit>;\n                let $scope$H: Nullable<Suit>;\n                let $scope$D: Nullable<Suit>;\n                let $scope$C: Nullable<Suit>;\n                let $$res: Nullable<Hand> = null;\n                if (true\n                    && ($scope$S = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$H = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$D = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$C = this.matchSuit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Hand, S: $scope$S, H: $scope$H, D: $scope$D, C: $scope$C};\n                }\n                return $$res;\n            });\n    }\n    public matchSuit($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit> {\n        return this.run<Suit>($$dpth,\n            () => {\n                let $scope$cards: Nullable<Card[]>;\n                let $$res: Nullable<Suit> = null;\n                if (true\n                    && ($scope$cards = this.loop<Card>(() => this.matchCard($$dpth + 1, $$cr), true)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Suit, cards: $scope$cards};\n                }\n                return $$res;\n            });\n    }\n    public matchCard($$dpth: number, $$cr?: ErrorTracker): Nullable<Card> {\n        return this.run<Card>($$dpth,\n            () => {\n                let $scope$c: Nullable<string>;\n                let $$res: Nullable<Card> = null;\n                if (true\n                    && ($scope$c = this.regexAccept(String.raw`(?:[AKQJT2-9])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Card($scope$c);\n                }\n                return $$res;\n            });\n    }\n    public test(): boolean {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        const ans = res !== null;\n        this.reset(mrk);\n        return ans;\n    }\n    public parse(): ParseResult {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        if (res)\n            return {ast: res, errs: []};\n        this.reset(mrk);\n        const rec = new ErrorTracker();\n        this.clearMemos();\n        this.matchStart(0, rec);\n        const err = rec.getErr()\n        return {ast: res, errs: err !== null ? [err] : []}\n    }\n    public mark(): PosInfo {\n        return this.pos;\n    }\n    private loop<T>(func: $$RuleType<T>, star: boolean = false): Nullable<T[]> {\n        const mrk = this.mark();\n        const res: T[] = [];\n        for (;;) {\n            const t = func();\n            if (t === null) {\n                break;\n            }\n            res.push(t);\n        }\n        if (star || res.length > 0) {\n            return res;\n        }\n        this.reset(mrk);\n        return null;\n    }\n    private run<T>($$dpth: number, fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn()\n        if (res !== null)\n            return res;\n        this.reset(mrk);\n        return null;\n    }\n    private choice<T>(fns: Array<$$RuleType<T>>): Nullable<T> {\n        for (const f of fns) {\n            const res = f();\n            if (res !== null) {\n                return res;\n            }\n        }\n        return null;\n    }\n    private regexAccept(match: string, dpth: number, cr?: ErrorTracker): Nullable<string> {\n        return this.run<string>(dpth,\n            () => {\n                const reg = new RegExp(match, \"y\");\n                const mrk = this.mark();\n                reg.lastIndex = mrk.overallPos;\n                const res = this.tryConsume(reg);\n                if(cr) {\n                    cr.record(mrk, res, {\n                        kind: \"RegexMatch\",\n                        // We substring from 3 to len - 1 to strip off the\n                        // non-capture group syntax added as a WebKit workaround\n                        literal: match.substring(3, match.length - 1),\n                        negated: this.negating,\n                    });\n                }\n                return res;\n            });\n    }\n    private tryConsume(reg: RegExp): Nullable<string> {\n        const res = reg.exec(this.input);\n        if (res) {\n            let lineJmp = 0;\n            let lind = -1;\n            for (let i = 0; i < res[0].length; ++i) {\n                if (res[0][i] === \"\\n\") {\n                    ++lineJmp;\n                    lind = i;\n                }\n            }\n            this.pos = {\n                overallPos: reg.lastIndex,\n                line: this.pos.line + lineJmp,\n                offset: lind === -1 ? this.pos.offset + res[0].length : (res[0].length - lind - 1)\n            };\n            return res[0];\n        }\n        return null;\n    }\n    private noConsume<T>(fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn();\n        this.reset(mrk);\n        return res;\n    }\n    private negate<T>(fn: $$RuleType<T>): Nullable<boolean> {\n        const mrk = this.mark();\n        const oneg = this.negating;\n        this.negating = !oneg;\n        const res = fn();\n        this.negating = oneg;\n        this.reset(mrk);\n        return res === null ? true : null;\n    }\n    private memoise<K>(rule: $$RuleType<K>, memo: Map<number, [Nullable<K>, PosInfo]>): Nullable<K> {\n        const $scope$pos = this.mark();\n        const $scope$memoRes = memo.get($scope$pos.overallPos);\n        if(this.memoSafe && $scope$memoRes !== undefined) {\n        this.reset($scope$memoRes[1]);\n        return $scope$memoRes[0];\n        }\n        const $scope$result = rule();\n        if(this.memoSafe)\n        memo.set($scope$pos.overallPos, [$scope$result, this.mark()]);\n        return $scope$result;\n    }\n    private match$EOF(et?: ErrorTracker): Nullable<{kind: ASTKinds.$EOF}> {\n        const res: {kind: ASTKinds.$EOF} | null = this.finished() ? { kind: ASTKinds.$EOF } : null;\n        if(et)\n            et.record(this.mark(), res, { kind: \"EOF\", negated: this.negating });\n        return res;\n    }\n}\nexport function parse(s: string): ParseResult {\n    const p = new Parser(s);\n    return p.parse();\n}\nexport interface ParseResult {\n    ast: Nullable<Start>;\n    errs: SyntaxErr[];\n}\nexport interface PosInfo {\n    readonly overallPos: number;\n    readonly line: number;\n    readonly offset: number;\n}\nexport interface RegexMatch {\n    readonly kind: \"RegexMatch\";\n    readonly negated: boolean;\n    readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\nexport class SyntaxErr {\n    public pos: PosInfo;\n    public expmatches: MatchAttempt[];\n    constructor(pos: PosInfo, expmatches: MatchAttempt[]) {\n        this.pos = pos;\n        this.expmatches = [...expmatches];\n    }\n    public toString(): string {\n        return `Syntax Error at line ${this.pos.line}:${this.pos.offset}. Expected one of ${this.expmatches.map(x => x.kind === \"EOF\" ? \" EOF\" : ` ${x.negated ? 'not ': ''}'${x.literal}'`)}`;\n    }\n}\nclass ErrorTracker {\n    private mxpos: PosInfo = {overallPos: -1, line: -1, offset: -1};\n    private regexset: Set<string> = new Set();\n    private pmatches: MatchAttempt[] = [];\n    public record(pos: PosInfo, result: any, att: MatchAttempt) {\n        if ((result === null) === att.negated)\n            return;\n        if (pos.overallPos > this.mxpos.overallPos) {\n            this.mxpos = pos;\n            this.pmatches = [];\n            this.regexset.clear()\n        }\n        if (this.mxpos.overallPos === pos.overallPos) {\n            if(att.kind === \"RegexMatch\") {\n                if(!this.regexset.has(att.literal))\n                    this.pmatches.push(att);\n                this.regexset.add(att.literal);\n            } else {\n                this.pmatches.push(att);\n            }\n        }\n    }\n    public getErr(): SyntaxErr | null {\n        if (this.mxpos.overallPos !== -1)\n            return new SyntaxErr(this.mxpos, this.pmatches);\n        return null;\n    }\n}","import { either, eitherT, option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, string } from 'fp-ts';\nimport { constant, flow, identity, pipe } from 'fp-ts/lib/function';\n\nimport { assertUnreachable } from '../lib';\nimport { Bid, Strain, zeroSpecificShape } from '../model/bridge';\nimport { constConstraintFalse, constConstraintTrue, ConstrainedBid, Constraint, SuitComparisonOperator, SuitRangeSpecifier } from '../model/constraints';\nimport { rankFromString, ranks, Suit } from '../model/deck';\nimport * as AST from '../parse/bid.peg.g';\n\nconst getConnectiveItems = (items: ReadonlyArray<AST.Constraint>) =>\n  pipe(items,\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.map(flow(\n      readonlyNonEmptyArray.map(constraintFromAST),\n      either.fromPredicate(i => i.length > 1, i => i[0]))))\n\nconst connectiveFromAST = (type: \"Conjunction\" | \"Disjunction\", zero: () => Constraint) =>\n  flow(getConnectiveItems,\n    eitherT.match(option.Functor)(identity, constraints => ({\n      type,\n      constraints\n    }) as const),\n    option.getOrElse(zero))\n\nconst suitFromAST = (s: AST.Suit) : Suit =>\n  s.kind === AST.ASTKinds.Club    ? 'C' :\n  s.kind === AST.ASTKinds.Diamond ? 'D' :\n  s.kind === AST.ASTKinds.Heart   ? 'H' :\n                                    'S'\n\nconst strainFromAST = (s: AST.Strain) : Strain =>\n  s.kind === AST.ASTKinds.Notrump ? 'N' :\n  suitFromAST(s)\n\nconst suitSpecifierFromAST = (s: AST.SuitRangeSpecifier) : SuitRangeSpecifier =>\n  // s.kind === AST.ASTKinds.Major ? \"Major\" :\n  // s.kind === AST.ASTKinds.Minor ? \"Minor\" :\n  suitFromAST(s)\n\nconst bindValueFromASTQualifier = (s: AST.BoundQualifier, value: number) => (type: 'min' | 'max') =>\n  pipe(value,\n    option.of,\n    option.filter(_ =>\n      s.kind === AST.ASTKinds.Equals\n      || (type === 'min' && s.kind === AST.ASTKinds.Plus)\n      || (type === 'max' && s.kind === AST.ASTKinds.Minus)))\n\nexport const constraintFromAST = (c: AST.Constraint) : Constraint => {\n  switch (c.kind) {\n\n    case AST.ASTKinds.True:\n      return constConstraintTrue()\n\n    case AST.ASTKinds.False:\n      return constConstraintFalse()\n\n    case AST.ASTKinds.And:\n      return pipe(\n        c.constraints,\n        readonlyArray.map(c => c.constraint),\n        connectiveFromAST(\"Conjunction\", constConstraintTrue))\n\n    case AST.ASTKinds.Otherwise:\n      return { type: \"Otherwise\" }\n\n    case AST.ASTKinds.Or:\n      const flatten = (head: AST.Constraint, ...items: ReadonlyArray<AST.Constraint>) : readonlyNonEmptyArray.ReadonlyNonEmptyArray<AST.Constraint> =>\n        head.kind === AST.ASTKinds.Or\n        ? flatten(head.left, head.right, ...items)\n        : pipe(items,\n            readonlyNonEmptyArray.fromReadonlyArray,\n            option.fold(\n              () => [head],\n              items => [head, ...flatten(items[0], ...items.slice(1))]))\n      return pipe(\n        flatten(c.left, c.right),\n        connectiveFromAST(\"Disjunction\", constConstraintFalse))\n\n    case AST.ASTKinds.Not:\n      return {\n        type: \"Negation\",\n        constraint: constraintFromAST(c.constraint)\n      }\n\n    case AST.ASTKinds.OtherBid:\n      return {\n        type: \"OtherBid\",\n        bid: {\n          level: c.level.value,\n          strain: strainFromAST(c.strain)\n        }\n      }\n\n    case AST.ASTKinds.PointRange:\n      return {\n        type: \"PointRange\",\n        min: c.lower.value,\n        max: c.upper.value\n      }\n\n    case AST.ASTKinds.PointBound:\n      return {\n        type: \"PointRange\",\n        min: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('min'), option.getOrElse(constant(0))),\n        max: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('max'), option.getOrElse(constant(37))),\n      }\n\n    case AST.ASTKinds.SuitRange:\n      return {\n        type: \"SuitRange\",\n        min: c.lower.value,\n        max: c.upper.value,\n        suit: suitSpecifierFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitComparison:\n      return {\n        type: \"SuitComparison\",\n        op: c.op.v as SuitComparisonOperator,\n        left: suitFromAST(c.left),\n        right: suitFromAST(c.right)\n      }\n\n    case AST.ASTKinds.Primary:\n    case AST.ASTKinds.Secondary:\n      return {\n        type: `Suit${c.kind}`,\n        suit: suitFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitBound:\n      return {\n        type: \"SuitRange\",\n        min: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('min'), option.getOrElse(constant(0))),\n        max: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('max'), option.getOrElse(constant(13))),\n        suit: suitSpecifierFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitHonors:\n      return {\n        type: \"SuitHonors\",\n        suit: suitFromAST(c.suit),\n        honors: pipe(c.honors,\n          readonlyArray.fromArray,\n          readonlyArray.traverse(option.Applicative)(flow(h => h.v, rankFromString)),\n          option.getOrElseW(() => []))\n      }\n\n    case AST.ASTKinds.SuitTop:\n      return {\n        type: \"SuitTop\",\n        suit: suitFromAST(c.suit),\n        count: parseInt(c.x),\n        minRank: ranks[ranks.length - parseInt(c.y)]\n      }\n\n    case AST.ASTKinds.AnyShape:\n      return {\n        type: \"AnyShape\",\n        counts: pipe(c.v, string.split(''), readonlyArray.map(parseInt)) as [number, number, number, number]\n      }\n\n    case AST.ASTKinds.SpecificShape:\n      return {\n        type: \"SpecificShape\",\n        suits: pipe(zeroSpecificShape, readonlyRecord.mapWithIndex((s, _) => c[s].value))\n      }\n\n    case AST.ASTKinds.Relay:\n      return {\n        type: \"Relay\",\n        bid: {\n          level: c.bid.level.value,\n          strain: strainFromAST(c.bid.strain)\n        }\n      }\n    \n    default:\n      return { type: c.kind }\n  }\n}\n\nexport const bidFromAST = (bid: AST.Bid): Bid => {\n  switch (bid.kind) {\n    case AST.ASTKinds.ContractBid:\n      return {\n        level: bid.level.value,\n        strain: strainFromAST(bid.specifier as AST.Strain),\n      }\n    case AST.ASTKinds.Pass:\n      return \"Pass\"\n    default:\n      return assertUnreachable(bid)\n  }\n}\n\nexport const constrainedBidFromAST = (bidSpec: AST.BidSpec) : ConstrainedBid => ({\n  bid: bidFromAST(bidSpec.bid),\n  constraint: pipe(\n    bidSpec.constraints?.constraints,\n    option.fromNullable,\n    option.fold(() => [], readonlyArray.map(c => c.constraint)),\n    connectiveFromAST(\"Conjunction\", constConstraintFalse))\n})\n\nexport const parseBid = AST.parse\n","import { array, either, option, ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlySet, readonlyTuple, refinement, string } from 'fp-ts';\nimport { Either } from 'fp-ts/lib/Either';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport { ReadonlyNonEmptyArray } from 'fp-ts/lib/ReadonlyNonEmptyArray';\nimport * as t from 'io-ts';\nimport * as D from 'io-ts/Decoder';\nimport * as E from 'io-ts/Encoder';\nimport * as iso from 'monocle-ts/Iso';\nimport { O } from 'ts-toolbelt';\nimport { Uuid, UuidLike, UuidTool } from 'uuid-tool';\n\nimport { decodeHand } from '../parse';\nimport { Bid, Board, ContractBid, Deal, directions, isNonContractBid, Strain } from './bridge';\nimport { Card, cards, eqCard, Hand, ordCardDescending } from './deck';\n\nexport type DecodedHand = ReturnType<typeof decodeHand>\nexport type SerializedHand = ReadonlyArray<Card>\nexport type DecodedSerializedHand = DecodedHand extends Either<infer L, unknown> ? either.Either<L, SerializedHand> : never\n\nexport const serializedHandL : iso.Iso<Hand, SerializedHand> = iso.iso(\n  readonlySet.toReadonlyArray(ordCardDescending),\n  readonlySet.fromReadonlyArray(eqCard)\n)\n\nconst liftEither = <E>() => <A, B>(i: iso.Iso<A, B>) => iso.iso<Either<E, A>, Either<E, B>>(either.map(i.get), either.map(i.reverseGet))\nexport const decodedSerializedHandL = liftEither<D.DecodeError>()(serializedHandL)\n\nexport const decodeUuid : D.Decoder<string, Uuid> = {\n  decode: flow(\n    either.fromPredicate(UuidTool.isUuid, s => D.error(s, \"Invalid uuid string\")),\n    either.map(s => new Uuid(s)))\n}\n\nconst MASK = 0b11 as const\nconst getUuidQuads = (uuid: UuidLike) => \n  pipe(new Uuid(uuid.id).toBytes(),\n    readonlyArray.takeLeft(13),\n    readonlyArray.chain(flow(byte =>\n      readonlyArray.unfold([byte, 4 as number] as const, ([byte, i]) =>\n        i === 0\n        ? option.none\n        : option.some([byte & MASK, [byte >> 2, i - 1]] as const)),\n        readonlyArray.reverse))) as ReadonlyNonEmptyArray<number>\n\nexport type SerializedDeal = t.Branded<UuidLike, { readonly Deal: unique symbol }>\nconst isDealUuid: refinement.Refinement<UuidLike, SerializedDeal> =\n  (uuid): uuid is SerializedDeal =>\n    pipe(uuid,\n      getUuidQuads,\n      readonlyArray.reduce(\n        array.replicate(4, 0 as number),\n        (counts, directionIndex) =>\n          { counts[directionIndex] += 1; return counts }),\n      readonlyArray.every(count => count === 13))\n\nconst DealUuidB = t.brand(t.type({ id: t.string }), isDealUuid, 'Deal')\n\nconst dealUuidToDeal: E.Encoder<Deal, SerializedDeal> = {\n  encode: flow(\n    getUuidQuads,\n    readonlyNonEmptyArray.zip(pipe(cards, readonlyNonEmptyArray.sort(ordCardDescending))),\n    readonlyNonEmptyArray.map(([idx, card]) => [directions[idx], card] as const),\n    readonlyNonEmptyArray.groupBy(readonlyTuple.fst),\n    readonlyRecord.map(flow(\n      readonlyNonEmptyArray.map(readonlyTuple.snd),\n      readonlySet.fromReadonlyArray(eqCard))))\n  }\n\ntype CardDirectionPair = readonly [Card, number]\nconst encodeDealAsUuid: E.Encoder<SerializedDeal, Deal> = {\n  encode: flow(\n    readonlyRecord.foldMapWithIndex(ord.trivial)(readonlyArray.getMonoid<CardDirectionPair>())((direction, cards) =>\n      pipe(cards,\n        readonlySet.toReadonlyArray<Card>(ord.trivial),\n        readonlyArray.map(c => [c, directions.indexOf(direction)]))),\n    readonlyArray.sort(ord.contramap((p: CardDirectionPair) => p[0])(ordCardDescending)),\n    readonlyArray.map(readonlyTuple.snd),\n    readonlyArray.chunksOf(4),\n    readonlyArray.map(readonlyArray.reduce(0, (byte, directionIndex) => (byte << 2) + directionIndex)),\n    readonlyArray.concat(readonlyArray.replicate(3, 0)),\n    readonlyArray.toArray,\n    x => (DealUuidB.decode(new Uuid(x)) as either.Right<SerializedDeal>).right)\n  }\n\nexport const serializedDealL = iso.iso<Deal, SerializedDeal>(\n  encodeDealAsUuid.encode,\n  dealUuidToDeal.encode\n)\n\nexport type SerializedBoard = O.Update<Board, \"deal\", SerializedDeal>\nexport const serializedBoardL = iso.iso<Board, SerializedBoard>(\n  b => ({ ...b,\n    deal: serializedDealL.get(b.deal),\n  }),\n  b => ({ ...b,\n    deal: serializedDealL.reverseGet(b.deal),\n  })\n)\n\nexport type SerializedBidPath = t.Branded<string, { readonly BidPath: unique symbol }>\nexport const isBidPath: refinement.Refinement<string, SerializedBidPath> =\n  (s): s is SerializedBidPath =>\n    pipe(s,\n      string.split(\".\"),\n      readonlyArray.every(s => s.length === 2 || isNonContractBid(s)))\n\nexport const serializedContractBidL: iso.Iso<ContractBid, string> = iso.iso(\n  bid => `${bid.level}${bid.strain}`,\n  bid => ({\n    level: parseInt(bid.charAt(0)),\n    strain: bid.charAt(1) as Strain\n  })\n)\n\nexport const serializedBidL : iso.Iso<Bid, string> = iso.iso(\n  bid => isNonContractBid(bid) ? bid : serializedContractBidL.get(bid),\n  bid => isNonContractBid(bid) ? bid : serializedContractBidL.reverseGet(bid)\n)\n\nconst SerializedBidPathB = t.brand(t.string, isBidPath, \"BidPath\")\nexport const serializedBidPathL = iso.iso<readonlyNonEmptyArray.ReadonlyNonEmptyArray<Bid>, SerializedBidPath>(\n  flow(\n    readonlyArray.map(serializedBidL.get),\n    readonlyArray.intersperse(\".\"),\n    readonlyArray.foldMap(string.Monoid)(identity),\n    x => (SerializedBidPathB.decode(x) as either.Right<SerializedBidPath>).right),\n  flow(\n    string.split(\".\"),\n    readonlyNonEmptyArray.map(serializedBidL.reverseGet)))","import { ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlySet, readonlyTuple, string } from 'fp-ts';\nimport { Right } from 'fp-ts/lib/Either';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport * as e from 'io-ts/Encoder';\nimport { Board, directions, ordDirection } from '../model/bridge';\nimport { Card, eqCard, getOrdGroupedHand, groupHandBySuits, Hand, ordRankDescending, Rank, RankC, Suit, suits } from '../model/deck';\nimport * as AST from '../parse/hand.peg.g';\n\n\nconst suitFromAST = (hand: AST.Hand) => (suit: Suit) : ReadonlyArray<Card> =>\n  pipe(hand[suit].cards,\n    readonlyArray.map(card => ({ suit, rank: (RankC.decode(card.rank) as Right<Rank>).right })))\n\nexport const handFromAST = (hand: AST.Hand) : Hand =>\n  pipe(suits,\n    readonlyArray.map(suitFromAST(hand)),\n    readonlyArray.flatten,\n    readonlySet.fromReadonlyArray(eqCard))\n\nexport const parseHand = AST.parse\n\n// PBN hand notation\nexport const handE : e.Encoder<string, Hand> = {\n  encode: flow(\n    groupHandBySuits,\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.sort(getOrdGroupedHand<ReadonlyArray<Rank>>()),\n    readonlyArray.map(flow(\n      readonlyTuple.snd,\n      readonlyArray.sort(ordRankDescending),\n      readonlyArray.reduce(\"\", (cur, rank) => cur + RankC.encode(rank)))),\n    readonlyArray.intersperse(\".\"),\n    readonlyArray.foldMap(string.Monoid)(identity))\n}\n\n// PBN board notation\nexport const boardE : e.Encoder<string, Board> = {\n  encode: ({ dealer, deal }) => pipe(deal,\n    readonlyRecord.map(handE.encode),\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.sort(ord.contramap(readonlyTuple.fst)(ordDirection)),\n    readonlyArray.rotate(directions.indexOf(dealer)),\n    readonlyArray.map(readonlyTuple.snd),\n    readonlyArray.intersperse(\" \"),\n    readonlyArray.prepend(dealer + \":\"),\n    readonlyNonEmptyArray.concatAll(string.Semigroup))\n}","import { either, option, readonlyNonEmptyArray } from 'fp-ts';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport * as d from 'io-ts/Decoder';\nimport * as DE from 'io-ts/lib/DecodeError';\nimport * as FS from 'io-ts/lib/FreeSemigroup';\n\nimport { constrainedBidFromAST, parseBid } from './bid';\nimport { handFromAST, parseHand } from './hand';\n\nexport interface PosInfo {\n  readonly overallPos: number;\n  readonly line: number;\n  readonly offset: number;\n}\nexport interface RegexMatch {\n  readonly kind: \"RegexMatch\";\n  readonly negated: boolean;\n  readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\ninterface SyntaxErr {\n  pos: PosInfo;\n  expmatches: MatchAttempt[];\n  toString(): string\n}\ninterface ParseResult<T> {\n  ast: T | null;\n  errs: SyntaxErr[];\n}\n// above is generalized from generated tsPEG code\n\nconst convertErrors = (errs: ReadonlyArray<SyntaxErr>): d.DecodeError =>\n  pipe(errs,\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.fold(constant(d.error(null, \"No syntax errors reported\")),\n      readonlyNonEmptyArray.foldMapWithIndex(FS.getSemigroup<DE.DecodeError<string>>())((i, err) =>\n        FS.of(DE.index(i, \"required\",\n          FS.of(DE.leaf({\n            pos: err.pos,\n            expmatches: err.expmatches\n          }, err.toString())))))))\n\nconst parseResultToEither = <T>(result: ParseResult<T>) =>\n  either.fromNullable(result.errs)(result.ast)\n\nconst getDecoder = <T>(parser: (input: string) => ParseResult<T>) : d.Decoder<string, T> =>\n  pipe(\n    d.string,\n    d.parse(flow(parser, parseResultToEither, either.mapLeft(convertErrors))))\n\nexport const decodeBid = flow(\n  getDecoder(parseBid).decode,\n  either.map(x => constrainedBidFromAST(x.spec)))\n\nexport const decodeHand = flow(\n  getDecoder(parseHand).decode,\n  either.map(x => handFromAST(x.hand)))","import { either, eq, option as O, readonlyArray as RA, readonlyNonEmptyArray as RNEA, separated, tree } from 'fp-ts';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\n\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { Bid, eqBid } from '../model/bridge';\nimport { ConstrainedBid, validateTree } from '../model/constraints';\nimport { BidTree, extendWithSiblings, filterIncomplete, getAllLeafPaths, pathsWithoutRoot } from '../model/system';\nimport { decodeBid } from '../parse';\n\nexport type DecodedBid = ReturnType<typeof decodeBid>\ninterface Node {\n  blockKey: string\n  text: string\n  bid: O.Option<DecodedBid>\n}\n\ntype State = {\n  system: tree.Tree<Node>\n}\nconst getRoot = () => tree.make<Node>({ blockKey: \"root\", text: \"root\", bid: O.none })\nconst initialState: State = {\n  system: getRoot()\n}\n\nconst getPath = (blockKey: string) =>\n  pathsWithoutRoot(O.Functor)((node: Node, paths: ReadonlyArray<O.Option<RNEA.ReadonlyNonEmptyArray<Node>>>) => {\n    if (node.blockKey === blockKey) {\n      return O.some([node])\n    } else {\n      return pipe(paths, RA.findFirstMap(O.map(RA.prepend(node))))\n    }\n  })\n\nconst flatten =\n  tree.reduce<Node, ReadonlyArray<Node>>([], (items, a) =>\n    pipe(items, RA.append(a)))\n\nexport interface BlockItem {\n  key: string\n  text: string\n  depth: number\n}\n\nconst buildTree = (items: ReadonlyArray<BlockItem>) => {\n  const root = getRoot()\n  var parents = [root]\n  items.forEach(item => {\n    const curr = parents[item.depth + 1] = {\n      forest: [],\n      value: {\n        blockKey: item.key,\n        text: item.text,\n        bid: O.some(decodeBid(item.text))\n      }\n    }\n    parents[item.depth].forest.push(curr)\n  })\n  return root\n}\n\nconst name = 'system'\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setSystem: (state, action: PayloadAction<ReadonlyArray<BlockItem>>) => {\n      state.system = pipe(buildTree(action.payload), castDraft)\n    }\n  }\n})\n\nexport const { setSystem } = slice.actions\n\nexport const selectNodeByKey = (state: State, blockKey: string) =>\n  pipe(\n    state.system,\n    getPath(blockKey),\n    O.chain(RA.last),\n    O.toNullable)\n\nexport const selectPathByKey = (state: State, blockKey: string) =>\n  pipe(\n    state.system,\n    getPath(blockKey),\n    O.toNullable)\n\nexport const selectBidsByKey = (state: State, blockKey: string) =>\n  pipe(\n    getPath(blockKey)(state.system),\n    O.getOrElse(() => [] as ReadonlyArray<Node>),\n    RA.map(n => n.bid),\n    RA.compact,\n    RA.sequence(either.Applicative))\n\nexport const selectRules = (state: State) =>\n  pipe(\n    state.system,\n    flatten,\n    RA.map(n => n.bid),\n    RA.compact,\n  )\n\nexport const selectErrors =\n  flow(\n    selectRules,\n    RA.separate,\n    separated.left)\n\nconst getCompleteByTree =\n  flow(\n    tree.map((n: Node) => n.bid),\n    filterIncomplete)\n\nconst getCompleteTree = (state: State) =>\n  getCompleteByTree(state.system)\n\nexport const selectCompleteByKey = (state: State, blockKey: string) =>\n  pipe(selectPathByKey(state, blockKey),\n    O.fromNullable,\n    O.chain(nodes => pipe(\n      tree.unfoldTree([getRoot().value, ...nodes], ([n0, ...ns]) => {\n        // debugger\n        return [n0, ns.length === 0 ? [] : [ns]]\n      }),\n      getCompleteByTree,\n      extendWithSiblings(eq.contramap<Bid, ConstrainedBid>(c => c.bid)(eqBid)),\n      getAllLeafPaths,\n      RA.head)),\n    O.toNullable)\n\nconst withImplicitPasses =\n  tree.fold((a: ConstrainedBid, bs: tree.Forest<ConstrainedBid>) =>\n    bs.length === 0 || pipe(bs, RA.exists(t => t.value.bid === \"Pass\"))\n    ? tree.make(a, bs)\n    : tree.make(a, pipe(bs,\n      RA.append(tree.make<ConstrainedBid>({ bid: \"Pass\", constraint: { type: \"Otherwise\" }})),\n      RA.toArray)))\n\nexport const selectCompleteBidSubtree = (state: State, options?: { implicitPass: boolean }) : BidTree =>\n  pipe(state,\n    getCompleteTree,\n    options?.implicitPass ? withImplicitPasses : identity,\n    extendWithSiblings(eq.contramap<Bid, ConstrainedBid>(c => c.bid)(eqBid)))\n\nexport const selectAllCompleteBidPaths =\n  flow(selectCompleteBidSubtree,\n    getAllLeafPaths)\n\nexport const selectSystemValid =\n  flow(selectCompleteBidSubtree,\n    validateTree)\n    \n\nexport default slice.reducer","import { readonlyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { from, Observable } from 'rxjs';\n\nexport const maxProcessors = Math.max(window.navigator.hardwareConcurrency - 2, 1)\n\nexport const parallelize = <T>(make: (concurrency: number) => (idx: number) => Observable<T>) : Observable<Observable<T>> =>\n  pipe(\n    maxProcessors,\n    make,\n    f => readonlyArray.makeBy(maxProcessors, f),\n    t => from(t))","/* eslint-disable import/no-webpack-loader-syntax */\n\nimport DDSWorker from 'comlink-loader!./dds.worker'; // inline loader\nimport DealWorker from 'comlink-loader!./deal.worker'; // inline loader\nimport { readonlyArray, readonlyNonEmptyArray } from 'fp-ts';\nimport { observable } from 'fp-ts-rxjs';\nimport { pipe } from 'fp-ts/lib/function';\nimport { from, Observable, repeat, take } from 'rxjs';\nimport { parallelize } from '../lib/concurrency';\nimport { SerializedBoard } from '../model/serialization';\nimport { DoubleDummyResult } from './dds.worker';\n\n\nconst observeBatchedDealsInfinite = (batchSize: number) => {\n  const w = new DealWorker()\n  return pipe(() => w.genDeals(batchSize),\n    observable.fromTask).pipe(\n      repeat())\n}\n\nexport const observeDealsSerial = (count: number) => pipe(\n  observeBatchedDealsInfinite(Math.ceil(Math.log(count))),\n  observable.chain(x => from(x))).pipe(\n    take(count))\n\nexport const observeDealsParallel = (count: number) =>\n  parallelize(concurrency => {\n    const perWorker = Math.floor(count / concurrency)\n    const remainder = Math.floor(count % concurrency)\n    return idx => observeDealsSerial(idx === 0\n      ? perWorker + remainder\n      : perWorker)\n  })\n\nexport const observeResultsSerial = (boards: ReadonlyArray<SerializedBoard>): Observable<DoubleDummyResult> => {\n  const w = new DDSWorker()\n  return pipe(from(boards),\n    observable.chain(board => from(w.getResult(board))))\n}\n\nexport const observeResultsParallel = (boards: readonlyNonEmptyArray.ReadonlyNonEmptyArray<SerializedBoard>) =>\n  parallelize(concurrency => {\n    const perWorker = Math.floor(boards.length / concurrency)\n    const remainder = Math.floor(boards.length % concurrency)\n    return idx => observeResultsSerial(idx === concurrency - 1\n      ? pipe(boards, readonlyArray.takeRight(perWorker + remainder))\n      : pipe(boards.slice(idx * perWorker, (idx + 1) * perWorker)))\n    })","import { either, option, predicate, readonlyArray, readonlyNonEmptyArray, readonlySet, separated } from 'fp-ts';\nimport { observable } from 'fp-ts-rxjs';\nimport { tailRec } from 'fp-ts/lib/ChainRec';\nimport { constFalse, constTrue, flow, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\nimport { WritableDraft } from 'immer/dist/internal';\nimport * as D from 'io-ts/Decoder';\nimport { O } from 'ts-toolbelt';\n\nimport { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { Board, deal, getHcp } from '../model/bridge';\nimport { Constraint, satisfies, satisfiesPath } from '../model/constraints';\nimport { eqCard, Hand, newDeck, ordCardDescending } from '../model/deck';\nimport { DecodedHand, DecodedSerializedHand, decodedSerializedHandL, serializedBoardL, SerializedHand, serializedHandL } from '../model/serialization';\nimport { BidPath } from '../model/system';\nimport { decodeHand } from '../parse';\nimport { observeResultsSerial } from '../workers';\nimport { DoubleDummyResult } from '../workers/dds.worker';\n\nconst name = 'selection'\n\ninterface State {\n  selectedBlockKey: option.Option<string>\n  opener?: DecodedSerializedHand\n  responder?: DecodedSerializedHand\n  result?: DoubleDummyResult\n}\nexport type AuctionPositionType = O.SelectKeys<State, DecodedHand>\n\nconst initialState : State = {\n  selectedBlockKey: option.none\n}\n\ninterface Hands {\n  opener: SerializedHand\n  responder: SerializedHand\n}\n\nconst setHands = (state: WritableDraft<State>) => (hands: readonly [Hand, Hand]) => {\n  const [opener, responder] = hands\n  state.opener = pipe(opener, either.right, decodedSerializedHandL.get, castDraft)\n  state.responder = pipe(responder, either.right, decodedSerializedHandL.get, castDraft)\n}\n\nconst genBoardFromHands = (opener: Hand, responder: Hand) =>\n  pipe(newDeck(),\n    readonlyArray.difference(eqCard)(pipe(opener, readonlySet.toReadonlyArray(ordCardDescending))),\n    readonlyArray.difference(eqCard)(pipe(responder, readonlySet.toReadonlyArray(ordCardDescending))),\n    readonlyArray.chunksOf(13),\n    readonlyArray.map(readonlySet.fromReadonlyArray(eqCard)),\n    ([l, r]) : Board => ({\n      dealer: 'N',\n      deal: {\n        N: opener,\n        S: responder,\n        E: l,\n        W: r\n      }\n    }))\n\nconst getResult = createAsyncThunk('abc', ({ opener, responder}: Hands) =>\n  pipe(\n    genBoardFromHands(serializedHandL.reverseGet(opener), serializedHandL.reverseGet(responder)),\n    serializedBoardL.get,\n    readonlyNonEmptyArray.of,\n    observeResultsSerial,\n    observable.toTask,\n    t => t()))\n\nconst genUntilCondition = (limit: option.Option<number>) => (condition: predicate.Predicate<readonly [Hand, Hand]>) =>\n  tailRec(limit, l => {\n    if (pipe(l, option.fold(constFalse, i => i === 0))) {\n      return either.right(option.none)\n    } else {\n      const d = deal(newDeck())\n      const hands = [d.N, d.S] as const\n      const result = condition(hands)\n      return result\n        ? either.right(option.some(hands))\n        : either.left(pipe(l, option.map(i => i - 1)))\n    }\n  })\n\nconst genMatchingOf = (length: predicate.Predicate<number>) => (paths: readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>) =>\n  genUntilCondition(option.some(10000))(hands =>\n    pipe(paths,\n      readonlyArray.partition(satisfiesPath(...hands)),\n      separated.right,\n      x => length(x.length)))\n\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setSelectedBlockKey: (state, action: PayloadAction<option.Option<string>>) => {\n      state.selectedBlockKey = action.payload\n    },\n    setHand: {\n      reducer: (state, action: PayloadAction<string, string, AuctionPositionType>) => {\n        state[action.meta] = pipe(action.payload, decodeHand, decodedSerializedHandL.get, castDraft)\n      },\n      prepare: (payload, meta) => ({ payload, meta })\n    },\n    genOnce: (state) => {\n      pipe(\n        genUntilCondition(option.none)(constTrue),\n        option.map(setHands(state)))\n    },\n    getHandsMatchingPath: (state, action: PayloadAction<BidPath>) => {\n      pipe(\n        genUntilCondition(option.some(10000))(hands =>\n          satisfiesPath(...hands)(action.payload)),\n        option.map(setHands(state)))\n    },\n    genHandsNotMatchingAnyOf: {\n      reducer: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>, string, number>) => {\n        pipe(\n          genUntilCondition(option.some(10000))(hands =>\n            getHcp(hands[0]) >= action.meta\n            && pipe(action.payload, readonlyArray.every(predicate.not(satisfiesPath(...hands))))),\n          option.map(setHands(state)))\n      },\n      prepare: (payload: readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>, openerMinHcp: number) =>\n        ({ payload, meta: openerMinHcp })\n    },\n    genHandsMatchingExactlyOneOf: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>>) => {\n      pipe(\n        genMatchingOf(l => l === 1)(action.payload),\n        option.map(setHands(state)))\n    },\n    genHandsMatchingMoreThanOneOf: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>>) => {\n      pipe(\n        genMatchingOf(l => l > 1)(action.payload),\n        option.map(setHands(state)))\n    }\n  },\n  extraReducers: builder => builder\n    .addCase(getResult.fulfilled, (state, action) => {\n      state.result = pipe(action.payload, castDraft)\n    })\n  })\n\n\nexport const { setSelectedBlockKey, setHand, genOnce, getHandsMatchingPath, genHandsNotMatchingAnyOf, genHandsMatchingExactlyOneOf, genHandsMatchingMoreThanOneOf } = slice.actions\nexport { getResult };\n\nexport default slice.reducer\n\nexport const selectBlockKey = (state: State) =>\n  pipe(state.selectedBlockKey,\n    option.toNullable)\n\nexport const selectTestConstraint = (state: State, constraint: Constraint) : boolean =>\n  pipe(state.opener,\n    either.fromNullable(D.error(undefined, \"No hand defined yet\")),\n    either.flatten,\n    decodedSerializedHandL.reverseGet,\n    either.exists(satisfies(constraint)))\n\nexport const selectHand = (state: State, type: AuctionPositionType) : option.Option<Hand> =>\n  pipe(state[type],\n    option.fromNullable,\n    option.chain(flow(decodedSerializedHandL.reverseGet, option.fromEither)))","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from './store';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import 'draft-js/dist/Draft.css';\n\nimport { BlockItem, setSystem } from '../reducers/system';\nimport { Editor as DraftJsEditor, EditorState, RichUtils, convertFromRaw, convertToRaw, getDefaultKeyBinding } from 'draft-js';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { option } from 'fp-ts';\nimport { setSelectedBlockKey } from '../reducers/selection';\nimport { useAppDispatch } from '../app/hooks';\n\nconst getItemsFromBlocks = (editorState: EditorState) =>\n  editorState.getCurrentContent().getBlockMap().toArray().map<BlockItem>(x => ({\n    key: x.getKey(),\n    text: x.getText(),\n    depth: x.getDepth()\n  }))\n\nconst Editor = () => {\n  const [editorState, setEditorState] = useState(() => EditorState.createEmpty());\n  const dispatch = useAppDispatch()\n\n  const onChange = useCallback((editorState: EditorState) => {\n    setEditorState(editorState)\n    localStorage.setItem(\"editor\", JSON.stringify(convertToRaw(editorState.getCurrentContent())))\n    dispatch(setSystem(getItemsFromBlocks(editorState)))\n    dispatch(setSelectedBlockKey(option.some(editorState.getSelection().getFocusKey())))\n  }, [dispatch])\n\n  useEffect(() => {\n    const savedEditorState = localStorage.getItem(\"editor\")\n    if (savedEditorState) {\n      setEditorState(() => EditorState.createWithContent(convertFromRaw(JSON.parse(savedEditorState))))\n    } else {\n      setEditorState(() => RichUtils.toggleBlockType(editorState, 'unordered-list-item'))\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  \n  return (\n    <DraftJsEditor\n      editorState={editorState}\n      onChange={onChange}\n      // https://github.com/facebook/draft-js/blob/master/examples/draft-0-10-0/rich/rich.html#L61\n      keyBindingFn={e => {\n        if (e.keyCode === 9 /* TAB */) {\n          const newEditorState = RichUtils.onTab(e, editorState, 10, /* maxDepth */);\n          if (newEditorState !== editorState) {\n            onChange(newEditorState)\n          }\n          return null;\n        }\n        return getDefaultKeyBinding(e);\n      }}\n    />\n  )\n}\n\nexport default Editor","import { either, eq, number, option, ord, readonlyArray, readonlyRecord, writer } from 'fp-ts';\nimport { constant, flow, identity, pipe } from 'fp-ts/lib/function';\nimport * as t from 'io-ts';\nimport { assertUnreachable } from '../lib';\nimport { Contract, ContractModifier, eqStrain, minors, Strain } from './bridge';\n\n\nexport interface ScoreInfo {\n  contract: Contract\n  tricks: number\n  isVulnerable: boolean\n}\n\ntype ScoreComponent = (info: ScoreInfo) => number\n\nconst contractPointMultiplier = (strain: Strain) => \n  pipe(minors, readonlyArray.elem(eqStrain)(strain)) ? 20 : 30\n\nconst contractModMultiplier = (modifier: ContractModifier) => {\n  switch (modifier) {\n    case \"Undoubled\": return 1\n    case \"Doubled\"  : return 2\n    case \"Redoubled\": return 4\n    default: return assertUnreachable(modifier)\n  }\n}\n\nconst contractFirstTrickModifier = (strain: Strain) =>\n  strain === \"N\" ? 10 : 0\n\nconst subtractBookTricks = (tricks: number) =>\n  tricks - 6\n\nexport const making = (contract: Contract, tricks: number) =>\n  pipe(\n    tricks,\n    subtractBookTricks,\n    either.fromPredicate(\n      oddTricks => oddTricks >= contract.level,\n      oddTricks => contract.level - oddTricks))\n\nconst getOddTricks =\n  flow(making, option.fromEither)\n\nconst getOvertricks = (contract: Contract, tricks: number) =>\n  pipe(making(contract, tricks),\n    option.fromEither,\n    option.map(oddTricks => oddTricks - contract.level))\n\nconst getUndertricks = (contract: Contract, tricks: number) =>\n  pipe(making(contract, tricks),\n    either.swap,\n    option.fromEither)\n\nconst whenMaking = (f: (oddTricks: number) => number) => (info: ScoreInfo) =>\n  pipe(getOddTricks(info.contract, info.tricks),\n    option.fold(constant(0), f))\n\nconst contractPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(() =>\n    contractModMultiplier(info.contract.modifier) *\n    ((info.contract.level * contractPointMultiplier(info.contract.strain)) + contractFirstTrickModifier(info.contract.strain))))\n\nconst vulnerableMultiplier = (isVulnerable: boolean) =>\n  50 * (isVulnerable ? 2 : 1)\n\nconst getModified = (modifier: ContractModifier) : option.Option<\"Doubled\" | \"Redoubled\"> =>\n  modifier === \"Undoubled\" ? option.none : option.some(modifier)\n\nconst overtrickBonus = (isVulnerable: boolean, modifier: ContractModifier) => \n  pipe(modifier,\n    getModified,\n    option.map(contractModMultiplier),\n    option.map(x => x * vulnerableMultiplier(isVulnerable)))\n\nconst overtrickPoints: ScoreComponent = info =>\n  pipe(getOvertricks(info.contract, info.tricks),\n    option.fold(constant(0), overtricks =>\n      pipe(\n        overtrickBonus(info.isVulnerable, info.contract.modifier),\n        option.getOrElseW(() => contractPointMultiplier(info.contract.strain)),\n        multiplier => overtricks * multiplier)))\n\nconst slamPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(oddTricks =>\n    (info.isVulnerable ? 1.5 : 1) *\n    (info.contract.level === 6 && oddTricks >= 6 ? 500 :\n      info.contract.level === 7 && oddTricks >= 7 ? 1000 : 0)))\n\nconst modifierPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(() => {\n    switch (info.contract.modifier) {\n      case \"Undoubled\": return 0\n      case \"Doubled\"  : return 50\n      case \"Redoubled\": return 100\n      default: return assertUnreachable(info.contract.modifier)\n    }\n  }))\n\nconst doubledPenalties = [100, 200, 200, ...readonlyArray.replicate(10, 300)]\n\nconst penaltyPoints: ScoreComponent = info =>\n  pipe(getUndertricks(info.contract, info.tricks),\n    option.fold(constant(0), undertricks =>\n      pipe(info.contract.modifier,\n        getModified,\n        option.fold(\n          () => undertricks * vulnerableMultiplier(info.isVulnerable),\n          flow(contractModMultiplier,\n            multiplier => (multiplier / 2) * pipe(\n              doubledPenalties,\n              readonlyArray.takeLeft(undertricks + (info.isVulnerable ? 1 : 0)),\n              readonlyArray.foldMap(number.MonoidSum)(identity)))),\n        x => -x)))\n\nconst partScorePoints: ScoreComponent =\n  flow(contractPoints, score =>\n    score > 0 && score <= 100 ? 50 : 0)\n\nconst gamePoints: ScoreComponent = info =>\n  pipe(info, contractPoints, score =>\n    score >= 100 ? (info.isVulnerable ? 500 : 300) : 0)\n\nconst scoreComponents : readonlyRecord.ReadonlyRecord<string, ScoreComponent> = {\n  contractPoints : contractPoints,\n  overtrickPoints: overtrickPoints,\n  slamPoints     : slamPoints,\n  modifierPoints : modifierPoints,\n  penaltyPoints  : penaltyPoints,\n  partScorePoints: partScorePoints,\n  gamePoints     : gamePoints,\n}\n\nconst ScoreC = t.brand(t.number, (i) : i is t.Branded<number, { readonly Score: unique symbol }> => typeof i === \"number\", 'Score')\nexport type Score = t.TypeOf<typeof ScoreC>\nexport const zeroScore = (ScoreC.decode(0) as either.Right<Score>).right\nexport const eqScore : eq.Eq<Score> = number.Eq\nexport const ordScore : ord.Ord<Score> = pipe(number.Ord, ord.reverse)\n\nexport type ScoreComponentLog = readonly [string, number]\n\ntype W = ReadonlyArray<ScoreComponentLog>\nexport const scoreW = (info: ScoreInfo): writer.Writer<W, Score> => \n  pipe(\n    scoreComponents,\n    readonlyRecord.flap(info),\n    readonlyRecord.traverseWithIndex(writer.getApplicative(readonlyArray.getMonoid<ScoreComponentLog>()))((name, score) => pipe(\n      writer.tell([[name, score]] as const),\n      writer.map(constant(score)))),\n    writer.map(flow(\n      readonlyRecord.foldMap(ord.trivial)(number.MonoidSum)(identity),\n      ScoreC.decode,\n      s => (s as either.Right<Score>).right)),\n    writer.map((s): [Score, (w: W) => W] => [s, cs => [[\"TOTAL\", s], ...cs]]),\n    writer.pass)\n\nexport const score = flow(scoreW, writer.evaluate)","import { either, eitherT, option, readonlyArray, readonlyMap, readonlyNonEmptyArray as RNEA, readonlyRecord as RR, readonlyTuple, refinement, semigroup } from 'fp-ts';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport { ordAscending, ordDescending } from '../lib';\nimport { ContractBid, contractBids, ContractModifier, Direction, getIsVulnerable, ordContractBid, Strain, Vulnerability } from './bridge';\nimport { eqScore, making, ordScore, Score, score, zeroScore } from './score';\n\n\nexport type TrickCountsByStrain = RR.ReadonlyRecord<Strain, number>\nexport type TrickCountsByDirection = RR.ReadonlyRecord<Direction, number>\nexport type TrickCountsByStrainThenDirection = RR.ReadonlyRecord<Strain, TrickCountsByDirection>\nexport type TrickCountsByDirectionThenStrain = RR.ReadonlyRecord<Direction, TrickCountsByStrain>\n\nexport const flattenNestedCounts = <K1 extends string, K2 extends string, T>(table: RR.ReadonlyRecord<K1, RR.ReadonlyRecord<K2, T>>) =>\n  pipe(readonlyArray.Do,\n    readonlyArray.apS('inner', pipe(table, RR.toReadonlyArray)),\n    readonlyArray.bind('outer', ({ inner }) => pipe(inner[1], RR.toReadonlyArray)),\n    readonlyArray.map(({ outer, inner }) => ({ outerKey: outer[0], innerKey: inner[0], value: outer[1] })))\n\nexport const transpose = <K1 extends string, K2 extends string, T>(table: RR.ReadonlyRecord<K1, RR.ReadonlyRecord<K2, T>>) : RR.ReadonlyRecord<K2, RR.ReadonlyRecord<K1, T>> =>\n  pipe(table,\n    flattenNestedCounts,\n    RNEA.fromReadonlyArray,\n    option.fold(() => ({}),\n    RNEA.groupBy(x => x.outerKey)),\n    RR.map(flow(\n      RNEA.fromReadonlyArray,\n      option.fold(() => ({}),\n      RNEA.groupBy(x => x.innerKey)),\n      RR.map(x => x[0].value))))\n\n\ntype OptimalBid = ContractBid | \"Pass\"\nconst initialContractBid: refinement.Refinement<OptimalBid, ContractBid> = (b): b is ContractBid => b !== \"Pass\"\nconst initialBids = pipe(\n  contractBids,\n  readonlyArray.sort(ordContractBid),\n  readonlyArray.prepend<OptimalBid>(\"Pass\"))\nconst ordInitialBidsAscending = ordAscending(initialBids)\nconst ordInitialBidsDescending = ordDescending(initialBids)\n\ntype ContractScorePair = readonly [OptimalBid, Score]\nconst getDirectionScores = (counts: TrickCountsByStrain) => (isVulnerable: boolean) =>\n  pipe(initialBids,\n    readonlyArray.map(either.fromPredicate(initialContractBid, () => \"Pass\" as const)),\n    eitherT.match(readonlyArray.Functor)(\n      (pass): ContractScorePair => [pass, zeroScore],\n      (bid): ContractScorePair => {\n        const tricks = counts[bid.strain]\n        const modifier: ContractModifier = pipe(\n          making({ ...bid, modifier: \"Undoubled\" }, tricks),\n          either.fold(constant(\"Doubled\"), constant(\"Undoubled\")))\n        return [bid, score({ contract: { ...bid, modifier}, tricks, isVulnerable })]\n      }))\n\nconst getAllScores = (table: TrickCountsByDirectionThenStrain) => (vulnerability: Vulnerability) =>\n  pipe(table,\n    RR.mapWithIndex((direction, counts) =>\n      getDirectionScores(counts)(getIsVulnerable(direction, vulnerability))))\n\n// const byContractDescending : ord.Ord<ContractScorePair> =\n//   ord.contramap(readonlyTuple.fst)(ordInitialBidsDescending)\n\nconst shakeContracts = (contractScorePairs: RNEA.ReadonlyNonEmptyArray<ContractScorePair>) =>\n  pipe(contractScorePairs,\n    RNEA.map(readonlyTuple.swap),\n    readonlyMap.fromFoldable(eqScore, semigroup.max(ordInitialBidsDescending), RNEA.Foldable),\n    readonlyMap.toReadonlyArray(ordScore))\n\nconst pvs = (direction: Direction, availableMoves: RNEA.ReadonlyNonEmptyArray<ContractScorePair>): OptimalBid => \"Pass\"\n\nexport interface IndependentVariables {\n  dealer: Direction\n  vulnerability: Vulnerability\n}\nexport const parScore = (table: TrickCountsByStrainThenDirection) => (vars: IndependentVariables): Score => zeroScore\n","import { either, option, ord, readonlyArray, readonlyRecord, readonlySet, readonlyTuple, semigroup, task, taskEither } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { Encoder } from 'io-ts/lib/Encoder';\nimport { Uuid } from 'uuid-tool';\nimport { TrickCountsByDirectionThenStrain, TrickCountsByStrain } from '../model/analyze';\nimport { Deal, Direction, directions, getHandSpecificShape, getHcp, SpecificShape } from '../model/bridge';\nimport { Card, ordCardDescending } from '../model/deck';\n\n\n// const Uuid = t.brand(t.string, (s: string): s is t.Branded<string, { readonly Uuid: unique symbol }> => validate(s), 'Uuid')\n// type Uuid = t.TypeOf<typeof Uuid>\n\ntype CardDirectionPair = readonly [Card, number]\nconst encode: Encoder<Uuid, Deal> = {\n  encode: flow(\n      readonlyRecord.foldMapWithIndex(ord.trivial)(readonlyArray.getMonoid<CardDirectionPair>())((direction, cards) =>\n        pipe(cards,\n          readonlySet.toReadonlyArray<Card>(ord.trivial),\n          readonlyArray.map(c => [c, directions.indexOf(direction)]))),\n      readonlyArray.sort(ord.contramap((p: CardDirectionPair) => p[0])(ordCardDescending)),\n      readonlyArray.map(readonlyTuple.snd),\n      readonlyArray.chunksOf(4),\n      readonlyArray.map(readonlyArray.reduce(0, (byte, directionIndex) => (byte << 2) + directionIndex)),\n      readonlyArray.concat(readonlyArray.replicate(3, 0)),\n      readonlyArray.toArray,\n      x => new Uuid(x))\n}\n\nconst baseUrl = process.env.REACT_APP_API_URL\n\nconst safeFetch = (t: task.Task<Response>) =>\n  taskEither.tryCatchK(t, either.toError)()\n\nexport const ping =\n  pipe(() => fetch(`${baseUrl}/ping`),\n    safeFetch,\n    taskEither.chainTaskK(response => () => response.text()),\n    taskEither.filterOrElse(response => response === \"pong\", () => new Error(\"'pong' was not received\")))\n\ninterface DirectionMetadata {\n  hcp: number\n  shape: SpecificShape\n  tricks?: TrickCountsByStrain\n}\n\ntype DealWithSolution = readonly [Deal, option.Option<TrickCountsByDirectionThenStrain>]\n\nconst getRequestBody =\n  readonlyArray.foldMap(readonlyRecord.getUnionMonoid(semigroup.first<Detail>()))(([deal, table]: DealWithSolution) => ({\n    [encode.encode(deal).toString()]: pipe(deal,\n      readonlyRecord.mapWithIndex((d, h): DirectionMetadata => ({\n        hcp: getHcp(h),\n        shape: getHandSpecificShape(h),\n        tricks: pipe(table, option.map(t => t[d]), option.toUndefined)\n      })))\n    }))\n\nconst getRequestBodyWithoutSolution =\n  flow(\n    readonlyArray.map((deal: Deal) => ([deal, option.none] as const)),\n    getRequestBody)\n\ntype Detail = readonlyRecord.ReadonlyRecord<Direction, DirectionMetadata>\nexport const postDeals = (deals: ReadonlyArray<Deal>) =>\n  pipe(deals,\n    getRequestBodyWithoutSolution,\n    JSON.stringify,\n    task.of,\n    task.chain(body => () =>\n      fetch(`${baseUrl}/deals`, {\n        method: \"POST\",\n        body\n      })),\n    safeFetch)\n\nexport const putDeals = (deals: ReadonlyArray<DealWithSolution>) =>\n  pipe(deals,\n    getRequestBody,\n    JSON.stringify,\n    task.of,\n    task.chain(body => () =>\n      fetch(`${baseUrl}/deals`, {\n        method: \"PUT\",\n        body\n      })),\n    safeFetch)\n\nexport const postDeal = (deal: Deal) => postDeals([deal])","import { magma, number, option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { observable, observableEither } from 'fp-ts-rxjs';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\nimport { Epic } from 'redux-observable';\nimport { bufferCount, concatWith, EMPTY, filter, from } from 'rxjs';\n\nimport { AnyAction, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { RootState } from '../app/store';\nimport { maxProcessors } from '../lib/concurrency';\nimport { transpose } from '../model/analyze';\nimport { ContractBid, makeBoard } from '../model/bridge';\nimport { SerializedBidPath, serializedBidPathL, serializedBoardL, SerializedDeal, serializedDealL } from '../model/serialization';\nimport { BidPath } from '../model/system';\nimport { ping, postDeals, putDeals } from '../services/server';\nimport { observeDealsParallel, observeDealsSerial, observeResultsParallel, observeResultsSerial } from '../workers';\nimport { DoubleDummyResult } from '../workers/dds.worker';\n\nconst name = 'generator'\n\ntype Deals = ReadonlyArray<SerializedDeal>\ntype Results = readonlyRecord.ReadonlyRecord<SerializedBidPath, readonlyNonEmptyArray.ReadonlyNonEmptyArray<DoubleDummyResult>>\ntype Progress<T> = readonly [T, number]\n\nconst getProgress = <T>(a: T): Progress<T> => [a, 0]\nconst updateProgress = <T>(M: magma.Magma<T>) => (decrement: number) => (payload: T) => (progress: Progress<T>): Progress<T> =>\n  pipe(progress,\n    readonlyTuple.bimap(p => p - decrement, current => M.concat(current, payload)))\ninterface State {\n  deals: Progress<Deals>\n  results: Progress<Results>\n  working: boolean\n}\nconst initialState: State = {\n  deals: getProgress([]),\n  results: getProgress({}),\n  working: false\n}\n\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    generate: (state, action: PayloadAction<number>) => {\n      state.deals = pipe(state.deals, readonlyTuple.mapSnd(constant(action.payload)), castDraft)\n      state.working = true\n    },\n    getResults: (state, action: PayloadAction<{ path: BidPath, deals: Deals }>) => {\n      state.results = pipe(state.results, readonlyTuple.mapSnd(constant(action.payload.deals.length)), castDraft)\n      state.working = true\n    },\n    reportDeals: (state, action: PayloadAction<Deals>) => {\n      state.deals = pipe(state.deals,\n        updateProgress\n          (readonlyArray.getSemigroup<SerializedDeal>())\n          (action.payload.length)\n          (action.payload),\n        castDraft)\n    },\n    reportResults: (state, action: PayloadAction<Results>) => {\n      state.results = pipe(state.results,\n        updateProgress\n          (readonlyRecord.getUnionSemigroup(readonlyNonEmptyArray.getSemigroup<DoubleDummyResult>()))\n          (pipe(action.payload,\n            readonlyRecord.toReadonlyArray,\n            readonlyArray.foldMap(number.MonoidSum)(([_, values]) => values.length)))\n          (action.payload),\n        castDraft)\n    },\n    done: (state) => {\n      state.working = false\n    }\n  }\n})\n\nexport const { generate, getResults, reportDeals, reportResults, done } = slice.actions\nexport default slice.reducer\n\ntype E = Epic<AnyAction, AnyAction, RootState>\nexport const analyzeDealsEpic : E = (action$, state$) =>\n  action$.pipe(\n    filter(generate.match),\n    observable.map(a => a.payload),\n    observable.chain(flow(\n      count => count > maxProcessors\n        ? pipe(observeDealsParallel(count), observable.flatten)\n        : observeDealsSerial(count),\n      bufferCount(1000),\n      observable.map(reportDeals),\n      concatWith([done()]))))\n\nexport const analyzeResultsEpic : E = (action$, state$) =>\n  action$.pipe(\n    filter(getResults.match),\n    observable.chain(a =>\n      pipe(\n        a.payload.deals,\n        readonlyArray.mapWithIndex((i, d) =>\n          pipe(d,\n            serializedDealL.reverseGet,\n            makeBoard(i + 1),\n            serializedBoardL.get)),\n        readonlyNonEmptyArray.fromReadonlyArray,\n        option.fold(() => from([]),\n          boards =>\n            a.payload.deals.length > maxProcessors\n            ? pipe(boards, observeResultsParallel, observable.flatten)\n            : pipe(boards, observeResultsSerial)),\n        bufferCount(5),\n        observable.map(flow(\n          readonlyNonEmptyArray.fromReadonlyArray,\n          option.fold(\n            () => reportResults({}),\n            results => pipe(\n              a.payload.path,\n              readonlyNonEmptyArray.map(a => a.bid ),\n              serializedBidPathL.get,\n              path => reportResults(({ [path]: results })))))),\n        concatWith([done()]))))\n\nexport const saveDealsToApiEpic: Epic<AnyAction> = (action$, state$) =>\n  action$.pipe(\n    filter(reportDeals.match),\n    observable.map(a => a.payload),\n    observableEither.fromObservable,\n    observableEither.chainFirst(() => pipe(ping, observableEither.fromTaskEither)),\n    observableEither.chainFirst(flow(\n      readonlyArray.map(serializedDealL.reverseGet),\n      postDeals,\n      observableEither.fromTaskEither)),\n    observable.chain(_ => EMPTY))\n\nexport const saveSolutionsToApiEpic: Epic<AnyAction> = (action$, state$) =>\n  action$.pipe(\n    filter(reportResults.match),\n    observable.map(a => a.payload),\n    observableEither.fromObservable,\n    observableEither.chainFirst(() => pipe(ping, observableEither.fromTaskEither)),\n    observableEither.chainFirst(flow(\n      readonlyRecord.toReadonlyArray,\n      readonlyArray.chain(readonlyTuple.snd),\n      readonlyArray.map(x => [serializedDealL.reverseGet(x.board.deal), pipe(x.results, transpose, option.some)] as const),\n      putDeals,\n      observableEither.fromTaskEither)),\n    observable.chain(_ => EMPTY))    \n        \nexport const selectAllDeals = (state: State) =>\n  pipe(state.deals,\n    readonlyTuple.fst)\n\nexport const selectAllNorthSouthPairs =\n  flow(\n    selectAllDeals,\n    readonlyArray.map(flow(\n      serializedDealL.reverseGet,\n      deal => [deal.N, deal.S] as const)))\n\nexport const selectProgress = (state: State) => ({\n  deals: state.deals[1],\n  results: state.results[1],\n})\n\nexport const selectResultsByPath = (state: State, path: SerializedBidPath) =>\n  pipe(state.results[0],\n    readonlyRecord.lookup(path),\n    option.toNullable)","import { readonlyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\n\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\ninterface State {\n  implicitPass: boolean\n  generateCount: number\n}\n\nconst initialState: State = {\n  implicitPass: false,\n  generateCount: 10000\n}\n\nconst name = 'settings'\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setInitial: (state, action: PayloadAction<SettingsState>) => {\n      pipe(Object.keys(action.payload) as ReadonlyArray<keyof State>,\n        readonlyArray.map(p => (state as any)[p] = action.payload[p] as any))\n    },\n    setProperty: {\n      reducer: (state, action: PayloadAction<any, string, keyof State>) => {\n        (state as any)[action.meta] = action.payload\n      },\n      prepare: <K extends keyof State, V extends State[K]>(key: K, value: V) =>\n        ({ payload: value, meta: key })\n    }\n  }\n})\n\nexport const { setProperty: setSettingsProperty, setInitial: setInitialSettings } = slice.actions\nexport type SettingsState = State\nexport default slice.reducer","import { number, option, ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { ReadonlyNonEmptyArray } from 'fp-ts/lib/ReadonlyNonEmptyArray';\nimport { combineEpics } from 'redux-observable';\n\nimport { AnyAction } from '@reduxjs/toolkit';\n\nimport { RootState } from '../app/store';\nimport { satisfiesPath, satisfiesPathWithoutSiblingCheck } from '../model/constraints';\nimport { serializedBidPathL, SerializedDeal, serializedDealL } from '../model/serialization';\nimport { BidInfo } from '../model/system';\nimport generator, { analyzeDealsEpic, analyzeResultsEpic, saveDealsToApiEpic, saveSolutionsToApiEpic, selectAllDeals } from './generator';\nimport selection, { selectHand } from './selection';\nimport settings from './settings';\nimport system, { selectAllCompleteBidPaths, selectBidsByKey } from './system';\n\nconst reducers = {\n  system,\n  selection,\n  generator,\n  settings\n}\nexport default reducers\n\nexport const rootEpic = combineEpics<AnyAction, AnyAction, RootState>(\n  analyzeDealsEpic,\n  analyzeResultsEpic,\n  saveDealsToApiEpic,\n  saveSolutionsToApiEpic)\n\nexport const selectHandsSatisfySelectedPath = (state: RootState) =>\n  pipe(option.Do,\n    option.apS('blockKey', state.selection.selectedBlockKey),\n    option.apS('opener', selectHand(state.selection, 'opener')),\n    option.apS('responder', selectHand(state.selection, 'responder')),\n    option.chain(o => pipe(\n      selectBidsByKey(state.system, o.blockKey),\n      option.fromEither,\n      option.chain(readonlyNonEmptyArray.fromReadonlyArray),\n      option.map(satisfiesPathWithoutSiblingCheck(o.opener, o.responder)))),\n    option.toNullable)\n\ninterface BidResult {\n  path: ReadonlyNonEmptyArray<BidInfo>\n  result: boolean\n}\nexport const selectPathsSatisfyHands = (state: RootState) : ReadonlyArray<BidResult> | null =>\n  pipe(option.Do,\n    option.apS('opener', selectHand(state.selection, 'opener')),\n    option.apS('responder', selectHand(state.selection, 'responder')),\n    option.map(o => pipe(\n      selectAllCompleteBidPaths(state.system, state.settings),\n      readonlyArray.map(path => ({\n        path,\n        result: satisfiesPath(o.opener, o.responder)(path)\n      })))),\n    option.toNullable)\n\nexport interface BidPathResult {\n  path: ReadonlyNonEmptyArray<BidInfo>\n  count: number\n  deals: ReadonlyNonEmptyArray<SerializedDeal>\n}\nconst ordStats = pipe(\n  number.Ord,\n  ord.reverse,\n  ord.contramap<number, BidPathResult>(r => r.count))\n\nexport const selectSatisfyStats = (state: RootState) : ReadonlyArray<BidPathResult> | null =>\n  pipe(readonlyArray.Do,\n    readonlyArray.apS('deal', selectAllDeals(state.generator)),\n    readonlyArray.apS('path', selectAllCompleteBidPaths(state.system, state.settings)),\n    readonlyArray.map(ra => ({\n      deal: ra.deal,\n      path: ra.path,\n      result: pipe(ra.deal, serializedDealL.reverseGet, d => satisfiesPath(d[\"N\"], d[\"S\"]))(ra.path)\n    })),\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.map(\n      flow(\n        readonlyNonEmptyArray.groupBy(x =>\n          pipe(x.path,\n            readonlyNonEmptyArray.map(p => p.bid),\n            serializedBidPathL.get)),\n        readonlyRecord.filterMap(flow(\n          readonlyNonEmptyArray.filter(a => a.result),\n          option.map(r => ({\n            path: r[0].path,\n            count: r.length,\n            deals: pipe(r, readonlyNonEmptyArray.map(x => x.deal)),\n          })))),\n        readonlyRecord.toReadonlyArray,\n        readonlyArray.map(readonlyTuple.snd),\n        readonlyArray.sort(ordStats))),\n    option.toNullable)","import { selectNodeByKey, selectPathByKey } from \"../reducers/system\"\n\nimport { option } from \"fp-ts\"\nimport { pipe } from \"fp-ts/lib/function\"\nimport { selectHandsSatisfySelectedPath } from \"../reducers\"\nimport { useAppSelector } from \"../app/hooks\"\n\nconst SelectionDetails = () => {\n  const selected = useAppSelector(state => state.selection.selectedBlockKey)\n\n  const path = useAppSelector(state => pipe(selected, option.map(s => selectPathByKey(state.system, s)), option.toNullable))\n  const bid = useAppSelector(state => pipe(selected,\n    option.chain(s => pipe(selectNodeByKey(state.system, s), option.fromNullable)),\n    option.chain(n => n.bid),\n    option.chain(option.fromEither),\n    option.toNullable))\n  const satisfies = useAppSelector(selectHandsSatisfySelectedPath)\n\n  return (\n    <section>\n      <h3>Selection</h3>\n\n      {path && <div>\n        <h4>Selected Path</h4>\n        {path.map(x => x.text).join(\" > \")}\n      </div>}\n\n      {bid && <div>\n        <h4>Selected Bid</h4>\n        {pipe(bid, option.fromNullable, option.map(JSON.stringify), option.toNullable)}\n        {satisfies !== null && <div>\n        <h4>Satisfies</h4>\n        {satisfies.toString()}\n      </div>}\n      </div>}\n    </section>\n  )\n}\n\nexport default SelectionDetails","import { constVoid, flow, pipe } from 'fp-ts/lib/function';\nimport { useCallback, useEffect } from 'react';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { setInitialSettings, setSettingsProperty, SettingsState } from '../reducers/settings';\n\ninterface SettingsValueProps<K, V> {\n  label?: string\n  prop: K\n  parse: (value: string) => V\n  children?: (props: { value: V, onChange: (v: string) => void }) => JSX.Element\n  onChanged?: (v: V) => void\n}\nconst SettingsItem = <K extends keyof SettingsState>({ label, prop, parse, onChanged, children }: SettingsValueProps<K, SettingsState[K]>) => {\n  const value = useAppSelector(state => state.settings[prop])\n  const dispatch = useAppDispatch()\n  const onChange = useCallback((newValue: typeof value) => {\n    dispatch(setSettingsProperty(prop, newValue))\n    onChanged && onChanged(newValue)\n  }, [dispatch, onChanged, prop])\n  return (\n    <p>\n      <span>{label ?? prop}</span>\n      <span>{children\n        ? children({ value, onChange: flow(parse, onChange, constVoid) })\n        : <input type=\"text\" value={value.toString()} onChange={e => pipe(e.target.value, parse, onChange)} style={{width: \"100px\"}} />\n      }</span>\n    </p>\n  )\n}\n\nconst key = \"settings\"\nconst Settings = () => {\n  const settings = useAppSelector(state => state.settings)\n  const dispatch = useAppDispatch()\n  useEffect(() => {\n    const stored = localStorage.getItem(key)\n    if (stored !== null) {\n      const settings: SettingsState = JSON.parse(stored)\n      dispatch(setInitialSettings(settings))\n    }\n  }, [dispatch])\n  const onChanged = useCallback((prop: keyof SettingsState, value: SettingsState[typeof prop]) => {\n    const newSettings: SettingsState = {...settings, [prop]: value }\n    localStorage.setItem(key, JSON.stringify(newSettings))\n  }, [settings])\n  return (\n    <section>\n      <SettingsItem label=\"Implicit Pass\" prop=\"implicitPass\" parse={s => s === \"true\"} onChanged={v => onChanged(\"implicitPass\", v)}>\n        {({ value, onChange}) =>\n          <input type=\"checkbox\" checked={value} onChange={e => onChange(e.target.checked.toString())} />\n      }</SettingsItem>\n      <SettingsItem label=\"Generate Count\" prop=\"generateCount\" parse={parseInt} onChanged={v => onChanged(\"generateCount\", v)} />\n    </section>\n  )\n}\n\nexport default Settings","import * as aq from 'arquero';\nimport { option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple, semigroup } from 'fp-ts';\nimport { sequenceT } from 'fp-ts/lib/Apply';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport * as iso from 'monocle-ts/Iso';\nimport { DoubleDummyTable } from '../workers/dds.worker';\nimport { flattenNestedCounts } from './analyze';\nimport { Direction, directions, Strain, strains } from './bridge';\n\n\nconst SerializedKeyL : iso.Iso<readonly [Direction, Strain], string> = iso.iso(\n  ([d, s]) => d + s,\n  s => [s.charAt(0) as Direction, s.charAt(1) as Strain] as const\n)\n\nconst columns =\n  pipe(\n    sequenceT(readonlyNonEmptyArray.Apply)(\n      directions,\n      strains),\n    readonlyNonEmptyArray.map(SerializedKeyL.get))\n    \nconst toRow = (ddt: DoubleDummyTable) =>\n  pipe(ddt,\n    flattenNestedCounts,\n    readonlyArray.map(({ outerKey: direction, innerKey: strain, value: count }) => [`${direction}${strain}`, count] as const),\n    readonlyRecord.fromFoldable(semigroup.first<number>(), readonlyArray.Foldable)\n)\nexport const getStats = flow(\n  readonlyArray.map(toRow),\n  aq.from)\n\nexport const aggregate = (f: (field: any) => number) => (table: aq.internal.ColumnTable): DoubleDummyTable =>\n  pipe(columns,\n    readonlyNonEmptyArray.groupBy(c => c),\n    readonlyRecord.map(c => f(c)),\n    x => table.rollup(x),\n    table => table.object() as readonlyRecord.ReadonlyRecord<string, number>,\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.map(readonlyTuple.mapFst(SerializedKeyL.reverseGet)),\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.fold(() => ({}), flow(\n      readonlyNonEmptyArray.groupBy(([[_, strain], __]) => strain),\n      readonlyRecord.map(flow(\n        readonlyNonEmptyArray.groupBy(([[direction, _], __]) => direction),\n        readonlyRecord.map(flow(\n          readonlyNonEmptyArray.head,\n          ([_, agg]) => agg)))))))\n\nexport const average = aggregate(aq.op.mean)\nexport const stdev = aggregate(aq.op.stdev)","import { Fragment } from 'react';\nimport styled from 'styled-components';\n\nimport { ContractBid, NonContractBid } from '../../model/bridge';\nimport { ConstrainedBid } from '../../model/constraints';\n\nconst SuitSpan = styled.span `\n  &.S::after { content: \"\"; color: #0000FF; }\n  &.H::after { content: \"\"; color: #FF0000; }\n  &.D::after { content: \"\"; color: #FFA500; }\n  &.C::after { content: \"\"; color: #32CD32; }\n  &.N::after { content: \"NT\" }\n`\n\nconst ContractBidView = (bid: ContractBid) =>\n  <>\n    <span>{bid.level}</span>\n    <SuitSpan className={bid.strain}></SuitSpan>\n  </>\n\nconst NonContractBidView = ({ bid }: { bid: NonContractBid }) =>\n  <span>{bid}</span>\n\ninterface Props {\n  path: ReadonlyArray<ConstrainedBid>\n}\nconst BidPath = ({ path }: Props) => \n  <>{path.map(b => b.bid ).map((bid, i) =>\n    <Fragment key={i}>\n      &nbsp;\n      {typeof bid === \"string\"\n        ? <NonContractBidView bid={bid} />\n        : <ContractBidView {...bid} />}\n    </Fragment>)\n  }</>\n\nexport default BidPath","import { readonlyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport styled from 'styled-components';\nimport { getOrdGroupedHand, groupHandBySuits, Hand, Rank, rankStrings, Suit } from '../../model/deck';\n\n\nconst RankList = styled.ol `\n  padding-left: 0;\n`\n\nconst RankListItem = styled.li `\n  list-style-type: none;\n  display: inline;\n  float: left;\n`\n\ninterface RankProps {\n  rank: Rank\n}\nconst RankView = ({ rank }: RankProps) =>\n  <RankListItem>{rankStrings[rank - 2]}</RankListItem>\n\nconst SuitList = styled.ol `\n  white-space: nowrap;\n  width: 15em;\n  margin: 0;\n  padding-left: 0;\n  list-style: decimal url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) inside;\n`\n\nconst suitBase = `\n  &.S::before { content: \"\"; color: #0000FF }\n  &.H::before { content: \"\"; color: #FF0000 }\n  &.D::before { content: \"\"; color: #FFA500 }\n  &.C::before { content: \"\"; color: #32CD32 }\n`\n\nconst SuitListItem = styled.li `\n  display: inline;\n  &::before {\n    display: inline;\n    float: left;\n    margin-left: 5px;\n  }\n  ${suitBase}\n`\n\ninterface SuitProps {\n  suit: Suit\n  ranks: ReadonlyArray<Rank>\n}\nconst SuitView = ({ suit, ranks }: SuitProps) => {\n  return <SuitListItem className={suit}>\n    <RankList>\n      {ranks.map((r, i) => <RankView key={i} rank={r} />)}\n      {ranks.length === 0 && <RankListItem>-</RankListItem> }\n    </RankList>\n </SuitListItem>\n}\n\ninterface HandProps {\n  hand: Hand\n}\nconst HandView = ({ hand }: HandProps) => {\n  const groupedHand = groupHandBySuits(hand)\n  return (\n    <SuitList>\n      {pipe(groupedHand,\n        readonlyRecord.mapWithIndex((suit, ranks) =>\n          <SuitView key={suit} suit={suit} ranks={ranks} />),\n        readonlyRecord.toReadonlyArray,\n        readonlyArray.sort(getOrdGroupedHand<JSX.Element>()),\n        readonlyArray.map(readonlyTuple.snd))}\n    </SuitList>\n  )\n}\n\nexport default HandView","import styled from 'styled-components';\nimport { directions, strains } from '../../model/bridge';\nimport { serializedDealL } from '../../model/serialization';\nimport { DoubleDummyResult, DoubleDummyTable } from '../../workers/dds.worker';\nimport HandView from './HandView';\n\n\nconst suitBase = `\n  &.S::before { content: \"\"; color: #0000FF }\n  &.H::before { content: \"\"; color: #FF0000 }\n  &.D::before { content: \"\"; color: #FFA500 }\n  &.C::before { content: \"\"; color: #32CD32 }\n`\n\nconst StrainSpan = styled.span `\n  ${suitBase}\n  &.N::before { content: \"NT\"; color: #000000; font-size: 12px; }\n`\n\ninterface DoubleDummyTableProps {\n  table: DoubleDummyTable\n}\nexport const DoubleDummyTableView = ({ table }: DoubleDummyTableProps) => {\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th></th>\n          {strains.map((s, i) => <th style={{fontWeight: \"normal\", verticalAlign: \"middle\"}} key={i}><StrainSpan className={s} /></th>)}\n        </tr>\n      </thead>\n      <tbody>\n        {directions.map((d, i) => <tr key={i}>\n          <td>{d}</td>\n          {strains.map((s, i) => <td key={i}>{Math.round(table[s][d] * 100) / 100}</td>)}\n        </tr>)}\n      </tbody>\n    </table>\n  )\n}\n\ninterface Props {\n  result: DoubleDummyResult\n}\nconst DoubleDummyResultView = ({ result }: Props) => {\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th></th>\n          {strains.map((s, i) => <th style={{fontWeight: \"normal\", verticalAlign: \"middle\"}} key={i}><StrainSpan className={s} /></th>)}\n        </tr>\n      </thead>\n      <tbody>\n        {directions.map((d, i) => <tr key={i}>\n          <td>{d}</td>\n          {strains.map((s, i) => <td key={i}>{result.results[s][d]}</td>)}\n          <td><HandView hand={serializedDealL.reverseGet(result.board.deal)[d]} /></td>\n        </tr>)}\n      </tbody>\n    </table>\n  )\n}\n\nexport default DoubleDummyResultView","import { readonlyNonEmptyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { draw } from 'io-ts/lib/Decoder';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { serializedBidPathL } from '../model/serialization';\nimport { average, getStats, stdev } from '../model/stats';\nimport { BidPathResult, selectSatisfyStats } from '../reducers';\nimport { generate, getResults, selectProgress, selectResultsByPath } from '../reducers/generator';\nimport { selectAllCompleteBidPaths, selectErrors, selectSystemValid } from '../reducers/system';\nimport BidPath from './core/BidPath';\nimport { DoubleDummyTableView } from './core/DoubleDummyResultView';\n\ninterface StatsPathProps {\n  result: BidPathResult\n}\nconst StatsPath = ({ result }: StatsPathProps) => {\n  const dispatch = useAppDispatch()\n  const dds = useAppSelector(state => selectResultsByPath(state.generator, pipe(result.path, readonlyNonEmptyArray.map(p => p.bid), serializedBidPathL.get)))\n  const stats = dds && getStats(pipe(dds, readonlyNonEmptyArray.map(d => d.results)))\n  const averages = stats && average(stats)\n  const stdevs = stats && stdev(stats)\n  return (\n    <>\n      <BidPath path={result.path} />\n      : &nbsp;\n      <span>{result.count.toString()}</span>\n      {averages !== null && <section>\n        <h4>Average</h4>\n        {averages !== null && <DoubleDummyTableView table={averages} />}\n      </section>}\n      {stdevs !== null && <section>\n        <h4>Std. Dev.</h4>\n        <DoubleDummyTableView table={stdevs} />\n      </section>}\n      {dds === null && <button onClick={e => dispatch(getResults({ path: result.path, deals: result.deals }))}>DDS</button>}\n      {/* {dds === null\n        ? <button onClick={e => dispatch(getResults({ path: result.path, deals: result.deals }))}>DDS</button>\n        : <ul>{dds.map((ddr, i) => <li  key={i}><DoubleDummyResultView result={ddr} /></li>)}</ul>} */}\n    </>)\n}\n\nconst SatisfyStats = () => {\n  const stats = useAppSelector(selectSatisfyStats)\n  return (\n    <>\n      {stats !== null && <div>\n        <h3>Results</h3>\n        <ul>\n          {stats.map((result, i) => <li key={i}><StatsPath result={result} /></li>)}\n        </ul>\n      </div>}\n    </>\n  )\n}\n\nconst Progress = () => {\n  const progress = useAppSelector(state => selectProgress(state.generator))\n  return <div>\n    <p>Deals: {progress.deals} remaining</p>\n    <p>Results: {progress.results} remaining</p>\n  </div>\n}\n\nconst Stats = () => {\n  const generating = useAppSelector(state => pipe(state.generator.working))\n  const count = useAppSelector(state => state.settings.generateCount)\n  const dispatch = useAppDispatch()\n  const rules = useAppSelector(state => selectAllCompleteBidPaths(state.system, state.settings))\n  const errors = useAppSelector(state => selectErrors(state.system))\n  const valid = useAppSelector(state => selectSystemValid(state.system, state.settings))\n  const showGenerate = rules !== null && rules.length > 0 && errors.length === 0 && valid\n  return (\n    <section>\n      <h3>Stats</h3>\n      {!showGenerate && <div>\n        <p>Select the system and/or fix errors</p>\n        {rules === null && <p>No complete rules found or system not selected</p>}\n        {!valid && <p>System is not valid</p>}\n        {errors.length > 0 && <div>\n          <h4>Errors</h4>\n          <ul>{errors.map((e, i) => <li key={i}>{draw(e)}</li>)}</ul>\n        </div>}\n      </div>}\n      {showGenerate && <div>\n        <button type=\"button\" onClick={() => dispatch(generate(count))}>Generate deals</button>\n        {generating ? <span>Generating...</span> : <span>Ready!</span>}\n        {generating && <Progress />}\n        {!generating && <SatisfyStats />}\n      </div>}\n    </section>\n  )\n}\n\nexport default Stats","import { either, option } from \"fp-ts\"\n\nimport { DecodeError } from \"io-ts/Decoder\"\nimport { draw } from \"io-ts/lib/Decoder\"\nimport { pipe } from \"fp-ts/lib/function\"\n\ninterface OptionProps<T> {\n  value: option.Option<T>\n  children: (value: T) => JSX.Element\n  onNone?: () => JSX.Element\n}\nexport const Option = <T extends {}>({value, children: onSuccess, onNone }: OptionProps<T>) => \n  pipe(value, option.fold(\n    () => onNone ? onNone() : <></>,\n    onSuccess))\n\ninterface DecodeProps<T> {\n  value: either.Either<DecodeError, T>\n  children: (value: T) => JSX.Element\n  onError?: (error: DecodeError) => JSX.Element\n}\nexport const Decode = <T extends {}>({value, children: onSuccess, onError }: DecodeProps<T>) => \n  pipe(value, either.fold(\n    e => onError ? onError(e) : <span>{draw(e)}</span>,\n    onSuccess))","import { option, readonlyNonEmptyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { useState } from 'react';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { BidPaths } from '../model/system';\nimport { genHandsMatchingExactlyOneOf, genHandsMatchingMoreThanOneOf, genHandsNotMatchingAnyOf, genOnce, getHandsMatchingPath, selectBlockKey } from '../reducers/selection';\nimport { selectAllCompleteBidPaths, selectCompleteByKey } from '../reducers/system';\n\nconst GenerateOnce = () => {\n  const dispatch = useAppDispatch()\n  return (\n    <button type=\"button\" onClick={() => dispatch(genOnce())}>Random</button>\n  )\n}\n\ninterface GenerateSystemProps {\n  bidPaths: BidPaths | null\n}\n\nconst GenerateMatchZero = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  const [minHcp, setMinHcp] = useState<number>(11)\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsNotMatchingAnyOf(bidPaths, minHcp))}>Zero</button>\n      Min HCP\n      <input type=\"number\" style={{width: 50}} value={minHcp} onChange={e => setMinHcp(parseInt(e.target.value))} />\n    </span>}\n  </>\n}\n\nconst GenerateMatchOne = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsMatchingExactlyOneOf(bidPaths))}>One</button>\n    </span>}\n  </>\n}\n\nconst GenerateMatchMany = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsMatchingMoreThanOneOf(bidPaths))}>Many</button>\n    </span>}\n  </>\n}\n\nconst GenerateMatchSelected = () => {\n  const blockKey = useAppSelector(state => selectBlockKey(state.selection))\n  const bidPath = useAppSelector(state => blockKey !== null ? selectCompleteByKey(state.system, blockKey) : null)\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPath && <button type=\"button\" onClick={() => dispatch(getHandsMatchingPath(bidPath))}>Selected</button>}\n  </>\n}\n\nconst SelectionGenerators = () => {\n  const bidPaths = useAppSelector(state =>\n    pipe(selectAllCompleteBidPaths(state.system, state.settings),\n      readonlyNonEmptyArray.fromReadonlyArray,\n      option.toNullable)) \n  return (\n    <section>\n      <h4>Generate Hands</h4>\n      <GenerateOnce />\n      <GenerateMatchSelected />\n      <GenerateMatchZero bidPaths={bidPaths} />\n      <GenerateMatchOne bidPaths={bidPaths} />\n      <GenerateMatchMany bidPaths={bidPaths} />\n    </section>)\n}\n\nexport default SelectionGenerators","import { option, readonlyRecord } from 'fp-ts';\nimport { constVoid, flow, pipe } from 'fp-ts/lib/function';\nimport { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { serializedHandL } from '../model/serialization';\nimport { handE } from '../parse/hand';\nimport { AuctionPositionType, getResult, selectHand, setHand } from '../reducers/selection';\nimport DoubleDummyResultView from './core/DoubleDummyResultView';\nimport HandView from './core/HandView';\nimport { Option } from './core/Monad';\nimport SelectionGenerators from './SelectionGenerators';\n\n\ninterface HandInputProps {\n  type: AuctionPositionType\n}\nconst HandInput = ({ type }: HandInputProps) => {\n  const dispatch = useAppDispatch()\n  const [value, setValue] = useState<string>(\"\")\n  const storageKey = `hand.${type}`\n\n  const encodedHand = useAppSelector(state => pipe(selectHand(state.selection, type), option.map(handE.encode), option.toNullable))\n\n  const onSetHand = useCallback((hand: string) => {\n    setValue(hand)\n    dispatch(setHand(hand, type))\n  }, [dispatch, type])\n\n  useEffect(() => {\n    const savedHand = localStorage.getItem(storageKey)\n    if (savedHand) {\n      onSetHand(savedHand)\n    }\n  }, [onSetHand, storageKey, type])\n\n  return <input type=\"text\" placeholder=\"AKQJ.T987.654.32\" value={encodedHand ?? value} onChange={e => onSetHand(e.target.value)} onBlur={() => localStorage.setItem(storageKey, value)} />\n}\n\nconst HandCol = styled.th `\n  width: 15em;\n`\n\nconst HandEditor = () => {\n  const dispatch = useAppDispatch()\n  const [o, r] = [\n    useAppSelector(state => selectHand(state.selection, 'opener')),\n    useAppSelector(state => selectHand(state.selection, 'responder'))\n  ]\n  const getResultCallback = useCallback(() => pipe(\n    option.Do,\n    option.apS('opener', o),\n    option.apS('responder', r),\n    option.map(flow(\n      readonlyRecord.map(serializedHandL.get),\n      getResult,\n      dispatch)),\n    constVoid), [dispatch, o, r])\n\n  const result = useAppSelector(state => state.selection.result)\n  \n  return (\n    <>\n      <table>\n        <thead>\n          <tr>\n            <HandCol>Opener</HandCol>\n            <HandCol>Responder</HandCol>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><HandInput type=\"opener\" /></td>\n            <td><HandInput type=\"responder\" /></td>\n          </tr>\n          <tr>\n            <td><Option value={o}>{hand => <HandView hand={hand} />}</Option></td>\n            <td><Option value={r}>{hand => <HandView hand={hand} />}</Option></td>\n          </tr>\n        </tbody>\n      </table>\n      <SelectionGenerators />\n      <p>\n        <button type=\"button\" onClick={getResultCallback}>Solution</button> \n        {result && <DoubleDummyResultView result={result} /> }\n      </p>\n    </>\n  )\n}\n\nexport default HandEditor","import { useAppSelector } from '../app/hooks';\nimport { selectPathsSatisfyHands } from '../reducers';\nimport { selectSystemValid } from '../reducers/system';\nimport BidPath from './core/BidPath';\nimport HandEditor from './HandEditor';\n\nconst TestHands = () => {\n  const valid = useAppSelector(state => selectSystemValid(state.system, state.settings))\n  const results = useAppSelector(selectPathsSatisfyHands)\n  \n  return (\n    <section>\n      <h3>Test Hands</h3>\n      <HandEditor />\n      <h4>Valid System?</h4>\n      {valid.toString()}\n      {results !== null && <div>\n        <h4>Results</h4>\n        <ul>\n          {results.map((r, i) => <li key={i}>\n            <BidPath path={r.path} />\n            : &nbsp;\n            <span>{r.result.toString()}</span>\n          </li>)}\n        </ul>\n      </div>}\n    </section>\n  )\n}\n\nexport default TestHands","import Editor from './Editor';\nimport SelectionDetails from './SelectionDetails';\nimport Settings from './Settings';\nimport Stats from './Stats';\nimport TestHands from './TestHands';\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <div style={{display: \"inline-block\", width: '50%'}}>\n        <div style={{float: \"left\"}}>\n          <Editor />\n        </div>\n        <div style={{float: \"right\", width: \"300px\"}}>\n          <Settings />\n        </div>\n        <div style={{clear: \"both\"}}>\n          <Stats />\n        </div>\n      </div>\n      <div style={{display: \"inline-block\", width: '50%', float: \"right\"}}>\n        <div style={{display: \"inline-block\", float: 'right'}}>\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge#documentation\">Documentation</a>\n          &nbsp;|&nbsp;\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge/discussions\">Share ideas</a>\n          &nbsp;|&nbsp;\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge/issues/new\">Report issue</a>\n        </div>\n        <TestHands />\n        <SelectionDetails />\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import { Action, AnyAction, ThunkAction, configureStore } from '@reduxjs/toolkit';\nimport reducer, { rootEpic } from '../reducers';\n\nimport { createEpicMiddleware } from 'redux-observable';\n\ntype R = typeof reducer\nexport type RootState = { [K in keyof R]: ReturnType<R[K]> }\n\nconst epicMiddleware = createEpicMiddleware<AnyAction, AnyAction, RootState>()\nexport const store = configureStore({\n  reducer: reducer,\n  middleware: (getDefaultMiddleware => [...getDefaultMiddleware(), epicMiddleware])\n})\nepicMiddleware.run(rootEpic)\n\nexport type AppDispatch = typeof store.dispatch;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;","import './index.css';\n\nimport * as serviceWorker from './serviceWorker';\n\nimport App from './components';\nimport { Provider } from 'react-redux';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { store } from './app/store';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}