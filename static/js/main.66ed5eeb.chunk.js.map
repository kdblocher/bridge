{"version":3,"sources":["workers/dds.worker.ts","workers/deal.worker.ts","webpack:///./src/workers/dds.worker.ts?517b","webpack:///./src/workers/deal.worker.ts?9d69","serviceWorker.ts","app/hooks.ts","lib/index.ts","model/deck.ts","model/bridge.ts","model/system.ts","model/constraints.ts","model/serialization.ts","parse/bid.peg.g.ts","parse/hand.peg.g.ts","parse/bid.ts","parse/hand.ts","parse/index.ts","lib/concurrency.ts","workers/index.ts","reducers/selection.ts","reducers/system.ts","components/Editor.tsx","model/score.ts","model/analyze.ts","services/server.ts","reducers/generator.ts","reducers/settings.ts","reducers/index.ts","components/SelectionDetails.tsx","components/Settings.tsx","model/stats.ts","components/core/BidPath.tsx","components/core/HandView.tsx","components/core/DoubleDummyResultView.tsx","components/Stats.tsx","components/core/Monad.tsx","components/SelectionGenerators.tsx","components/HandEditor.tsx","components/TestHands.tsx","components/index.tsx","app/store.ts","index.tsx"],"names":["inst","wrap","Worker","module","exports","f","this","Boolean","window","location","hostname","match","useAppDispatch","useDispatch","useAppSelector","useSelector","assertUnreachable","x","Error","JSON","stringify","debug","ordAscending","array","pipe","number","Ord","ord","contramap","indexOf","ordDescending","flow","reverse","suits","eqSuit","eq","eqStrict","ordSuitDescending","rankStrings","RankB","t","i","RankC","is","validate","r","eqRank","ordRankAscending","ordRankDescending","ranks","readonlyArray","mapWithIndex","idx","_","decode","right","honors","takeRight","rankFromString","findIndex","r2","string","Eq","equals","option","chain","lookup","eqCard","struct","suit","rank","ordCardDescending","getMonoid","concat","c","cards","RNEA","makeBy","Math","floor","getOrdGroupedHand","zeroGroupedHand","S","H","D","C","groupHandBySuits","hand","readonlySet","toReadonlyArray","fromReadonlyArray","fold","groupBy","readonlyRecord","map","union","getUnionMonoid","newDeck","shuffle","browserCrypto","directions","eqDirection","eqHand","RS","getEq","eqDeal","strains","eqStrain","ordStrain","minors","boneChart","dealer","deal","boardNumber","nonContractBids","eqNonContractBid","isNonContractBid","b","RA","elem","eqContractBid","level","strain","ordContractBid","contractBids","apply","sequenceS","Apply","sort","isContractBid","eqBid","fromEquals","y","getHcp","modifier","foldMap","MonoidSum","card","max","zeroShape","sortShape","s","makeShape","counts","eqShape","zeroSpecificShape","groupHandBySuit","empty","getHandSpecificShape","length","semigroup","first","getHandShape","RT","snd","suitCounts","getOrElse","getPathUpTo","eqA","item","findFirstMap","T","a","paths","O","some","prepend","flatten","forest","reduce","items","append","getAllLeafPaths","node","getSemigroup","filterMap","extendWithSiblingsInternal","siblings","make","value","difference","toArray","extendWithSiblingsForest","getBidInfo","bid","withImplicitPasses","bs","exists","constraint","type","constConstraintTrue","constant","constConstraintFalse","contextualConstraintTypes","isContextualConstraint","separate","E","left","anyP","P","getMonoidAny","allP","getMonoidAll","constraintFalse","constFalse","constTrue","forall","isPointRange","range","between","min","isSuitRange","getSuitsToCheck","shape","suitCompare","op","lt","leq","geq","gt","getComparator","toRankSet","isShape","handShape","isBalanced","isSemiBalanced","zeroContext","path","force","none","primarySuit","secondarySuit","peers","contextL","Lens","fromProp","bidL","pathL","forceL","primarySuitL","secondarySuitL","peersL","contextO","lens","composeTraversal","fromTraversable","Traversable","Optional","fromOptionProp","forceO","quantifierT","quantifier","satisfies","traverseArray","existsT","identity","forallT","satisfiesBasic","suitHonors","cardSet","intersection","honorSet","isSubset","suitTop","filter","compare","minRank","count","or","not","record","ofS","of","satisfiesContextual","recur","constraints","gets","context","get","takeLeftWhile","cb","modify","set","findFirst","otherBid","splitAt","readonlyTuple","bimap","tail","higher","lower","optionT","Functor","Do","apS","otherSuit","getOrElseW","satisfiesS","ap","evaluate","alternate","opener","responder","unfold","g","val","next","done","Gen","ASTKinds","preTraversal","info","postTraversal","satisfiesPath","zip","bindTo","bind","relay","boolean","MonoidAll","ordBid","fromCompare","ordConstrainedBid","bidPathSorted","traverse","Applicative","constVoid","bidTreeSorted","validateS","sequence","fromPredicate","fromOption","e","mapLeft","resetForce","continueForce","updateForce","isGameLevel","isSlamLevel","updateForceS","getOption","result","checkPassS","isSome","checkPass","checkFinal","isNone","pathIsSound","forceCheck","finalCheck","serializedHandL","iso","decodedSerializedHandL","either","reverseGet","getUuidQuads","UuidTool","isUuid","Uuid","uuid","id","toBytes","takeLeft","byte","DealUuidB","replicate","directionIndex","every","dealUuidToDeal","encode","readonlyNonEmptyArray","fst","encodeDealAsUuid","foldMapWithIndex","trivial","direction","p","chunksOf","serializedDealL","serializedBoardL","serializedContractBidL","parseInt","charAt","serializedBidL","SerializedBidPathB","split","serializedBidPathL","intersperse","Monoid","Digit","literal","kind","Number","Parser","input","pos","negating","memoSafe","$scope$Constraint$memo","Map","overallPos","line","offset","clear","$$dpth","$$cr","run","$scope$spec","$$res","matchBidSpec","match$EOF","Start","spec","$scope$bid","$scope$constraints","matchBid","matchBidSpecConstraintList","BidSpec","regexAccept","String","raw","matchConstraintList","BidSpecConstraintList","choice","matchBid_1","matchBid_2","matchContractBid","matchNonContractBid","$scope$level","$scope$specifier","matchDigit","matchBidSpecifier","ContractBid","specifier","matchBidSpecifier_1","matchBidSpecifier_2","matchWildcard","matchSuitSpecifier","$scope$v","Wildcard","v","matchSuitSpecifier_1","matchSuitSpecifier_2","matchSuitSpecifier_3","matchMajor","matchMinor","matchStrain","Major","Minor","matchPass","Pass","matchStrain_1","matchStrain_2","matchSuit","matchNotrump","matchSuit_1","matchSuit_2","matchSuit_3","matchSuit_4","matchClub","matchDiamond","matchHeart","matchSpade","Club","Diamond","Heart","Spade","Notrump","Honor","loop","matchConstraintListItem","$scope$constraint","matchConstraint","ConstraintListItem","$scope$pos","mark","memo","undefined","reset","$scope$oldMemoSafe","lastRes","lastPos","res","matchConstraint_1","matchConstraint_2","matchConstraint_3","matchConstraint_4","matchConstraint_5","matchConstraint_6","matchConstraint_7","matchConstraint_8","matchConstraint_9","matchConstraint_10","matchConstraint_11","matchConstraint_12","matchConstraint_13","matchConstraint_14","matchConstraint_15","matchConstraint_16","end","matchConst","matchOr","matchAnd","matchNot","matchOtherwise","matchDistribution","matchResponse","matchSuitRange","matchSuitBound","matchSuitComparison","matchSuitHonors","matchSuitTop","matchSuitRank","matchPointRange","matchPointBound","matchOtherBid","matchConst_1","matchConst_2","matchTrue","matchFalse","True","False","$scope$left","$scope$right","Or","And","matchNot_$0","Not","matchNot_$0_1","matchNot_$0_2","Otherwise","$scope$lower","$scope$upper","matchNumber","PointRange","upper","$scope$value","$scope$qualifier","matchBoundQualifier","PointBound","qualifier","$scope$suit","matchSuitRangeSpecifier","SuitRange","SuitBound","$scope$op","matchSuitComparisonOperator","SuitComparison","matchSuitComparisonOperator_1","matchSuitComparisonOperator_2","matchSuitComparisonOperator_3","matchSuitComparisonOperator_4","matchSuitComparisonOperator_5","SuitComparisonOperator_1","SuitComparisonOperator_2","SuitComparisonOperator_3","SuitComparisonOperator_4","SuitComparisonOperator_5","$scope$honors","matchHonor","SuitHonors","$scope$x","$scope$y","SuitTop","matchBoundQualifier_1","matchBoundQualifier_2","matchBoundQualifier_3","matchPlus","matchMinus","matchEquals","Plus","Minus","Equals","$scope$strain","OtherBid","matchDistribution_1","matchDistribution_2","matchDistribution_3","matchDistribution_4","matchDistribution_5","matchBalanced","matchSemiBalanced","matchUnbalanced","matchAnyShape","matchSpecificShape","Balanced","SemiBalanced","Unbalanced","AnyShape","$scope$S","$scope$H","$scope$D","$scope$C","SpecificShape","matchSuitRank_1","matchSuitRank_2","matchPrimary","matchSecondary","Primary","Secondary","matchResponse_1","matchResponse_2","matchResponse_3","matchResponse_4","matchForceOneRound","matchForceGame","matchForceSlam","matchRelay","ForceOneRound","ForceGame","ForceSlam","Relay","$scope$literal","mrk","ans","matchStart","ast","errs","rec","ErrorTracker","clearMemos","err","getErr","func","star","push","fn","fns","dpth","cr","reg","RegExp","lastIndex","tryConsume","substring","negated","exec","lineJmp","lind","oneg","rule","$scope$memoRes","$scope$result","et","finished","$EOF","SyntaxErr","expmatches","mxpos","regexset","Set","pmatches","att","has","add","getConnectiveItems","constraintFromAST","connectiveFromAST","zero","eitherT","suitFromAST","AST","strainFromAST","suitSpecifierFromAST","bindValueFromASTQualifier","head","slice","fromArray","h","bidFromAST","parseBid","parse","Card","$scope$hand","matchHand","Hand","$scope$cards","matchCard","Suit","$scope$c","handFromAST","parseHand","handE","cur","convertErrors","d","FS","actual","DE","parseResultToEither","fromNullable","getDecoder","parser","decodeBid","bidSpec","constrainedBidFromAST","decodeHand","maxProcessors","navigator","hardwareConcurrency","parallelize","from","observeDealsSerial","batchSize","w","DealWorker","genDeals","observable","fromTask","repeat","observeBatchedDealsInfinite","ceil","log","take","observeResultsSerial","boards","DDSWorker","board","getResult","observeResultsParallel","concurrency","perWorker","remainder","initialState","selectedBlockKey","setHands","state","hands","castDraft","createAsyncThunk","l","N","W","genBoardFromHands","toTask","genUntilCondition","limit","condition","tailRec","deck","genMatchingOf","partition","separated","createSlice","name","reducers","setSelectedBlockKey","action","payload","setHand","reducer","meta","prepare","genOnce","getHandsMatchingPath","genHandsNotMatchingAnyOf","predicate","openerMinHcp","genHandsMatchingExactlyOneOf","genHandsMatchingMoreThanOneOf","extraReducers","builder","addCase","fulfilled","actions","selectBlockKey","memoize","toNullable","selectHand","fromEither","eqBlockKey","constrainedBidAdapter","createEntityAdapter","system","constrainedBids","getInitialState","setSystem","root","tree","parents","forEach","curr","depth","key","buildForest","removeConstraintsByBlockKey","removeMany","cacheSystemConstraints","setMany","text","constrainedBidSelectors","getSelectors","selectPathUpToKey","getCachedBidByKey","fromNullableK","selectById","selectBidByKey","selectBidPathUpToKey","selectRules","selectErrors","lefts","getCompleteForest","selectCompleteBidPathUpToKey","keys","unfoldTree","n0","ns","selectCompleteBidSubtree","options","implicitPass","selectAllCompleteBidPaths","selectSystemValid","treeIsSound","getDescriptorFromContentBlock","getKey","getText","getDepth","eqContentBlock","monoid","concatAll","getBlocks","editorState","getCurrentContent","getBlocksAsArray","Editor","useState","EditorState","createEmpty","setEditorState","blocks","setBlocks","dispatch","selection","onChange","useCallback","setTimeout","localStorage","setItem","convertToRaw","newBlocks","same","removed","added","isEmpty","newSelectedBlockKey","getSelection","getFocusKey","useEffect","savedEditorState","getItem","createWithContent","convertFromRaw","RichUtils","toggleBlockType","keyBindingFn","keyCode","newEditorState","onTab","getDefaultKeyBinding","contractPointMultiplier","contractModMultiplier","subtractBookTricks","tricks","making","contract","oddTricks","getOddTricks","whenMaking","contractPoints","vulnerableMultiplier","isVulnerable","getModified","doubledPenalties","partScorePoints","score","scoreComponents","overtrickPoints","overtricks","multiplier","slamPoints","modifierPoints","penaltyPoints","swap","undertricks","gamePoints","ScoreC","flattenNestedCounts","flap","traverseWithIndex","writer","getApplicative","tell","cs","pass","table","RR","inner","outer","outerKey","innerKey","transpose","initialBids","baseUrl","process","safeFetch","taskEither","tryCatchK","toError","ping","fetch","chainTaskK","response","filterOrElse","getRequestBody","toString","hcp","toUndefined","getRequestBodyWithoutSolution","postDeals","deals","task","body","method","putDeals","getProgress","updateProgress","M","decrement","progress","current","results","working","generate","mapSnd","getResults","reportDeals","reportResults","getUnionSemigroup","selectAllDeals","selectProgress","selectResultsByPath","generateCount","setInitial","Object","setProperty","setSettingsProperty","setInitialSettings","generator","settings","rootEpic","combineEpics","action$","state$","observeDealsParallel","bufferCount","concatWith","vulnerability","observableEither","fromObservable","chainFirst","fromTaskEither","EMPTY","selectHandsSatisfySelectedPath","o","selectPathsSatisfyHands","ordStats","selectSatisfyStats","ra","SelectionDetails","selected","join","data","SettingsItem","label","prop","onChanged","children","newValue","target","style","width","Settings","stored","newSettings","checked","SerializedKeyL","columns","sequenceT","getStats","ddt","fromFoldable","Foldable","aq","aggregate","rollup","object","mapFst","average","mean","stdev","SuitSpan","styled","span","ContractBidView","className","NonContractBidView","BidPath","RankList","ol","RankListItem","li","RankView","SuitList","SuitListItem","SuitView","HandView","groupedHand","StrainSpan","DoubleDummyTableView","fontWeight","verticalAlign","round","DoubleDummyResultView","StatsPath","dds","stats","averages","stdevs","onClick","SatisfyStats","Progress","Stats","generating","rules","errors","valid","showGenerate","isRight","isLeft","draw","Option","onSuccess","onNone","GenerateOnce","GenerateMatchZero","bidPaths","minHcp","setMinHcp","GenerateMatchOne","GenerateMatchMany","GenerateMatchSelected","bidPath","SelectionGenerators","HandInput","setValue","storageKey","encodedHand","onSetHand","savedHand","placeholder","onBlur","HandCol","th","HandEditor","getResultCallback","TestHands","foldW","App","display","float","rel","href","epicMiddleware","createEpicMiddleware","store","configureStore","middleware","getDefaultMiddleware","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.66ed5eeb.chunk.js","sourcesContent":["var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/runner/work/bridge/bridge/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/runner/work/bridge/bridge/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/runner/work/bridge/bridge/src/workers/dds.worker.ts\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/runner/work/bridge/bridge/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/runner/work/bridge/bridge/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/runner/work/bridge/bridge/src/workers/deal.worker.ts\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"a38611fc77beb72bce00.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"044157630f2fba7c9ee6.worker.js\");\n};","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from './store';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import { number, ord, readonlyNonEmptyArray } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\n\nexport const assertUnreachable = (x: never) => {\n  throw new Error (`shouldn't get here with ${JSON.stringify(x)}`)\n}\n\nexport const debug = <T>(x: T) => { debugger; return x }\n\nexport const ordAscending = <T>(array: readonlyNonEmptyArray.ReadonlyNonEmptyArray<T>) =>\n  pipe(number.Ord, ord.contramap<number, T>(x => array.indexOf(x)))\n\nexport const ordDescending = flow(ordAscending, ord.reverse)\n\n","import { either, eq, number, option, ord, readonlyArray, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet, string } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport * as t from 'io-ts';\nimport { browserCrypto, shuffle } from 'random-js';\nimport { ordAscending, ordDescending } from '../lib';\n\n\nexport const suits = ['C', 'D', 'H', 'S'] as const\nexport type Suit = typeof suits[number]\nexport const eqSuit : eq.Eq<Suit> = eq.eqStrict\nexport const ordSuitDescending : ord.Ord<Suit> = ordDescending(suits)\nexport const ordSuitAscending : ord.Ord<Suit> = ordAscending(suits)\n\nexport const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A'] as const\nexport type RankString = typeof rankStrings[number]\nconst RankB = t.brand(t.number, (i) : i is t.Branded<number, { readonly Rank: unique symbol }> => i >= 2 && i <= 14, 'Rank')\nexport const RankC = new t.Type('Rank', RankB.is, RankB.validate, r => rankStrings[r - 2])\nexport type Rank = t.TypeOf<typeof RankC>\nexport const eqRank : eq.Eq<Rank> = eq.eqStrict\nexport const ordRankAscending : ord.Ord<Rank> = number.Ord\nexport const ordRankDescending : ord.Ord<Rank> = pipe(ordRankAscending, ord.reverse)\nexport const ranks =\n  pipe(rankStrings,\n    readonlyArray.mapWithIndex((idx, _) =>\n      pipe(idx + 2,\n        RankC.decode,\n        x => (x as either.Right<Rank>).right)))\nexport const honors =\n  pipe(ranks, readonlyArray.takeRight(5))\nexport const rankFromString = (r: string) =>\n  pipe(rankStrings,\n    readonlyArray.findIndex(r2 => { return string.Eq.equals(r, r2) }),\n    option.chain(idx =>\n      pipe(ranks, readonlyArray.lookup(idx))))\n\nexport interface Card {\n  suit: Suit\n  rank: Rank\n}\nexport const cardToString = (c: Card) =>\n  `${c.suit}${RankC.encode(c.rank)}`\nexport const eqCard : eq.Eq<Card> = eq.struct({\n  suit: eqSuit,\n  rank: eqRank\n})\nexport const ordCardDescending : ord.Ord<Card> = ord.getMonoid<Card>().concat(\n  pipe(ordSuitDescending, ord.contramap(c => c.suit)),\n  pipe(ordRankDescending, ord.contramap(c => c.rank))\n)\n\nexport const cards: RNEA.ReadonlyNonEmptyArray<Card> =\n  pipe(52, RNEA.makeBy(i => ({\n    suit: suits[Math.floor(i / 13)],\n    rank: (RankC.decode((i % 13) + 2) as either.Right<Rank>).right\n  })))\n\nexport type Hand = ReadonlySet<Card>\nexport type GroupedHand = readonlyRecord.ReadonlyRecord<Suit, ReadonlyArray<Rank>>\nexport const getOrdGroupedHand = <T>() =>\n  ord.contramap(([suit, _]: readonly [Suit, T]) => suit)(ordSuitDescending)\nexport const zeroGroupedHand : GroupedHand = ({\n  S: [],\n  H: [],\n  D: [],\n  C: [],\n})\n\nexport const groupHandBySuits = (hand: Hand) : GroupedHand =>\n  pipe(hand,\n    readonlySet.toReadonlyArray(ordCardDescending),\n    RNEA.fromReadonlyArray,\n    option.fold(() => zeroGroupedHand, flow(\n      RNEA.groupBy(c => c.suit),\n      readonlyRecord.map(RNEA.map(c => c.rank)),\n      readonlyRecord.union(readonlyArray.getUnionMonoid(eqRank))(zeroGroupedHand)\n    )))\n\nexport type Deck = RNEA.ReadonlyNonEmptyArray<Card>\n\nexport const newDeck = () : Deck =>\n  shuffle(browserCrypto, [...cards]) as unknown as Deck\n","import { apply, eq, number, option, ord, readonlyArray as RA, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet as RS, readonlyTuple as RT, refinement, semigroup, string } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\n\nimport { ordAscending } from '../lib';\nimport { Card, Deck, eqCard, Hand, ordCardDescending, Suit, suits } from './deck';\n\nexport const directions = ['N', 'E', 'S', 'W'] as const\nexport type Direction = typeof directions[number]\nexport const eqDirection : eq.Eq<Direction> = string.Eq\nexport const ordDirection = ordAscending(directions)\n\nexport const partnerships = [\"NorthSouth\", \"EastWest\"] as const\nexport type Partnership = typeof partnerships[number]\nexport const eqPartnership : eq.Eq<Partnership> = string.Eq\nexport const ordPartnership = ordAscending(partnerships)\n\nexport const getPartnershipByDirection = (d: Direction): Partnership =>\n  (d === 'N' || d === 'S') ? \"NorthSouth\" : \"EastWest\"\n\nexport type Deal = readonlyRecord.ReadonlyRecord<Direction, Hand>\nexport type Player = {\n  direction: Direction\n  hand: Hand\n}\nexport const eqHand : eq.Eq<Hand> = RS.getEq(eqCard)\n\nexport const deal = (deck: Deck) : Deal =>\n  pipe(directions,\n    RNEA.zip(RNEA.chunksOf(13)(deck)),\n    RNEA.groupBy(RT.fst),\n    readonlyRecord.map(flow(RNEA.head, RT.snd, RS.fromReadonlyArray(eqCard))),\n    (x: readonlyRecord.ReadonlyRecord<Direction, Hand>) => x)\nexport const eqDeal : eq.Eq<Deal> =\n  readonlyRecord.getEq<Direction, Hand>(eqHand)\n\nexport const vulnerabilities = [\"Neither\", \"NorthSouth\", \"EastWest\", \"Both\"] as const\nexport type Vulnerability = typeof vulnerabilities[number]\n\nexport const getIsVulnerable = (dir: Direction, vul: Vulnerability) =>  \n  !(vul === \"Neither\") && ((vul === \"Both\") || getPartnershipByDirection(dir) === vul)\n\nexport const strains = [...suits, 'N'] as const\nexport type Strain = typeof strains[number]\nexport const eqStrain : eq.Eq<Strain> = eq.eqStrict\nexport const ordStrain : ord.Ord<Strain> = ordAscending(strains)\n\nexport const minors: ReadonlyArray<Strain> = ['C', 'D']\nexport const majors: ReadonlyArray<Strain> = ['H', 'S']\n\nexport interface Board {\n  dealer: Direction\n  deal: Deal\n}\nexport const eqBoard : eq.Eq<Board> = eq.struct({\n  dealer: eqDirection,\n  deal: eqDeal\n})\n\nexport interface BoardWithDetail extends Board {\n  number: number\n  vulnerability: Vulnerability\n}\n\nconst boneChart = (boardNumber: number) : Vulnerability => {\n  switch ((boardNumber % 16) + 1) {\n    case 1: case 8: case 11: case 14: return \"Neither\"\n    case 2: case 5: case 12: case 15: return \"NorthSouth\"\n    case 3: case 6: case 9:  case 16: return \"EastWest\"\n    case 4: case 7: case 10: case 13: return \"Both\"\n    default: throw Error(\"Not possible\")\n  }\n}\n\nexport const makeBoard = (number: number) => (deal: Deal) : BoardWithDetail => ({\n  number,\n  dealer: directions[(number - 1) % directions.length],\n  deal,\n  vulnerability: boneChart(number)\n})\n\nexport const nonContractBids = [\"Pass\", \"Double\", \"Redouble\"] as const\nexport type NonContractBid = typeof nonContractBids[number]\nexport const eqNonContractBid : eq.Eq<NonContractBid> = string.Eq\nexport const isNonContractBid = (b: unknown) : b is NonContractBid =>\n  typeof b === \"string\" && pipe(nonContractBids, RA.elem<string>(string.Eq)(b))\n\nexport interface ContractBid {\n  level: number\n  strain: Strain\n}\nexport const eqContractBid : eq.Eq<ContractBid> = eq.struct({\n  level: number.Eq,\n  strain: string.Eq\n})\nexport const ordContractBid : ord.Ord<ContractBid> =\n  ord.getMonoid<ContractBid>().concat(\n    pipe(number.Ord, ord.contramap(c => c.level)),\n    pipe(ordStrain, ord.contramap(c => c.strain))\n  )\nexport const contractBids : ReadonlyArray<ContractBid> =\n  pipe(\n    apply.sequenceS(RA.Apply)(({\n      level: RA.makeBy(7, level => level + 1),\n      strain: strains\n    })),\n    RA.sort(ordContractBid))\n\nexport type Bid = NonContractBid | ContractBid\nexport const isContractBid = (b: Bid): b is ContractBid => !isNonContractBid(b)\n\nexport const eqBid : eq.Eq<Bid> = eq.fromEquals((x, y) =>\n  (isNonContractBid(x) && isNonContractBid(y) && eqNonContractBid.equals(x, y)) ||\n  (!isNonContractBid(x) && !isNonContractBid(y) && eqContractBid.equals(x, y)))\n\nexport const isGameLevel = (bid: Bid) =>\n  isContractBid(bid) && ord.geq(ordContractBid)(bid, { level: 3, strain: \"N\" })\nexport const isSlamLevel = (bid: Bid) =>\n  isContractBid(bid) && ord.gt(ordContractBid)(bid, { level: 5, strain: \"N\" })\n\nexport const contractModifiers = [\"Undoubled\", \"Doubled\", \"Redoubled\"] as const\nexport type ContractModifier = typeof contractModifiers[number]\nexport interface Contract extends ContractBid {\n  modifier: ContractModifier\n}\nexport const eqContract : eq.Eq<Contract> = eq.struct({\n  level: number.Eq,\n  strain: string.Eq,\n  modifier: string.Eq\n})\nexport const fromBid = (bid: ContractBid): Contract =>\n  ({ ...bid, modifier: \"Undoubled\" })\n\nexport type Auction = RNEA.ReadonlyNonEmptyArray<Bid>\nconst consecutivePasses = [\"Pass\", \"Pass\", \"Pass\"] as const\nexport type NonPassAuction = Auction & [...Auction, ...typeof consecutivePasses]\nconst passout = [\"Pass\", \"Pass\", \"Pass\", \"Pass\"] as const\nexport type PassAuction = typeof passout\nexport type CompletedAuction = NonPassAuction | PassAuction\nexport const eqAuction : eq.Eq<Auction> = RNEA.getEq(eqBid)\nexport const isCompletedAuction : refinement.Refinement<Auction, CompletedAuction> = (a): a is CompletedAuction =>\n  a.length >= 4 &&\n  (eqAuction.equals(a, passout) || eqAuction.equals(a.slice(a.length - 3) as unknown as Auction, consecutivePasses))\n\nexport interface BoardWithAuction extends Board {\n  auction: Auction \n}\nexport interface BoardWithCompletedAuction extends BoardWithAuction {\n  auction: CompletedAuction\n}\n\nexport const getCardHcp = (card: Card) =>\n  Math.max(0, card.rank - 10)\n\nexport const getHcp =\n  flow(\n    RS.toReadonlyArray(ordCardDescending),\n    RA.foldMap(number.MonoidSum)(getCardHcp))\n\nexport type Shape = readonly [number, number, number, number]\nexport const zeroShape: Shape = [0, 0, 0, 0]\nexport const sortShape = (s: Shape) => pipe(s, RA.sort(ord.reverse(number.Ord))) as Shape\nexport const makeShape = (...counts: Shape) =>\n  pipe(counts, sortShape)\nexport const eqShape : eq.Eq<Shape> =\n  eq.contramap(sortShape)(RA.getEq(number.Eq))\n\nexport type SpecificShape = Record<Suit, number>\nexport const makeSpecificShape = (s: number, h: number, d: number, c: number) : SpecificShape => ({\n  S: s,\n  H: h,\n  D: d,\n  C: c\n})\nexport const zeroSpecificShape = makeSpecificShape(0, 0, 0, 0)\n\nexport const groupHandBySuit = (hand: Hand) =>\n  pipe(hand,\n    RS.toReadonlyArray(ordCardDescending),\n    RNEA.fromReadonlyArray,\n    option.fold(() => readonlyRecord.empty, flow(\n      RNEA.groupBy(c => c.suit),\n      readonlyRecord.mapWithIndex((s: Suit, cards: RNEA.ReadonlyNonEmptyArray<Card>) => cards))))\n\nexport const getHandSpecificShape = (hand: Hand) : SpecificShape =>\n  pipe(hand,\n    groupHandBySuit,\n    readonlyRecord.map(x => x.length),\n    readonlyRecord.union(semigroup.first<number>())(zeroSpecificShape),\n    (suits: readonlyRecord.ReadonlyRecord<Suit, number>) => suits)\n\nexport const getHandShape = (hand: Hand) : Shape =>\n  pipe(hand,\n    getHandSpecificShape,\n    readonlyRecord.toReadonlyArray,\n    RA.map(RT.snd),\n    suitCounts => RA.mapWithIndex((idx, _) =>\n      pipe(suitCounts, RA.lookup(idx), option.getOrElse(() => 0)))(zeroShape)) as Shape\n","import { eq, option as O, readonlyArray as RA, readonlyNonEmptyArray as RNEA, tree as T } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\n\nimport { ConstrainedBid, Constraint } from '../model/constraints';\nimport { Bid, eqBid } from './bridge';\n\nexport type Path<A> = RNEA.ReadonlyNonEmptyArray<A>\nexport type Paths<A> = RNEA.ReadonlyNonEmptyArray<Path<A>>\nexport type Forest<A> = ReadonlyArray<T.Tree<A>>\n\nexport const getPathUpTo = <A>(eqA: eq.Eq<A>) => (item: A) =>\n  RA.findFirstMap(\n    T.fold((a: A, paths: ReadonlyArray<O.Option<RNEA.ReadonlyNonEmptyArray<A>>>) : O.Option<RNEA.ReadonlyNonEmptyArray<A>> =>\n      eqA.equals(a, item)\n      ? O.some([item])\n      : pipe(paths,\n          RA.findFirstMap(O.map(RA.prepend(a))))))\n\nexport const flatten = <A>(forest: Forest<A>) =>\n  pipe(forest,\n    RA.chain(\n      T.reduce<A, ReadonlyArray<A>>([], (items, a) =>\n        pipe(items, RA.append(a)))))\n\nexport const pathTree = <A>(forest: Forest<A>) : Forest<Path<A>> =>\n  pipe(forest,\n    RA.map(flow(\n      T.map(RNEA.of),\n      T.fold((a, forest: ReadonlyArray<T.Tree<Path<A>>>) =>\n        T.make(a, pipe(forest,\n          RA.map(T.map(path => RNEA.concat(path)(a))), RA.toArray))),\n      T.map(x => RNEA.tail(x) as RNEA.ReadonlyNonEmptyArray<A>))))\n\nexport const getAllLeafPaths = <A>(forest: Forest<A>): ReadonlyArray<Path<A>> =>\n  pipe(forest,\n    RA.chain(\n      T.fold((node: A, paths: ReadonlyArray<Paths<A>>): Paths<A> =>\n        pipe(paths,\n          RNEA.fromReadonlyArray,\n          O.fold(() => [[node]],\n            RNEA.foldMap(RNEA.getSemigroup<Path<A>>())(RNEA.map(RA.prepend(node))))))),\n    RA.filterMap(RNEA.fromReadonlyArray))\n\nconst extendWithSiblingsInternal = <T>(eq: eq.Eq<T>) => (siblings: ReadonlyArray<T>) => (t: T.Tree<T>) : T.Tree<T & { siblings: ReadonlyArray<T> }> =>\n  T.make(\n    ({ ...t.value, siblings }),\n    pipe(t.forest, RA.map(\n      pipe(t.forest,\n        RA.map(t => t.value),\n        RA.difference(eq)([t.value]), // end null hack\n        extendWithSiblingsInternal(eq))),\n      RA.toArray))\n\nconst extendWithSiblingsForest = <A>(eq: eq.Eq<A>) => (forest: Forest<A>) =>\n  pipe(forest, RA.map(t =>\n    pipe(forest,\n      RA.map(t => t.value),\n      RA.difference(eq)([t.value]),\n      extendWithSiblingsInternal(eq),\n      x => x(t))))\n\nexport interface BidInfo {\n  bid: Bid\n  siblings: ReadonlyArray<ConstrainedBid>\n  constraint: Constraint\n}\nexport type BidPath = Path<BidInfo>\nexport type BidPaths = Paths<BidInfo>\nexport type BidTree = Forest<BidInfo>\n\nexport const getBidInfo : (f: Forest<ConstrainedBid>) => Forest<BidInfo> =\n  x => { debugger; return extendWithSiblingsForest(eq.contramap<Bid, ConstrainedBid>(c => c.bid)(eqBid))(x) }\n\nexport const withImplicitPasses =\n  RA.map(\n    T.fold((a: ConstrainedBid, bs: T.Forest<ConstrainedBid>) =>\n      bs.length === 0 || pipe(bs, RA.exists(t => t.value.bid === \"Pass\"))\n      ? T.make(a, bs)\n      : T.make(a, pipe(bs,\n        RA.append(T.make<ConstrainedBid>({ bid: \"Pass\", constraint: { type: \"Otherwise\" }})),\n        RA.toArray))))","import { applicative, apply, boolean, either as E, eitherT, eq, hkt, identity as id, number, option as O, optionT, ord, predicate as P, readonlyArray as RA, readonlyNonEmptyArray as RNEA, readonlyRecord, readonlySet, readonlyTuple, record, state as S, stateT, string, these } from 'fp-ts';\nimport { eqStrict } from 'fp-ts/lib/Eq';\nimport { constant, constFalse, constTrue, constVoid, flow, identity, pipe } from 'fp-ts/lib/function';\nimport { fromTraversable, Lens, lens, Optional } from 'monocle-ts';\n\nimport { assertUnreachable, debug } from '../lib';\nimport { Bid, ContractBid, eqBid, eqShape, getHandShape, getHandSpecificShape, getHcp, groupHandBySuit, isContractBid, isGameLevel, isSlamLevel, makeShape, ordContractBid, Shape as AnyShape, SpecificShape } from './bridge';\nimport { eqRank, eqSuit, Hand, honors, ordRankAscending, Rank, Suit, suits } from './deck';\nimport { BidInfo, BidPath, BidTree, getAllLeafPaths } from './system';\n\nexport interface ConstraintPointRange {\n  type: \"PointRange\"\n  min: number\n  max: number\n}\n\nexport type SuitRangeSpecifier = \"Major\" | \"Minor\" | Suit // | \"OtherMajor\" | \"OtherMinor\"\nexport interface ConstraintSuitRange {\n  type: \"SuitRange\"\n  suit: SuitRangeSpecifier\n  min: number\n  max: number\n}\n\nexport type SuitComparisonOperator = \"<\" | \"<=\" | \"=\" | \">=\" | \">\"\nexport interface ConstraintSuitComparison {\n  type: \"SuitComparison\",\n  left: Suit,\n  right: Suit,\n  op: SuitComparisonOperator\n}\n\nexport interface ConstraintSuitHonors {\n  type: \"SuitHonors\",\n  suit: Suit,\n  honors: ReadonlyArray<Rank>\n}\n\nexport interface ConstraintSuitTop {\n  type: \"SuitTop\",\n  suit: Suit,\n  count: number,\n  minRank: Rank\n}\n\nexport interface ConstraintSuitPrimary {\n  type: \"SuitPrimary\",\n  suit: Suit\n}\nexport interface ConstraintSuitSecondary {\n  type: \"SuitSecondary\",\n  suit: Suit\n}\nexport type ConstraintSuitRank = ConstraintSuitPrimary | ConstraintSuitSecondary\n\nexport interface ConstraintConst {\n  type: \"Constant\",\n  value: boolean\n}\nexport const constConstraintTrue  = constant<Constraint>({ type: \"Constant\", value: true })\nexport const constConstraintFalse = constant<Constraint>({ type: \"Constant\", value: false })\n\nexport interface ConstraintConjunction {\n  type: \"Conjunction\"\n  constraints: RNEA.ReadonlyNonEmptyArray<Constraint>\n}\nexport interface ConstraintDisjunction {\n  type: \"Disjunction\"\n  constraints: RNEA.ReadonlyNonEmptyArray<Constraint>\n}\nexport interface ConstraintNegation {\n  type: \"Negation\"\n  constraint: Constraint\n}\n\ninterface ConstraintAnyShape {\n  type: \"AnyShape\"\n  counts: AnyShape\n}\n\nexport interface ConstraintSpecificShape {\n  type: \"SpecificShape\",\n  suits: SpecificShape\n}\n\nexport interface ConstraintDistribution {\n  type: \"Balanced\" | \"SemiBalanced\" | \"Unbalanced\"\n}\n\nexport interface ConstraintResponse {\n  type: \"ForceOneRound\" | \"ForceGame\" | \"ForceSlam\"\n}\n\nexport interface ConstraintOtherwise {\n  type: \"Otherwise\"\n}\n\nexport interface ConstraintRelayResponse {\n  type: \"Relay\",\n  bid: ContractBid\n}\n\nexport interface ConstraintOtherBid {\n  type: \"OtherBid\",\n  bid: ContractBid\n}\n\nexport type ConstraintForce =\n    ConstraintResponse\n  | ConstraintRelayResponse\n\nexport type Constraint =\n  | ConstraintConst\n  | ConstraintConjunction\n  | ConstraintDisjunction\n  | ConstraintNegation\n  | ConstraintOtherwise\n  | ConstraintOtherBid\n  | ConstraintPointRange\n  | ConstraintSuitRange\n  | ConstraintSuitComparison\n  | ConstraintSuitRank\n  | ConstraintSuitHonors\n  | ConstraintSuitTop\n  | ConstraintDistribution\n  | ConstraintAnyShape\n  | ConstraintSpecificShape\n  | ConstraintForce\n\nconst contextualConstraintTypes = [\n  \"Conjunction\",\n  \"Disjunction\",\n  \"Negation\",\n  \"Otherwise\",\n  \"OtherBid\",\n  \"ForceOneRound\",\n  \"ForceGame\",\n  \"ForceSlam\",\n  \"Relay\",\n  \"SuitPrimary\",\n  \"SuitSecondary\",\n] as const\n\ntype ContextualConstraintType = typeof contextualConstraintTypes[number]\ntype BasicConstraint = Exclude<Constraint, { type: ContextualConstraintType }>\ntype ContextualConstraint = Extract<Constraint, { type: ContextualConstraintType }>\n\nconst isContextualConstraint = (c: Constraint) : c is ContextualConstraint =>\n  RA.elem(string.Eq as eq.Eq<Constraint[\"type\"]>)(c.type)(contextualConstraintTypes)\n\nconst separate = (c: Constraint) : E.Either<ContextualConstraint, BasicConstraint> =>\n  isContextualConstraint(c) ? E.left(c) : E.right(c as BasicConstraint)\n\nexport interface ConstrainedBid {\n  bid: Bid\n  constraint: Constraint\n}\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst anyP = P.getMonoidAny<Hand>()\nconst allP = P.getMonoidAll<Hand>()\nconst constraintFalse : P.Predicate<Hand> = constFalse\nconst constraintTrue : P.Predicate<Hand> = constTrue\nconst exists = pipe(anyP, RA.foldMap)\nconst forall = pipe(allP, RA.foldMap)\n/* eslint-enable @typescript-eslint/no-unused-vars */\n\nconst rangeCheck = (range: { min: number, max: number }) => ord.between(number.Ord)(range.min, range.max)\n\nexport const isPointRange =\n  flow(rangeCheck, P.contramap(getHcp))\n\nexport const isSpecificShape = (shape: SpecificShape) =>\n  flow(getHandSpecificShape, suits => record.getEq(eqStrict).equals(suits, shape))\n\nexport const isSuitRange = (range: ConstraintSuitRange) => {\n  const getSuitsToCheck: readonly Suit[] =\n    range.suit === \"Major\" ? [\"S\", \"H\"] :\n    range.suit === \"Minor\" ? [\"D\", \"C\"] :\n    [range.suit]\n  return flow(getHandSpecificShape, shape =>\n    pipe(getSuitsToCheck, RA.exists(s => ord.between(number.Ord)(range.min, range.max)(shape[s]))))\n}\n\nconst getComparator = (op: SuitComparisonOperator) => {\n  switch (op) {\n    case \"<\" : return ord.lt(number.Ord)\n    case \"<=\": return ord.leq(number.Ord)\n    case \"=\" : return number.Eq.equals\n    case \">=\": return ord.geq(number.Ord)\n    case \">\" : return ord.gt(number.Ord)\n    default  : return assertUnreachable(op)\n  }\n}\n\nexport const suitCompare = (op: SuitComparisonOperator) => (left: Suit, right: Suit) =>\n  flow(getHandSpecificShape,\n    shape => getComparator(op)(shape[left], shape[right]))\n\nexport const suitPrimary = (suit: Suit) =>\n  pipe(suits,\n    RA.splitAt(suits.indexOf(suit)),\n    readonlyTuple.bimap(\n      flow(RA.tail,\n        O.fold(() => [],\n          RA.map(higher => suitCompare(\"<\")(higher, suit)))),\n      RA.map(lower => suitCompare(\"<=\")(lower, suit))),\n    RA.flatten,\n    RA.prepend(isSuitRange({ type: \"SuitRange\", suit, min: 5, max: 13 })),\n    forall(identity))\n\nexport const suitSecondary = (secondarySuit: Suit) => (primarySuit: Suit) =>\n  pipe(RA.Do,\n    RA.apS('suit', [secondarySuit, primarySuit]),\n    RA.apS('otherSuit', pipe(suits, RA.difference(eqSuit)([secondarySuit, primarySuit]))),\n    RA.filter(({ suit, otherSuit }) => !eqSuit.equals(suit, otherSuit)),\n    RA.map(({ suit, otherSuit }) => suitCompare(\">\")(suit, otherSuit)),\n    RA.concat([\n      isSuitRange({ type: \"SuitRange\", suit: secondarySuit, min: 4, max: 13 }),\n      suitCompare(\">=\")(primarySuit, secondarySuit)\n    ]),\n    forall(identity))\n\nconst toRankSet = readonlySet.fromReadonlyArray(eqRank)\n\nconst suitHonors = (suitHonors: ConstraintSuitHonors) =>\n  flow(\n    groupHandBySuit,\n    readonlyRecord.lookup(suitHonors.suit),\n    O.fold(constFalse, cards => {\n      const cardSet = pipe(cards,\n        RA.map(c => c.rank),\n        toRankSet,\n        readonlySet.intersection(eqRank)(toRankSet(honors)))\n      const honorSet = pipe(suitHonors.honors, toRankSet)\n      return pipe(honorSet, readonlySet.isSubset(eqRank)(cardSet))\n    }))\n\nconst suitTop = (suitTop: ConstraintSuitTop) =>\n  flow(groupHandBySuit,\n    readonlyRecord.lookup(suitTop.suit),\n    O.fold(constFalse, flow(\n      RA.map(c => c.rank),\n      RA.filter(r => ordRankAscending.compare(r, suitTop.minRank) >= 0),\n      cards => cards.length >= suitTop.count)))\n\nexport const isShape = (shape: AnyShape) =>\n  flow(getHandShape, handShape =>\n    eqShape.equals(shape, handShape))\n\nexport const isBalanced =\n  pipe([\n    makeShape(4, 3, 3, 3),\n    makeShape(5, 3, 3, 2),\n    makeShape(4, 4, 3, 2),\n    makeShape(5, 5, 3, 2),\n  ], exists(isShape))\n\nexport const isSemiBalanced =\n  pipe([\n    makeShape(5, 4, 2, 2),\n    makeShape(6, 3, 2, 2)\n  ], exists(isShape))\n\nexport interface BidContext {\n  bid: Bid,\n  path: ReadonlyArray<Bid>\n  force: O.Option<ConstraintForce>\n  primarySuit: O.Option<Suit>\n  secondarySuit: O.Option<Suit>,\n  peers: ReadonlyArray<ConstrainedBid>,\n}\nexport const zeroContext : BidContext = {\n  bid: {} as Bid,\n  path: [],\n  force: O.none,\n  primarySuit: O.none,\n  secondarySuit: O.none,\n  peers: [],\n}\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nconst contextL = Lens.fromProp<BidContext>()\nconst bidL = contextL('bid')\nconst pathL = contextL('path')\nconst forceL = contextL('force')\nconst primarySuitL = contextL('primarySuit')\nconst secondarySuitL = contextL('secondarySuit')\nconst peersL = contextL('peers')\nconst peersT = pipe(peersL,\n  lens.composeTraversal(fromTraversable(RA.Traversable)<ConstrainedBid>()))\nconst contextO = Optional.fromOptionProp<BidContext>()\nconst forceO = contextO('force')\nconst primarySuitO = contextO('primarySuit')\nconst secondarySuitO = contextO('secondarySuit')\n/* eslint-enable @typescript-eslint/no-unused-vars */\n\ntype X = BidContext\ntype C = Constraint\ntype A = P.Predicate<Hand>\nexport type ConstraintPredicate = S.State<BidContext, P.Predicate<Hand>>\n\nconst quantifierT = (quantifier: (c: ReadonlyArray<A>) => A) => (satisfies: (c: S.State<X, C>) => S.State<X, A>) =>\n  flow(\n    S.traverseArray(satisfies),\n    S.map(quantifier))\nconst existsT = quantifierT(exists(identity))\nconst forallT = quantifierT(forall(identity))\n\ntype SatisfiesShape<R, C, A> = (recur: (c: R) => A) => (constraint: C) => A\ntype SatisfiesT1<F extends hkt.URIS , C extends Constraint> = SatisfiesShape<hkt.Kind  <F,    Constraint>, hkt.Kind <F,    C>, hkt.Kind <F,    A>>\ntype SatisfiesT2<F extends hkt.URIS2, C extends Constraint> = SatisfiesShape<hkt.Kind2 <F, X, Constraint>, hkt.Kind2<F, X, C>, hkt.Kind2<F, X, A>>\n\nconst satisfiesBasic : ReturnType<SatisfiesT1<id.URI, BasicConstraint>> = c => {\n  switch (c.type) {\n    case \"Constant\":\n      return constant(c.value)\n    case \"PointRange\":\n      return isPointRange(c)\n    case \"SuitRange\":\n      return isSuitRange(c)\n    case \"SuitComparison\":\n      return suitCompare(c.op)(c.left, c.right)\n    case \"SuitHonors\":\n      return suitHonors(c)\n    case \"SuitTop\":\n      return suitTop(c)\n    case \"Balanced\":\n      return isBalanced\n    case \"SemiBalanced\":\n      return P.or(isBalanced)(isSemiBalanced)\n    case \"Unbalanced\":\n      return P.not(P.or(isBalanced)(isSemiBalanced))\n    case \"AnyShape\":\n      return isShape(c.counts)\n    case \"SpecificShape\":\n      return isSpecificShape(c.suits)\n    default:\n      return assertUnreachable(c)\n  }\n}\n\nconst ofS = <T>(x: T) => S.of<BidContext, T>(x)\n\nconst satisfiesContextual : SatisfiesT2<S.URI, ContextualConstraint> = recur =>\n  S.chain(c => {\n    switch (c.type) {\n      case \"Conjunction\":\n        return pipe(c.constraints, RNEA.map(ofS), forallT(recur))\n      case \"Disjunction\":\n        return pipe(c.constraints, RNEA.map(ofS), existsT(recur))\n      case \"Negation\": \n        return pipe(c.constraint, ofS, recur, S.map(P.not))\n      case \"Otherwise\":\n        return pipe(\n          S.gets((context: BidContext) =>\n            pipe(context,\n              peersL.get,\n              // stops cycles, since bids can only check upwards\n              RA.takeLeftWhile(b => !eqBid.equals(b.bid, context.bid)))),\n          S.chain(flow(\n            RA.map(cb => pipe(\n              S.modify(bidL.set(cb.bid)),\n              S.map(() => cb.constraint))),\n            forallT(flow(recur, S.map(P.not))))))\n      case \"OtherBid\":\n        return pipe(\n          S.gets(flow(\n            peersL.get,\n            RA.findFirst(b => eqBid.equals(b.bid, c.bid)))),\n          S.chain(O.fold(\n            constant(ofS(constraintFalse)),\n            otherBid => pipe(\n              S.gets(bidL.get),\n              S.chain(bid =>\n                eqBid.equals(bid, otherBid.bid) // stops cycles\n                ? S.of(constFalse)\n                : recur(S.of(otherBid.constraint)))))))\n      case \"ForceOneRound\":\n      case \"ForceGame\":\n      case \"ForceSlam\":\n      case \"Relay\":\n        return pipe(\n          S.modify<BidContext>(forceL.set(O.some(c))),\n          S.map(constant(constTrue)))\n      case \"SuitPrimary\":\n        return pipe(\n          S.modify<BidContext>(primarySuitL.set(O.some(c.suit))),\n          S.map(constant(suitPrimary(c.suit))))\n      case \"SuitSecondary\":\n        return pipe(\n          S.modify<BidContext>(secondarySuitL.set(O.some(c.suit))),\n          S.chain(constant(S.gets(context => context.primarySuit))),\n          optionT.map(S.Functor)(suitSecondary(c.suit)),\n          S.map(O.getOrElseW(constant(constraintFalse))))\n      default:\n        return assertUnreachable(c)\n    }\n  })\n\nconst satisfiesS : ReturnType<SatisfiesT2<S.URI, Constraint>> = s =>\n  pipe(s,\n    S.map(separate),\n    S.chain(E.fold(\n      flow(S.of, satisfiesContextual(satisfiesS)),\n      right => pipe(S.of<X, typeof satisfiesBasic>(satisfiesBasic), S.ap(S.of(right))))))\n\nexport const satisfiesWithContext = (x: Constraint) =>\n  pipe(x, S.of, satisfiesS)\n  \nexport const satisfies =\n  flow(satisfiesWithContext, S.evaluate(zeroContext))\n\nmodule Gen {\n  export function* alternate(opener: Hand, responder: Hand) {\n    while (true) { yield opener; yield responder }\n  }\n\n  export const unfold = (length: number) => <T>(g: Generator<T>) : readonly T[] => {\n    const val = g.next()\n    return val.done || length === 0 ? [] : [val.value, ...unfold(length - 1)(g)]\n  }\n}\n\nconst specialRelayCase = (bid: Bid) => (s: S.State<BidContext, Constraint>) =>\n  pipe(s,\n    S.bindTo('constraint'),\n    S.bind('relay', ({ constraint }) =>\n      S.gets(flow(\n        forceL.get,\n        O.fold(constFalse, force =>\n          constraint.type === \"Constant\" && !constraint.value && force.type === \"Relay\" && eqBid.equals(force.bid, bid))))),\n    S.map(s => s.relay ? constConstraintTrue() : s.constraint))\n\nconst preTraversal = (info: BidInfo) =>\n  pipe(\n    S.modify(peersL.set(info.siblings)),\n    S.chain(() => S.modify(bidL.set(info.bid))),\n    S.map(() => info.constraint))\n\nconst postTraversal = <A>(info: BidInfo) =>\n    S.chain((s: A) => pipe(\n      S.modify(pathL.modify(RA.prepend(info.bid))),\n      S.map(() => s)))\n  \nexport const satisfiesPath = (opener: Hand, responder: Hand) => (path: BidPath) =>\n  pipe(\n    Gen.alternate(opener, responder),\n    Gen.unfold(path.length),\n    RA.zip(path),\n    S.traverseArray(([hand, info]) =>\n      pipe(\n        preTraversal(info),\n        flow(\n          specialRelayCase(info.bid),\n          satisfiesS),\n        S.ap(S.of(hand)),\n        postTraversal(info))),\n    S.map(RA.foldMap(boolean.MonoidAll)(identity)),\n    S.evaluate(zeroContext))\n\n// Only use for one-off checks, as it doesn't descend the entire bid tree\nexport const satisfiesPathWithoutSiblingCheck = (opener: Hand, responder: Hand) =>\n  flow(RNEA.map((x: ConstrainedBid) => ({ ...x, siblings: [] })), satisfiesPath(opener, responder))\n\nconst ordBid: ord.Ord<Bid> =\n  ord.fromCompare((a, b) =>\n    isContractBid(a) && !isContractBid(b) ? -1 :\n    isContractBid(b) && !isContractBid(a) ? 1 :\n    isContractBid(a) && isContractBid(b) ? ordContractBid.compare(a, b) :\n    0)\n\nconst ordConstrainedBid = ord.contramap<Bid, ConstrainedBid>(b => b.bid)(ordBid)\n\ninterface SystemValidationErrorBidsOutOfOrder {\n  type: \"BidsOutOfOrder\"\n  left: ConstrainedBid\n  right: ConstrainedBid\n}\ninterface SystemValidationErrorOtherBidNotFound {\n  type: \"OtherBidNotFound\"\n  constraint: Constraint\n}\ninterface SystemValidationErrorNoPrimaryBidDefined {\n  type: \"NoPrimaryBidDefined\"\n  constraint: Constraint\n}\ninterface SystemValidationErrorPassWhileForcing {\n  type: \"PassWhileForcing\",\n  bid: Bid\n}\ninterface SystemValidationErrorNoBidDefinedButStillForcing {\n  type: \"NoBidDefinedButStillForcing\",\n  path: ReadonlyArray<Bid>\n}\n\ntype SystemValidationBidReason =\n  | SystemValidationErrorOtherBidNotFound\n  | SystemValidationErrorNoPrimaryBidDefined\ntype SystemValidationBidError = SystemValidationBidReason & {\n  bid: Bid\n}\n\ntype SystemValidationError =\n  | SystemValidationBidError\n  | SystemValidationErrorBidsOutOfOrder\n  | SystemValidationErrorPassWhileForcing\n  | SystemValidationErrorNoBidDefinedButStillForcing\n\ntype SystemValidation = E.Either<SystemValidationError, void>\ntype ValidateResult = S.State<BidContext, SystemValidation>\n\nconst bidPathSorted = (path: BidPath): SystemValidation =>\n  pipe(path,\n    RA.zip(RNEA.tail(path)),\n    RA.traverse(E.Applicative)(([left, right]) =>\n      !ord.lt(ordConstrainedBid)(left, right)\n      ? E.left({ type: \"BidsOutOfOrder\" as const, left, right })\n      : E.right(constVoid())),\n    E.map(constVoid))\n\nconst bidTreeSorted = (path: BidTree) =>\n  pipe(path,\n    getAllLeafPaths,\n    RA.traverse(E.Applicative)(bidPathSorted),\n    E.map(constVoid))\n\nexport const validateS = (s: S.State<BidContext, Constraint>): S.State<BidContext, E.Either<SystemValidationBidError, void>> =>\n  pipe(s, S.chain(c => {\n    if (isContextualConstraint(c)) {\n      switch (c.type) {\n        case \"Conjunction\":\n        case \"Disjunction\":\n          return pipe(c.constraints,\n            RNEA.map(ofS),\n            S.traverseArray(validateS),\n            S.map(flow(\n              RA.sequence(E.Applicative),\n              E.map(constVoid))))\n        case \"Negation\": \n          return pipe(c.constraint, ofS, validateS)\n        case \"OtherBid\":\n          return pipe(\n            S.gets(flow(\n              peersL.get,\n              RA.map(cb => cb.bid),\n              debug,\n              E.fromPredicate(RA.elem(eqBid)(c.bid), constant<SystemValidationBidReason>({ type: \"OtherBidNotFound\", constraint: c })),\n              E.map(constVoid))))\n        case \"ForceOneRound\":\n        case \"ForceGame\":\n        case \"ForceSlam\":\n        case \"Relay\":\n          return pipe(\n            S.modify(forceL.set(O.some(c))),\n            S.map(constant(E.right(constVoid()))))\n        case \"SuitPrimary\":\n          return pipe(\n            S.modify(primarySuitL.set(O.some(c.suit))),\n            S.map(constant(E.right(constVoid()))))\n        case \"SuitSecondary\":\n          return pipe(\n            S.modify(secondarySuitL.set(O.some(c.suit))),\n            S.chain(constant(S.gets(context => context.primarySuit))),\n            S.map(flow(\n              E.fromOption(constant<SystemValidationBidReason>({ type: \"NoPrimaryBidDefined\", constraint: c })),\n              E.map(constVoid))))\n        case \"Otherwise\":\n          return S.of(E.right(constVoid()))\n        default:\n          return assertUnreachable(c)\n      }\n    } else {\n      return S.of(E.right(constVoid()))\n    }\n  }),\n  S.chain(e => pipe(\n    S.gets(bidL.get),\n    S.map(bid => pipe(e, E.mapLeft(r => ({ bid: bid, ...r })))))))\n   \n\nconst resetForce = S.modify(forceL.set(O.none))\nconst continueForce: typeof resetForce = S.of(constVoid())\nconst updateForce = (bid: Bid) => (force: ConstraintForce) => {\n  switch (force.type) {\n    case \"ForceOneRound\":\n    case \"Relay\":\n      return resetForce\n    case \"ForceGame\":\n      return isGameLevel(bid) ? resetForce : continueForce\n    case \"ForceSlam\":\n      return isSlamLevel(bid) ? resetForce : continueForce\n    default:\n      return assertUnreachable(force)\n  }\n}\n\nconst updateForceS : <A>(s: S.State<BidContext, A>) => S.State<BidContext, A> =\n  flow(\n    S.bindTo('result'),\n    S.apS('bid', S.gets(bidL.get)),\n    S.apS('force', S.gets(forceO.getOption)),\n    S.chain(({ bid, force, result }) =>\n      pipe(force,\n        O.traverse(S.Applicative)(updateForce(bid)),\n        S.map(constant(result)))))\n\nconst checkPass = (bid: Bid) => (force: O.Option<ConstraintForce>) =>\n  !(bid === \"Pass\" && O.isSome(force))\n\nconst checkPassS : (s: S.State<BidContext, Constraint>) => ValidateResult =\n  flow(\n    S.apS('bid', S.gets(bidL.get)),\n    S.apS('force', S.gets(forceL.get)),\n    S.map(({ bid, force }) =>\n      pipe(force,\n        E.fromPredicate(checkPass(bid), () => ({ type: \"PassWhileForcing\" as const, bid })),\n        E.map(constVoid))))\n\nconst checkFinal : ValidateResult =\n  pipe(\n    S.gets(forceO.getOption),\n    S.bindTo('force'),  \n    S.apS('path', S.gets(pathL.get)),\n    S.map(({ force, path }) => pipe(force,\n      E.fromPredicate(O.isNone, () => ({ type: \"NoBidDefinedButStillForcing\", path } as const)),\n      E.map(constVoid))))\n\nconst pathIsSound = (path: BidPath) =>\n  pipe(path,\n    S.traverseArray(info =>\n      pipe(\n        preTraversal(info),\n        S.bindTo('constraint'),\n        S.bind('forceCheck', ({ constraint }) => checkPassS(S.of(constraint))),\n        S.chain(({ constraint, forceCheck }) =>\n          pipe(forceCheck,\n            E.traverse(S.Applicative)(() =>\n              pipe(S.of<BidContext, Constraint>(constraint),\n                updateForceS,\n                validateS,\n                postTraversal(info))),\n            S.map(e => E.flatten<SystemValidationError, void>(e)))))),\n    S.bindTo('result'),\n    S.apS('finalCheck', checkFinal),\n    S.map(({ result, finalCheck }) =>\n      pipe(result,\n        RA.prepend(finalCheck),\n        RA.sequence(E.Applicative),\n        E.map(constVoid))),\n    S.evaluate(zeroContext))\n\nconst treeIsSound = (tree: BidTree) : SystemValidation =>\n  pipe(tree,\n    getAllLeafPaths,\n    RA.traverse(E.Applicative)(pathIsSound),\n    E.map(constVoid))\n\nexport const validateTree = (tree: BidTree) =>\n  pipe(tree,\n    bidTreeSorted,\n    E.chain(() => treeIsSound(tree)))","import { array, either, option, ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlySet, readonlyTuple, refinement, string } from 'fp-ts';\nimport { Either } from 'fp-ts/lib/Either';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport { ReadonlyNonEmptyArray } from 'fp-ts/lib/ReadonlyNonEmptyArray';\nimport * as t from 'io-ts';\nimport * as D from 'io-ts/Decoder';\nimport * as E from 'io-ts/Encoder';\nimport * as iso from 'monocle-ts/Iso';\nimport { O } from 'ts-toolbelt';\nimport { Uuid, UuidLike, UuidTool } from 'uuid-tool';\n\nimport { decodeHand } from '../parse';\nimport { Bid, Board, ContractBid, Deal, directions, isNonContractBid, Strain } from './bridge';\nimport { Card, cards, eqCard, Hand, ordCardDescending } from './deck';\n\nexport type DecodedHand = ReturnType<typeof decodeHand>\nexport type SerializedHand = ReadonlyArray<Card>\nexport type DecodedSerializedHand = DecodedHand extends Either<infer L, unknown> ? either.Either<L, SerializedHand> : never\n\nexport const serializedHandL : iso.Iso<Hand, SerializedHand> = iso.iso(\n  readonlySet.toReadonlyArray(ordCardDescending),\n  readonlySet.fromReadonlyArray(eqCard)\n)\n\nconst liftEither = <E>() => <A, B>(i: iso.Iso<A, B>) => iso.iso<Either<E, A>, Either<E, B>>(either.map(i.get), either.map(i.reverseGet))\nexport const decodedSerializedHandL = liftEither<D.DecodeError>()(serializedHandL)\n\nexport const decodeUuid : D.Decoder<string, Uuid> = {\n  decode: flow(\n    either.fromPredicate(UuidTool.isUuid, s => D.error(s, \"Invalid uuid string\")),\n    either.map(s => new Uuid(s)))\n}\n\nconst MASK = 0b11 as const\nconst getUuidQuads = (uuid: UuidLike) => \n  pipe(new Uuid(uuid.id).toBytes(),\n    readonlyArray.takeLeft(13),\n    readonlyArray.chain(flow(byte =>\n      readonlyArray.unfold([byte, 4 as number] as const, ([byte, i]) =>\n        i === 0\n        ? option.none\n        : option.some([byte & MASK, [byte >> 2, i - 1]] as const)),\n        readonlyArray.reverse))) as ReadonlyNonEmptyArray<number>\n\nexport type SerializedDeal = t.Branded<UuidLike, { readonly Deal: unique symbol }>\nconst isDealUuid: refinement.Refinement<UuidLike, SerializedDeal> =\n  (uuid): uuid is SerializedDeal =>\n    pipe(uuid,\n      getUuidQuads,\n      readonlyArray.reduce(\n        array.replicate(4, 0 as number),\n        (counts, directionIndex) =>\n          { counts[directionIndex] += 1; return counts }),\n      readonlyArray.every(count => count === 13))\n\nconst DealUuidB = t.brand(t.type({ id: t.string }), isDealUuid, 'Deal')\n\nconst dealUuidToDeal: E.Encoder<Deal, SerializedDeal> = {\n  encode: flow(\n    getUuidQuads,\n    readonlyNonEmptyArray.zip(pipe(cards, readonlyNonEmptyArray.sort(ordCardDescending))),\n    readonlyNonEmptyArray.map(([idx, card]) => [directions[idx], card] as const),\n    readonlyNonEmptyArray.groupBy(readonlyTuple.fst),\n    readonlyRecord.map(flow(\n      readonlyNonEmptyArray.map(readonlyTuple.snd),\n      readonlySet.fromReadonlyArray(eqCard))))\n  }\n\ntype CardDirectionPair = readonly [Card, number]\nconst encodeDealAsUuid: E.Encoder<SerializedDeal, Deal> = {\n  encode: flow(\n    readonlyRecord.foldMapWithIndex(ord.trivial)(readonlyArray.getMonoid<CardDirectionPair>())((direction, cards) =>\n      pipe(cards,\n        readonlySet.toReadonlyArray<Card>(ord.trivial),\n        readonlyArray.map(c => [c, directions.indexOf(direction)]))),\n    readonlyArray.sort(ord.contramap((p: CardDirectionPair) => p[0])(ordCardDescending)),\n    readonlyArray.map(readonlyTuple.snd),\n    readonlyArray.chunksOf(4),\n    readonlyArray.map(readonlyArray.reduce(0, (byte, directionIndex) => (byte << 2) + directionIndex)),\n    readonlyArray.concat(readonlyArray.replicate(3, 0)),\n    readonlyArray.toArray,\n    x => (DealUuidB.decode(new Uuid(x)) as either.Right<SerializedDeal>).right)\n  }\n\nexport const serializedDealL = iso.iso<Deal, SerializedDeal>(\n  encodeDealAsUuid.encode,\n  dealUuidToDeal.encode\n)\n\nexport type SerializedBoard = O.Update<Board, \"deal\", SerializedDeal>\nexport const serializedBoardL = iso.iso<Board, SerializedBoard>(\n  b => ({ ...b,\n    deal: serializedDealL.get(b.deal),\n  }),\n  b => ({ ...b,\n    deal: serializedDealL.reverseGet(b.deal),\n  })\n)\n\nexport type SerializedBidPath = t.Branded<string, { readonly BidPath: unique symbol }>\nexport const isBidPath: refinement.Refinement<string, SerializedBidPath> =\n  (s): s is SerializedBidPath =>\n    pipe(s,\n      string.split(\".\"),\n      readonlyArray.every(s => s.length === 2 || isNonContractBid(s)))\n\nexport const serializedContractBidL: iso.Iso<ContractBid, string> = iso.iso(\n  bid => `${bid.level}${bid.strain}`,\n  bid => ({\n    level: parseInt(bid.charAt(0)),\n    strain: bid.charAt(1) as Strain\n  })\n)\n\nexport const serializedBidL : iso.Iso<Bid, string> = iso.iso(\n  bid => isNonContractBid(bid) ? bid : serializedContractBidL.get(bid),\n  bid => isNonContractBid(bid) ? bid : serializedContractBidL.reverseGet(bid)\n)\n\nconst SerializedBidPathB = t.brand(t.string, isBidPath, \"BidPath\")\nexport const serializedBidPathL = iso.iso<readonlyNonEmptyArray.ReadonlyNonEmptyArray<Bid>, SerializedBidPath>(\n  flow(\n    readonlyArray.map(serializedBidL.get),\n    readonlyArray.intersperse(\".\"),\n    readonlyArray.foldMap(string.Monoid)(identity),\n    x => (SerializedBidPathB.decode(x) as either.Right<SerializedBidPath>).right),\n  flow(\n    string.split(\".\"),\n    readonlyNonEmptyArray.map(serializedBidL.reverseGet)))","/* AutoGenerated Code, changes may be overwritten\n* INPUT GRAMMAR:\n* Start := spec=BidSpec $\n* BidSpec := bid=Bid constraints=BidSpecConstraintList?\n* BidSpecConstraintList := ': ' constraints=ConstraintList\n* Bid := ContractBid | NonContractBid\n* ContractBid := level=Digit specifier=BidSpecifier\n* BidSpecifier := Wildcard | SuitSpecifier\n* Wildcard := v='x'\n* SuitSpecifier := Major | Minor | Strain\n* Major := v='M'\n* Minor := v='m'\n* NonContractBid := Pass\n* Pass := v='P'\n* Strain := Suit | Notrump\n* Suit := Club | Diamond | Heart | Spade\n* Club := v='[Cc]'\n* Diamond := v='[Dd]'\n* Heart := v='[Hh]'\n* Spade := v='[Ss]'\n* Notrump := v='[Nn]' '[Tt]'?\n* Honor := v='[AKQJT]'\n* ConstraintList := ConstraintListItem+\n* ConstraintListItem := constraint=Constraint ' '?\n* Constraint :=\n*     Const\n*   | Or\n*   | And\n*   | Not\n*   | Otherwise\n*   | Distribution\n*   | Response\n*   | SuitRange\n*   | SuitBound\n*   | SuitComparison\n*   | SuitHonors\n*   | SuitTop\n*   | SuitRank\n*   | PointRange\n*   | PointBound\n*   | OtherBid\n* Const := True | False\n* True := v='true'\n* False := v='false'\n* Or := left=Constraint ' or ' right=Constraint\n* And := '\\(' constraints=ConstraintList '\\)'\n* Not := {'not' | '!'} ' '? constraint=Constraint\n* Otherwise := v='else'\n* PointRange := lower=Number '-' upper=Number\n* PointBound := value=Number qualifier=BoundQualifier\n* SuitRange := lower=Digit '-' upper=Digit suit=SuitRangeSpecifier\n* SuitBound := value=Number qualifier=BoundQualifier suit=SuitRangeSpecifier\n* SuitRangeSpecifier := Suit //| Major | Minor | OtherMajor | OtherMinor\n* // OtherMajor := v='oM'\n* // OtherMinor := v='om'\n* SuitComparison := left=Suit op=SuitComparisonOperator right=Suit\n* SuitComparisonOperator := v='<' | v='<=' | v='=' | v='>=' | v='>'\n* SuitHonors := suit=Suit honors=Honor+\n* SuitTop := suit=Suit x='[0-5]' '/' y='[1-5]'\n* BoundQualifier := Plus | Minus | Equals\n* Plus := v='\\+'\n* Minus := v='\\-'\n* Equals := v='='\n* OtherBid := level=Number strain=Strain\n* Distribution := Balanced | SemiBalanced | Unbalanced | AnyShape | SpecificShape\n* Balanced := v='BAL'\n* SemiBalanced := v='semiBAL'\n* Unbalanced := v='unBAL'\n* AnyShape := v='[0-9]{4}' '\\*'\n* SpecificShape := S=Digit H=Digit D=Digit C=Digit\n* SuitRank := Primary | Secondary\n* Primary := suit=Suit '1'\n* Secondary := suit=Suit '2'\n* Response := ForceOneRound | ForceGame | ForceSlam | Relay\n* ForceOneRound := v='F1'\n* ForceGame := v='FG'\n* ForceSlam := v='FS'\n* Relay := '->' bid=OtherBid\n* Digit := literal='[0-9]'\n*   .value = number { return parseInt(literal) }\n* Number := literal='[0-9]+'\n*   .value = number { return parseInt(literal) }\n*/\ntype Nullable<T> = T | null;\ntype $$RuleType<T> = () => Nullable<T>;\ninterface ASTNodeIntf {\n    kind: ASTKinds;\n}\nexport enum ASTKinds {\n    Start = \"Start\",\n    BidSpec = \"BidSpec\",\n    BidSpecConstraintList = \"BidSpecConstraintList\",\n    Bid_1 = \"Bid_1\",\n    Bid_2 = \"Bid_2\",\n    ContractBid = \"ContractBid\",\n    BidSpecifier_1 = \"BidSpecifier_1\",\n    BidSpecifier_2 = \"BidSpecifier_2\",\n    Wildcard = \"Wildcard\",\n    SuitSpecifier_1 = \"SuitSpecifier_1\",\n    SuitSpecifier_2 = \"SuitSpecifier_2\",\n    SuitSpecifier_3 = \"SuitSpecifier_3\",\n    Major = \"Major\",\n    Minor = \"Minor\",\n    NonContractBid = \"NonContractBid\",\n    Pass = \"Pass\",\n    Strain_1 = \"Strain_1\",\n    Strain_2 = \"Strain_2\",\n    Suit_1 = \"Suit_1\",\n    Suit_2 = \"Suit_2\",\n    Suit_3 = \"Suit_3\",\n    Suit_4 = \"Suit_4\",\n    Club = \"Club\",\n    Diamond = \"Diamond\",\n    Heart = \"Heart\",\n    Spade = \"Spade\",\n    Notrump = \"Notrump\",\n    Honor = \"Honor\",\n    ConstraintList = \"ConstraintList\",\n    ConstraintListItem = \"ConstraintListItem\",\n    Constraint_1 = \"Constraint_1\",\n    Constraint_2 = \"Constraint_2\",\n    Constraint_3 = \"Constraint_3\",\n    Constraint_4 = \"Constraint_4\",\n    Constraint_5 = \"Constraint_5\",\n    Constraint_6 = \"Constraint_6\",\n    Constraint_7 = \"Constraint_7\",\n    Constraint_8 = \"Constraint_8\",\n    Constraint_9 = \"Constraint_9\",\n    Constraint_10 = \"Constraint_10\",\n    Constraint_11 = \"Constraint_11\",\n    Constraint_12 = \"Constraint_12\",\n    Constraint_13 = \"Constraint_13\",\n    Constraint_14 = \"Constraint_14\",\n    Constraint_15 = \"Constraint_15\",\n    Constraint_16 = \"Constraint_16\",\n    Const_1 = \"Const_1\",\n    Const_2 = \"Const_2\",\n    True = \"True\",\n    False = \"False\",\n    Or = \"Or\",\n    And = \"And\",\n    Not = \"Not\",\n    Not_$0_1 = \"Not_$0_1\",\n    Not_$0_2 = \"Not_$0_2\",\n    Otherwise = \"Otherwise\",\n    PointRange = \"PointRange\",\n    PointBound = \"PointBound\",\n    SuitRange = \"SuitRange\",\n    SuitBound = \"SuitBound\",\n    SuitRangeSpecifier = \"SuitRangeSpecifier\",\n    SuitComparison = \"SuitComparison\",\n    SuitComparisonOperator_1 = \"SuitComparisonOperator_1\",\n    SuitComparisonOperator_2 = \"SuitComparisonOperator_2\",\n    SuitComparisonOperator_3 = \"SuitComparisonOperator_3\",\n    SuitComparisonOperator_4 = \"SuitComparisonOperator_4\",\n    SuitComparisonOperator_5 = \"SuitComparisonOperator_5\",\n    SuitHonors = \"SuitHonors\",\n    SuitTop = \"SuitTop\",\n    BoundQualifier_1 = \"BoundQualifier_1\",\n    BoundQualifier_2 = \"BoundQualifier_2\",\n    BoundQualifier_3 = \"BoundQualifier_3\",\n    Plus = \"Plus\",\n    Minus = \"Minus\",\n    Equals = \"Equals\",\n    OtherBid = \"OtherBid\",\n    Distribution_1 = \"Distribution_1\",\n    Distribution_2 = \"Distribution_2\",\n    Distribution_3 = \"Distribution_3\",\n    Distribution_4 = \"Distribution_4\",\n    Distribution_5 = \"Distribution_5\",\n    Balanced = \"Balanced\",\n    SemiBalanced = \"SemiBalanced\",\n    Unbalanced = \"Unbalanced\",\n    AnyShape = \"AnyShape\",\n    SpecificShape = \"SpecificShape\",\n    SuitRank_1 = \"SuitRank_1\",\n    SuitRank_2 = \"SuitRank_2\",\n    Primary = \"Primary\",\n    Secondary = \"Secondary\",\n    Response_1 = \"Response_1\",\n    Response_2 = \"Response_2\",\n    Response_3 = \"Response_3\",\n    Response_4 = \"Response_4\",\n    ForceOneRound = \"ForceOneRound\",\n    ForceGame = \"ForceGame\",\n    ForceSlam = \"ForceSlam\",\n    Relay = \"Relay\",\n    Digit = \"Digit\",\n    Number = \"Number\",\n    $EOF = \"$EOF\",\n}\nexport interface Start {\n    kind: ASTKinds.Start;\n    spec: BidSpec;\n}\nexport interface BidSpec {\n    kind: ASTKinds.BidSpec;\n    bid: Bid;\n    constraints: Nullable<BidSpecConstraintList>;\n}\nexport interface BidSpecConstraintList {\n    kind: ASTKinds.BidSpecConstraintList;\n    constraints: ConstraintList;\n}\nexport type Bid = Bid_1 | Bid_2;\nexport type Bid_1 = ContractBid;\nexport type Bid_2 = NonContractBid;\nexport interface ContractBid {\n    kind: ASTKinds.ContractBid;\n    level: Digit;\n    specifier: BidSpecifier;\n}\nexport type BidSpecifier = BidSpecifier_1 | BidSpecifier_2;\nexport type BidSpecifier_1 = Wildcard;\nexport type BidSpecifier_2 = SuitSpecifier;\nexport interface Wildcard {\n    kind: ASTKinds.Wildcard;\n    v: string;\n}\nexport type SuitSpecifier = SuitSpecifier_1 | SuitSpecifier_2 | SuitSpecifier_3;\nexport type SuitSpecifier_1 = Major;\nexport type SuitSpecifier_2 = Minor;\nexport type SuitSpecifier_3 = Strain;\nexport interface Major {\n    kind: ASTKinds.Major;\n    v: string;\n}\nexport interface Minor {\n    kind: ASTKinds.Minor;\n    v: string;\n}\nexport type NonContractBid = Pass;\nexport interface Pass {\n    kind: ASTKinds.Pass;\n    v: string;\n}\nexport type Strain = Strain_1 | Strain_2;\nexport type Strain_1 = Suit;\nexport type Strain_2 = Notrump;\nexport type Suit = Suit_1 | Suit_2 | Suit_3 | Suit_4;\nexport type Suit_1 = Club;\nexport type Suit_2 = Diamond;\nexport type Suit_3 = Heart;\nexport type Suit_4 = Spade;\nexport interface Club {\n    kind: ASTKinds.Club;\n    v: string;\n}\nexport interface Diamond {\n    kind: ASTKinds.Diamond;\n    v: string;\n}\nexport interface Heart {\n    kind: ASTKinds.Heart;\n    v: string;\n}\nexport interface Spade {\n    kind: ASTKinds.Spade;\n    v: string;\n}\nexport interface Notrump {\n    kind: ASTKinds.Notrump;\n    v: string;\n}\nexport interface Honor {\n    kind: ASTKinds.Honor;\n    v: string;\n}\nexport type ConstraintList = ConstraintListItem[];\nexport interface ConstraintListItem {\n    kind: ASTKinds.ConstraintListItem;\n    constraint: Constraint;\n}\nexport type Constraint = Constraint_1 | Constraint_2 | Constraint_3 | Constraint_4 | Constraint_5 | Constraint_6 | Constraint_7 | Constraint_8 | Constraint_9 | Constraint_10 | Constraint_11 | Constraint_12 | Constraint_13 | Constraint_14 | Constraint_15 | Constraint_16;\nexport type Constraint_1 = Const;\nexport type Constraint_2 = Or;\nexport type Constraint_3 = And;\nexport type Constraint_4 = Not;\nexport type Constraint_5 = Otherwise;\nexport type Constraint_6 = Distribution;\nexport type Constraint_7 = Response;\nexport type Constraint_8 = SuitRange;\nexport type Constraint_9 = SuitBound;\nexport type Constraint_10 = SuitComparison;\nexport type Constraint_11 = SuitHonors;\nexport type Constraint_12 = SuitTop;\nexport type Constraint_13 = SuitRank;\nexport type Constraint_14 = PointRange;\nexport type Constraint_15 = PointBound;\nexport type Constraint_16 = OtherBid;\nexport type Const = Const_1 | Const_2;\nexport type Const_1 = True;\nexport type Const_2 = False;\nexport interface True {\n    kind: ASTKinds.True;\n    v: string;\n}\nexport interface False {\n    kind: ASTKinds.False;\n    v: string;\n}\nexport interface Or {\n    kind: ASTKinds.Or;\n    left: Constraint;\n    right: Constraint;\n}\nexport interface And {\n    kind: ASTKinds.And;\n    constraints: ConstraintList;\n}\nexport interface Not {\n    kind: ASTKinds.Not;\n    constraint: Constraint;\n}\nexport type Not_$0 = Not_$0_1 | Not_$0_2;\nexport type Not_$0_1 = string;\nexport type Not_$0_2 = string;\nexport interface Otherwise {\n    kind: ASTKinds.Otherwise;\n    v: string;\n}\nexport interface PointRange {\n    kind: ASTKinds.PointRange;\n    lower: Number;\n    upper: Number;\n}\nexport interface PointBound {\n    kind: ASTKinds.PointBound;\n    value: Number;\n    qualifier: BoundQualifier;\n}\nexport interface SuitRange {\n    kind: ASTKinds.SuitRange;\n    lower: Digit;\n    upper: Digit;\n    suit: SuitRangeSpecifier;\n}\nexport interface SuitBound {\n    kind: ASTKinds.SuitBound;\n    value: Number;\n    qualifier: BoundQualifier;\n    suit: SuitRangeSpecifier;\n}\nexport type SuitRangeSpecifier = Suit;\nexport interface SuitComparison {\n    kind: ASTKinds.SuitComparison;\n    left: Suit;\n    op: SuitComparisonOperator;\n    right: Suit;\n}\nexport type SuitComparisonOperator = SuitComparisonOperator_1 | SuitComparisonOperator_2 | SuitComparisonOperator_3 | SuitComparisonOperator_4 | SuitComparisonOperator_5;\nexport interface SuitComparisonOperator_1 {\n    kind: ASTKinds.SuitComparisonOperator_1;\n    v: string;\n}\nexport interface SuitComparisonOperator_2 {\n    kind: ASTKinds.SuitComparisonOperator_2;\n    v: string;\n}\nexport interface SuitComparisonOperator_3 {\n    kind: ASTKinds.SuitComparisonOperator_3;\n    v: string;\n}\nexport interface SuitComparisonOperator_4 {\n    kind: ASTKinds.SuitComparisonOperator_4;\n    v: string;\n}\nexport interface SuitComparisonOperator_5 {\n    kind: ASTKinds.SuitComparisonOperator_5;\n    v: string;\n}\nexport interface SuitHonors {\n    kind: ASTKinds.SuitHonors;\n    suit: Suit;\n    honors: Honor[];\n}\nexport interface SuitTop {\n    kind: ASTKinds.SuitTop;\n    suit: Suit;\n    x: string;\n    y: string;\n}\nexport type BoundQualifier = BoundQualifier_1 | BoundQualifier_2 | BoundQualifier_3;\nexport type BoundQualifier_1 = Plus;\nexport type BoundQualifier_2 = Minus;\nexport type BoundQualifier_3 = Equals;\nexport interface Plus {\n    kind: ASTKinds.Plus;\n    v: string;\n}\nexport interface Minus {\n    kind: ASTKinds.Minus;\n    v: string;\n}\nexport interface Equals {\n    kind: ASTKinds.Equals;\n    v: string;\n}\nexport interface OtherBid {\n    kind: ASTKinds.OtherBid;\n    level: Number;\n    strain: Strain;\n}\nexport type Distribution = Distribution_1 | Distribution_2 | Distribution_3 | Distribution_4 | Distribution_5;\nexport type Distribution_1 = Balanced;\nexport type Distribution_2 = SemiBalanced;\nexport type Distribution_3 = Unbalanced;\nexport type Distribution_4 = AnyShape;\nexport type Distribution_5 = SpecificShape;\nexport interface Balanced {\n    kind: ASTKinds.Balanced;\n    v: string;\n}\nexport interface SemiBalanced {\n    kind: ASTKinds.SemiBalanced;\n    v: string;\n}\nexport interface Unbalanced {\n    kind: ASTKinds.Unbalanced;\n    v: string;\n}\nexport interface AnyShape {\n    kind: ASTKinds.AnyShape;\n    v: string;\n}\nexport interface SpecificShape {\n    kind: ASTKinds.SpecificShape;\n    S: Digit;\n    H: Digit;\n    D: Digit;\n    C: Digit;\n}\nexport type SuitRank = SuitRank_1 | SuitRank_2;\nexport type SuitRank_1 = Primary;\nexport type SuitRank_2 = Secondary;\nexport interface Primary {\n    kind: ASTKinds.Primary;\n    suit: Suit;\n}\nexport interface Secondary {\n    kind: ASTKinds.Secondary;\n    suit: Suit;\n}\nexport type Response = Response_1 | Response_2 | Response_3 | Response_4;\nexport type Response_1 = ForceOneRound;\nexport type Response_2 = ForceGame;\nexport type Response_3 = ForceSlam;\nexport type Response_4 = Relay;\nexport interface ForceOneRound {\n    kind: ASTKinds.ForceOneRound;\n    v: string;\n}\nexport interface ForceGame {\n    kind: ASTKinds.ForceGame;\n    v: string;\n}\nexport interface ForceSlam {\n    kind: ASTKinds.ForceSlam;\n    v: string;\n}\nexport interface Relay {\n    kind: ASTKinds.Relay;\n    bid: OtherBid;\n}\nexport class Digit {\n    public kind: ASTKinds.Digit = ASTKinds.Digit;\n    public literal: string;\n    public value: number;\n    constructor(literal: string){\n        this.literal = literal;\n        this.value = ((): number => {\n        return parseInt(literal)\n        })();\n    }\n}\nexport class Number {\n    public kind: ASTKinds.Number = ASTKinds.Number;\n    public literal: string;\n    public value: number;\n    constructor(literal: string){\n        this.literal = literal;\n        this.value = ((): number => {\n        return parseInt(literal)\n        })();\n    }\n}\nexport class Parser {\n    private readonly input: string;\n    private pos: PosInfo;\n    private negating: boolean = false;\n    private memoSafe: boolean = true;\n    constructor(input: string) {\n        this.pos = {overallPos: 0, line: 1, offset: 0};\n        this.input = input;\n    }\n    public reset(pos: PosInfo) {\n        this.pos = pos;\n    }\n    public finished(): boolean {\n        return this.pos.overallPos === this.input.length;\n    }\n    public clearMemos(): void {\n        this.$scope$Constraint$memo.clear();\n    }\n    protected $scope$Constraint$memo: Map<number, [Nullable<Constraint>, PosInfo]> = new Map();\n    public matchStart($$dpth: number, $$cr?: ErrorTracker): Nullable<Start> {\n        return this.run<Start>($$dpth,\n            () => {\n                let $scope$spec: Nullable<BidSpec>;\n                let $$res: Nullable<Start> = null;\n                if (true\n                    && ($scope$spec = this.matchBidSpec($$dpth + 1, $$cr)) !== null\n                    && this.match$EOF($$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Start, spec: $scope$spec};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpec($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpec> {\n        return this.run<BidSpec>($$dpth,\n            () => {\n                let $scope$bid: Nullable<Bid>;\n                let $scope$constraints: Nullable<Nullable<BidSpecConstraintList>>;\n                let $$res: Nullable<BidSpec> = null;\n                if (true\n                    && ($scope$bid = this.matchBid($$dpth + 1, $$cr)) !== null\n                    && (($scope$constraints = this.matchBidSpecConstraintList($$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.BidSpec, bid: $scope$bid, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpecConstraintList($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecConstraintList> {\n        return this.run<BidSpecConstraintList>($$dpth,\n            () => {\n                let $scope$constraints: Nullable<ConstraintList>;\n                let $$res: Nullable<BidSpecConstraintList> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:: )`, $$dpth + 1, $$cr) !== null\n                    && ($scope$constraints = this.matchConstraintList($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.BidSpecConstraintList, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchBid($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid> {\n        return this.choice<Bid>([\n            () => this.matchBid_1($$dpth + 1, $$cr),\n            () => this.matchBid_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBid_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid_1> {\n        return this.matchContractBid($$dpth + 1, $$cr);\n    }\n    public matchBid_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Bid_2> {\n        return this.matchNonContractBid($$dpth + 1, $$cr);\n    }\n    public matchContractBid($$dpth: number, $$cr?: ErrorTracker): Nullable<ContractBid> {\n        return this.run<ContractBid>($$dpth,\n            () => {\n                let $scope$level: Nullable<Digit>;\n                let $scope$specifier: Nullable<BidSpecifier>;\n                let $$res: Nullable<ContractBid> = null;\n                if (true\n                    && ($scope$level = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$specifier = this.matchBidSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ContractBid, level: $scope$level, specifier: $scope$specifier};\n                }\n                return $$res;\n            });\n    }\n    public matchBidSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier> {\n        return this.choice<BidSpecifier>([\n            () => this.matchBidSpecifier_1($$dpth + 1, $$cr),\n            () => this.matchBidSpecifier_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBidSpecifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier_1> {\n        return this.matchWildcard($$dpth + 1, $$cr);\n    }\n    public matchBidSpecifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<BidSpecifier_2> {\n        return this.matchSuitSpecifier($$dpth + 1, $$cr);\n    }\n    public matchWildcard($$dpth: number, $$cr?: ErrorTracker): Nullable<Wildcard> {\n        return this.run<Wildcard>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Wildcard> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:x)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Wildcard, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier> {\n        return this.choice<SuitSpecifier>([\n            () => this.matchSuitSpecifier_1($$dpth + 1, $$cr),\n            () => this.matchSuitSpecifier_2($$dpth + 1, $$cr),\n            () => this.matchSuitSpecifier_3($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitSpecifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_1> {\n        return this.matchMajor($$dpth + 1, $$cr);\n    }\n    public matchSuitSpecifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_2> {\n        return this.matchMinor($$dpth + 1, $$cr);\n    }\n    public matchSuitSpecifier_3($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitSpecifier_3> {\n        return this.matchStrain($$dpth + 1, $$cr);\n    }\n    public matchMajor($$dpth: number, $$cr?: ErrorTracker): Nullable<Major> {\n        return this.run<Major>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Major> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:M)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Major, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchMinor($$dpth: number, $$cr?: ErrorTracker): Nullable<Minor> {\n        return this.run<Minor>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Minor> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:m)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Minor, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchNonContractBid($$dpth: number, $$cr?: ErrorTracker): Nullable<NonContractBid> {\n        return this.matchPass($$dpth + 1, $$cr);\n    }\n    public matchPass($$dpth: number, $$cr?: ErrorTracker): Nullable<Pass> {\n        return this.run<Pass>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Pass> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:P)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Pass, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchStrain($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain> {\n        return this.choice<Strain>([\n            () => this.matchStrain_1($$dpth + 1, $$cr),\n            () => this.matchStrain_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchStrain_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain_1> {\n        return this.matchSuit($$dpth + 1, $$cr);\n    }\n    public matchStrain_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Strain_2> {\n        return this.matchNotrump($$dpth + 1, $$cr);\n    }\n    public matchSuit($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit> {\n        return this.choice<Suit>([\n            () => this.matchSuit_1($$dpth + 1, $$cr),\n            () => this.matchSuit_2($$dpth + 1, $$cr),\n            () => this.matchSuit_3($$dpth + 1, $$cr),\n            () => this.matchSuit_4($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuit_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_1> {\n        return this.matchClub($$dpth + 1, $$cr);\n    }\n    public matchSuit_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_2> {\n        return this.matchDiamond($$dpth + 1, $$cr);\n    }\n    public matchSuit_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_3> {\n        return this.matchHeart($$dpth + 1, $$cr);\n    }\n    public matchSuit_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit_4> {\n        return this.matchSpade($$dpth + 1, $$cr);\n    }\n    public matchClub($$dpth: number, $$cr?: ErrorTracker): Nullable<Club> {\n        return this.run<Club>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Club> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Cc])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Club, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchDiamond($$dpth: number, $$cr?: ErrorTracker): Nullable<Diamond> {\n        return this.run<Diamond>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Diamond> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Dd])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Diamond, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchHeart($$dpth: number, $$cr?: ErrorTracker): Nullable<Heart> {\n        return this.run<Heart>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Heart> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Hh])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Heart, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSpade($$dpth: number, $$cr?: ErrorTracker): Nullable<Spade> {\n        return this.run<Spade>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Spade> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Ss])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Spade, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchNotrump($$dpth: number, $$cr?: ErrorTracker): Nullable<Notrump> {\n        return this.run<Notrump>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Notrump> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[Nn])`, $$dpth + 1, $$cr)) !== null\n                    && ((this.regexAccept(String.raw`(?:[Tt])`, $$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.Notrump, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchHonor($$dpth: number, $$cr?: ErrorTracker): Nullable<Honor> {\n        return this.run<Honor>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Honor> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[AKQJT])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Honor, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchConstraintList($$dpth: number, $$cr?: ErrorTracker): Nullable<ConstraintList> {\n        return this.loop<ConstraintListItem>(() => this.matchConstraintListItem($$dpth + 1, $$cr), false);\n    }\n    public matchConstraintListItem($$dpth: number, $$cr?: ErrorTracker): Nullable<ConstraintListItem> {\n        return this.run<ConstraintListItem>($$dpth,\n            () => {\n                let $scope$constraint: Nullable<Constraint>;\n                let $$res: Nullable<ConstraintListItem> = null;\n                if (true\n                    && ($scope$constraint = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                    && ((this.regexAccept(String.raw`(?: )`, $$dpth + 1, $$cr)) || true)\n                ) {\n                    $$res = {kind: ASTKinds.ConstraintListItem, constraint: $scope$constraint};\n                }\n                return $$res;\n            });\n    }\n    public matchConstraint($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint> {\n        const fn = () => {\n            return this.choice<Constraint>([\n                () => this.matchConstraint_1($$dpth + 1, $$cr),\n                () => this.matchConstraint_2($$dpth + 1, $$cr),\n                () => this.matchConstraint_3($$dpth + 1, $$cr),\n                () => this.matchConstraint_4($$dpth + 1, $$cr),\n                () => this.matchConstraint_5($$dpth + 1, $$cr),\n                () => this.matchConstraint_6($$dpth + 1, $$cr),\n                () => this.matchConstraint_7($$dpth + 1, $$cr),\n                () => this.matchConstraint_8($$dpth + 1, $$cr),\n                () => this.matchConstraint_9($$dpth + 1, $$cr),\n                () => this.matchConstraint_10($$dpth + 1, $$cr),\n                () => this.matchConstraint_11($$dpth + 1, $$cr),\n                () => this.matchConstraint_12($$dpth + 1, $$cr),\n                () => this.matchConstraint_13($$dpth + 1, $$cr),\n                () => this.matchConstraint_14($$dpth + 1, $$cr),\n                () => this.matchConstraint_15($$dpth + 1, $$cr),\n                () => this.matchConstraint_16($$dpth + 1, $$cr),\n            ]);\n        };\n        const $scope$pos = this.mark();\n        const memo = this.$scope$Constraint$memo.get($scope$pos.overallPos);\n        if(memo !== undefined) {\n            this.reset(memo[1]);\n            return memo[0];\n        }\n        const $scope$oldMemoSafe = this.memoSafe;\n        this.memoSafe = false;\n        this.$scope$Constraint$memo.set($scope$pos.overallPos, [null, $scope$pos]);\n        let lastRes: Nullable<Constraint> = null;\n        let lastPos: PosInfo = $scope$pos;\n        for(;;) {\n            this.reset($scope$pos);\n            const res = fn();\n            const end = this.mark();\n            if(end.overallPos <= lastPos.overallPos)\n                break;\n            lastRes = res;\n            lastPos = end;\n            this.$scope$Constraint$memo.set($scope$pos.overallPos, [lastRes, lastPos]);\n        }\n        this.reset(lastPos);\n        this.memoSafe = $scope$oldMemoSafe;\n        return lastRes;\n    }\n    public matchConstraint_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_1> {\n        return this.matchConst($$dpth + 1, $$cr);\n    }\n    public matchConstraint_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_2> {\n        return this.matchOr($$dpth + 1, $$cr);\n    }\n    public matchConstraint_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_3> {\n        return this.matchAnd($$dpth + 1, $$cr);\n    }\n    public matchConstraint_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_4> {\n        return this.matchNot($$dpth + 1, $$cr);\n    }\n    public matchConstraint_5($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_5> {\n        return this.matchOtherwise($$dpth + 1, $$cr);\n    }\n    public matchConstraint_6($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_6> {\n        return this.matchDistribution($$dpth + 1, $$cr);\n    }\n    public matchConstraint_7($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_7> {\n        return this.matchResponse($$dpth + 1, $$cr);\n    }\n    public matchConstraint_8($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_8> {\n        return this.matchSuitRange($$dpth + 1, $$cr);\n    }\n    public matchConstraint_9($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_9> {\n        return this.matchSuitBound($$dpth + 1, $$cr);\n    }\n    public matchConstraint_10($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_10> {\n        return this.matchSuitComparison($$dpth + 1, $$cr);\n    }\n    public matchConstraint_11($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_11> {\n        return this.matchSuitHonors($$dpth + 1, $$cr);\n    }\n    public matchConstraint_12($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_12> {\n        return this.matchSuitTop($$dpth + 1, $$cr);\n    }\n    public matchConstraint_13($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_13> {\n        return this.matchSuitRank($$dpth + 1, $$cr);\n    }\n    public matchConstraint_14($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_14> {\n        return this.matchPointRange($$dpth + 1, $$cr);\n    }\n    public matchConstraint_15($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_15> {\n        return this.matchPointBound($$dpth + 1, $$cr);\n    }\n    public matchConstraint_16($$dpth: number, $$cr?: ErrorTracker): Nullable<Constraint_16> {\n        return this.matchOtherBid($$dpth + 1, $$cr);\n    }\n    public matchConst($$dpth: number, $$cr?: ErrorTracker): Nullable<Const> {\n        return this.choice<Const>([\n            () => this.matchConst_1($$dpth + 1, $$cr),\n            () => this.matchConst_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchConst_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Const_1> {\n        return this.matchTrue($$dpth + 1, $$cr);\n    }\n    public matchConst_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Const_2> {\n        return this.matchFalse($$dpth + 1, $$cr);\n    }\n    public matchTrue($$dpth: number, $$cr?: ErrorTracker): Nullable<True> {\n        return this.run<True>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<True> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:true)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.True, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchFalse($$dpth: number, $$cr?: ErrorTracker): Nullable<False> {\n        return this.run<False>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<False> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:false)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.False, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchOr($$dpth: number, $$cr?: ErrorTracker): Nullable<Or> {\n        return this.run<Or>($$dpth,\n            () => {\n                let $scope$left: Nullable<Constraint>;\n                let $scope$right: Nullable<Constraint>;\n                let $$res: Nullable<Or> = null;\n                if (true\n                    && ($scope$left = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?: or )`, $$dpth + 1, $$cr) !== null\n                    && ($scope$right = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Or, left: $scope$left, right: $scope$right};\n                }\n                return $$res;\n            });\n    }\n    public matchAnd($$dpth: number, $$cr?: ErrorTracker): Nullable<And> {\n        return this.run<And>($$dpth,\n            () => {\n                let $scope$constraints: Nullable<ConstraintList>;\n                let $$res: Nullable<And> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:\\()`, $$dpth + 1, $$cr) !== null\n                    && ($scope$constraints = this.matchConstraintList($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\))`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.And, constraints: $scope$constraints};\n                }\n                return $$res;\n            });\n    }\n    public matchNot($$dpth: number, $$cr?: ErrorTracker): Nullable<Not> {\n        return this.run<Not>($$dpth,\n            () => {\n                let $scope$constraint: Nullable<Constraint>;\n                let $$res: Nullable<Not> = null;\n                if (true\n                    && this.matchNot_$0($$dpth + 1, $$cr) !== null\n                    && ((this.regexAccept(String.raw`(?: )`, $$dpth + 1, $$cr)) || true)\n                    && ($scope$constraint = this.matchConstraint($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Not, constraint: $scope$constraint};\n                }\n                return $$res;\n            });\n    }\n    public matchNot_$0($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0> {\n        return this.choice<Not_$0>([\n            () => this.matchNot_$0_1($$dpth + 1, $$cr),\n            () => this.matchNot_$0_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchNot_$0_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0_1> {\n        return this.regexAccept(String.raw`(?:not)`, $$dpth + 1, $$cr);\n    }\n    public matchNot_$0_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Not_$0_2> {\n        return this.regexAccept(String.raw`(?:!)`, $$dpth + 1, $$cr);\n    }\n    public matchOtherwise($$dpth: number, $$cr?: ErrorTracker): Nullable<Otherwise> {\n        return this.run<Otherwise>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Otherwise> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:else)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Otherwise, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchPointRange($$dpth: number, $$cr?: ErrorTracker): Nullable<PointRange> {\n        return this.run<PointRange>($$dpth,\n            () => {\n                let $scope$lower: Nullable<Number>;\n                let $scope$upper: Nullable<Number>;\n                let $$res: Nullable<PointRange> = null;\n                if (true\n                    && ($scope$lower = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:-)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$upper = this.matchNumber($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.PointRange, lower: $scope$lower, upper: $scope$upper};\n                }\n                return $$res;\n            });\n    }\n    public matchPointBound($$dpth: number, $$cr?: ErrorTracker): Nullable<PointBound> {\n        return this.run<PointBound>($$dpth,\n            () => {\n                let $scope$value: Nullable<Number>;\n                let $scope$qualifier: Nullable<BoundQualifier>;\n                let $$res: Nullable<PointBound> = null;\n                if (true\n                    && ($scope$value = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$qualifier = this.matchBoundQualifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.PointBound, value: $scope$value, qualifier: $scope$qualifier};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRange($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRange> {\n        return this.run<SuitRange>($$dpth,\n            () => {\n                let $scope$lower: Nullable<Digit>;\n                let $scope$upper: Nullable<Digit>;\n                let $scope$suit: Nullable<SuitRangeSpecifier>;\n                let $$res: Nullable<SuitRange> = null;\n                if (true\n                    && ($scope$lower = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:-)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$upper = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$suit = this.matchSuitRangeSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitRange, lower: $scope$lower, upper: $scope$upper, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitBound($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitBound> {\n        return this.run<SuitBound>($$dpth,\n            () => {\n                let $scope$value: Nullable<Number>;\n                let $scope$qualifier: Nullable<BoundQualifier>;\n                let $scope$suit: Nullable<SuitRangeSpecifier>;\n                let $$res: Nullable<SuitBound> = null;\n                if (true\n                    && ($scope$value = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$qualifier = this.matchBoundQualifier($$dpth + 1, $$cr)) !== null\n                    && ($scope$suit = this.matchSuitRangeSpecifier($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitBound, value: $scope$value, qualifier: $scope$qualifier, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRangeSpecifier($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRangeSpecifier> {\n        return this.matchSuit($$dpth + 1, $$cr);\n    }\n    public matchSuitComparison($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparison> {\n        return this.run<SuitComparison>($$dpth,\n            () => {\n                let $scope$left: Nullable<Suit>;\n                let $scope$op: Nullable<SuitComparisonOperator>;\n                let $scope$right: Nullable<Suit>;\n                let $$res: Nullable<SuitComparison> = null;\n                if (true\n                    && ($scope$left = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$op = this.matchSuitComparisonOperator($$dpth + 1, $$cr)) !== null\n                    && ($scope$right = this.matchSuit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparison, left: $scope$left, op: $scope$op, right: $scope$right};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator> {\n        return this.choice<SuitComparisonOperator>([\n            () => this.matchSuitComparisonOperator_1($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_2($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_3($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_4($$dpth + 1, $$cr),\n            () => this.matchSuitComparisonOperator_5($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitComparisonOperator_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_1> {\n        return this.run<SuitComparisonOperator_1>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_1> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:<)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_1, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_2> {\n        return this.run<SuitComparisonOperator_2>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_2> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:<=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_2, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_3($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_3> {\n        return this.run<SuitComparisonOperator_3>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_3> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_3, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_4($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_4> {\n        return this.run<SuitComparisonOperator_4>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_4> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:>=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_4, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitComparisonOperator_5($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitComparisonOperator_5> {\n        return this.run<SuitComparisonOperator_5>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SuitComparisonOperator_5> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:>)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitComparisonOperator_5, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitHonors($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitHonors> {\n        return this.run<SuitHonors>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $scope$honors: Nullable<Honor[]>;\n                let $$res: Nullable<SuitHonors> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$honors = this.loop<Honor>(() => this.matchHonor($$dpth + 1, $$cr), false)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitHonors, suit: $scope$suit, honors: $scope$honors};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitTop($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitTop> {\n        return this.run<SuitTop>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $scope$x: Nullable<string>;\n                let $scope$y: Nullable<string>;\n                let $$res: Nullable<SuitTop> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && ($scope$x = this.regexAccept(String.raw`(?:[0-5])`, $$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:/)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$y = this.regexAccept(String.raw`(?:[1-5])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SuitTop, suit: $scope$suit, x: $scope$x, y: $scope$y};\n                }\n                return $$res;\n            });\n    }\n    public matchBoundQualifier($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier> {\n        return this.choice<BoundQualifier>([\n            () => this.matchBoundQualifier_1($$dpth + 1, $$cr),\n            () => this.matchBoundQualifier_2($$dpth + 1, $$cr),\n            () => this.matchBoundQualifier_3($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchBoundQualifier_1($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_1> {\n        return this.matchPlus($$dpth + 1, $$cr);\n    }\n    public matchBoundQualifier_2($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_2> {\n        return this.matchMinus($$dpth + 1, $$cr);\n    }\n    public matchBoundQualifier_3($$dpth: number, $$cr?: ErrorTracker): Nullable<BoundQualifier_3> {\n        return this.matchEquals($$dpth + 1, $$cr);\n    }\n    public matchPlus($$dpth: number, $$cr?: ErrorTracker): Nullable<Plus> {\n        return this.run<Plus>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Plus> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:\\+)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Plus, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchMinus($$dpth: number, $$cr?: ErrorTracker): Nullable<Minus> {\n        return this.run<Minus>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Minus> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:\\-)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Minus, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchEquals($$dpth: number, $$cr?: ErrorTracker): Nullable<Equals> {\n        return this.run<Equals>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Equals> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:=)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Equals, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchOtherBid($$dpth: number, $$cr?: ErrorTracker): Nullable<OtherBid> {\n        return this.run<OtherBid>($$dpth,\n            () => {\n                let $scope$level: Nullable<Number>;\n                let $scope$strain: Nullable<Strain>;\n                let $$res: Nullable<OtherBid> = null;\n                if (true\n                    && ($scope$level = this.matchNumber($$dpth + 1, $$cr)) !== null\n                    && ($scope$strain = this.matchStrain($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.OtherBid, level: $scope$level, strain: $scope$strain};\n                }\n                return $$res;\n            });\n    }\n    public matchDistribution($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution> {\n        return this.choice<Distribution>([\n            () => this.matchDistribution_1($$dpth + 1, $$cr),\n            () => this.matchDistribution_2($$dpth + 1, $$cr),\n            () => this.matchDistribution_3($$dpth + 1, $$cr),\n            () => this.matchDistribution_4($$dpth + 1, $$cr),\n            () => this.matchDistribution_5($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchDistribution_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_1> {\n        return this.matchBalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_2> {\n        return this.matchSemiBalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_3> {\n        return this.matchUnbalanced($$dpth + 1, $$cr);\n    }\n    public matchDistribution_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_4> {\n        return this.matchAnyShape($$dpth + 1, $$cr);\n    }\n    public matchDistribution_5($$dpth: number, $$cr?: ErrorTracker): Nullable<Distribution_5> {\n        return this.matchSpecificShape($$dpth + 1, $$cr);\n    }\n    public matchBalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<Balanced> {\n        return this.run<Balanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Balanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:BAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Balanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSemiBalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<SemiBalanced> {\n        return this.run<SemiBalanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<SemiBalanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:semiBAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SemiBalanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchUnbalanced($$dpth: number, $$cr?: ErrorTracker): Nullable<Unbalanced> {\n        return this.run<Unbalanced>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<Unbalanced> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:unBAL)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Unbalanced, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchAnyShape($$dpth: number, $$cr?: ErrorTracker): Nullable<AnyShape> {\n        return this.run<AnyShape>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<AnyShape> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:[0-9]{4})`, $$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\*)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.AnyShape, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchSpecificShape($$dpth: number, $$cr?: ErrorTracker): Nullable<SpecificShape> {\n        return this.run<SpecificShape>($$dpth,\n            () => {\n                let $scope$S: Nullable<Digit>;\n                let $scope$H: Nullable<Digit>;\n                let $scope$D: Nullable<Digit>;\n                let $scope$C: Nullable<Digit>;\n                let $$res: Nullable<SpecificShape> = null;\n                if (true\n                    && ($scope$S = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$H = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$D = this.matchDigit($$dpth + 1, $$cr)) !== null\n                    && ($scope$C = this.matchDigit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.SpecificShape, S: $scope$S, H: $scope$H, D: $scope$D, C: $scope$C};\n                }\n                return $$res;\n            });\n    }\n    public matchSuitRank($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank> {\n        return this.choice<SuitRank>([\n            () => this.matchSuitRank_1($$dpth + 1, $$cr),\n            () => this.matchSuitRank_2($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchSuitRank_1($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank_1> {\n        return this.matchPrimary($$dpth + 1, $$cr);\n    }\n    public matchSuitRank_2($$dpth: number, $$cr?: ErrorTracker): Nullable<SuitRank_2> {\n        return this.matchSecondary($$dpth + 1, $$cr);\n    }\n    public matchPrimary($$dpth: number, $$cr?: ErrorTracker): Nullable<Primary> {\n        return this.run<Primary>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $$res: Nullable<Primary> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:1)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Primary, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchSecondary($$dpth: number, $$cr?: ErrorTracker): Nullable<Secondary> {\n        return this.run<Secondary>($$dpth,\n            () => {\n                let $scope$suit: Nullable<Suit>;\n                let $$res: Nullable<Secondary> = null;\n                if (true\n                    && ($scope$suit = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:2)`, $$dpth + 1, $$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Secondary, suit: $scope$suit};\n                }\n                return $$res;\n            });\n    }\n    public matchResponse($$dpth: number, $$cr?: ErrorTracker): Nullable<Response> {\n        return this.choice<Response>([\n            () => this.matchResponse_1($$dpth + 1, $$cr),\n            () => this.matchResponse_2($$dpth + 1, $$cr),\n            () => this.matchResponse_3($$dpth + 1, $$cr),\n            () => this.matchResponse_4($$dpth + 1, $$cr),\n        ]);\n    }\n    public matchResponse_1($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_1> {\n        return this.matchForceOneRound($$dpth + 1, $$cr);\n    }\n    public matchResponse_2($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_2> {\n        return this.matchForceGame($$dpth + 1, $$cr);\n    }\n    public matchResponse_3($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_3> {\n        return this.matchForceSlam($$dpth + 1, $$cr);\n    }\n    public matchResponse_4($$dpth: number, $$cr?: ErrorTracker): Nullable<Response_4> {\n        return this.matchRelay($$dpth + 1, $$cr);\n    }\n    public matchForceOneRound($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceOneRound> {\n        return this.run<ForceOneRound>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceOneRound> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:F1)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceOneRound, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchForceGame($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceGame> {\n        return this.run<ForceGame>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceGame> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:FG)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceGame, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchForceSlam($$dpth: number, $$cr?: ErrorTracker): Nullable<ForceSlam> {\n        return this.run<ForceSlam>($$dpth,\n            () => {\n                let $scope$v: Nullable<string>;\n                let $$res: Nullable<ForceSlam> = null;\n                if (true\n                    && ($scope$v = this.regexAccept(String.raw`(?:FS)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.ForceSlam, v: $scope$v};\n                }\n                return $$res;\n            });\n    }\n    public matchRelay($$dpth: number, $$cr?: ErrorTracker): Nullable<Relay> {\n        return this.run<Relay>($$dpth,\n            () => {\n                let $scope$bid: Nullable<OtherBid>;\n                let $$res: Nullable<Relay> = null;\n                if (true\n                    && this.regexAccept(String.raw`(?:->)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$bid = this.matchOtherBid($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Relay, bid: $scope$bid};\n                }\n                return $$res;\n            });\n    }\n    public matchDigit($$dpth: number, $$cr?: ErrorTracker): Nullable<Digit> {\n        return this.run<Digit>($$dpth,\n            () => {\n                let $scope$literal: Nullable<string>;\n                let $$res: Nullable<Digit> = null;\n                if (true\n                    && ($scope$literal = this.regexAccept(String.raw`(?:[0-9])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Digit($scope$literal);\n                }\n                return $$res;\n            });\n    }\n    public matchNumber($$dpth: number, $$cr?: ErrorTracker): Nullable<Number> {\n        return this.run<Number>($$dpth,\n            () => {\n                let $scope$literal: Nullable<string>;\n                let $$res: Nullable<Number> = null;\n                if (true\n                    && ($scope$literal = this.regexAccept(String.raw`(?:[0-9]+)`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Number($scope$literal);\n                }\n                return $$res;\n            });\n    }\n    public test(): boolean {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        const ans = res !== null;\n        this.reset(mrk);\n        return ans;\n    }\n    public parse(): ParseResult {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        if (res)\n            return {ast: res, errs: []};\n        this.reset(mrk);\n        const rec = new ErrorTracker();\n        this.clearMemos();\n        this.matchStart(0, rec);\n        const err = rec.getErr()\n        return {ast: res, errs: err !== null ? [err] : []}\n    }\n    public mark(): PosInfo {\n        return this.pos;\n    }\n    private loop<T>(func: $$RuleType<T>, star: boolean = false): Nullable<T[]> {\n        const mrk = this.mark();\n        const res: T[] = [];\n        for (;;) {\n            const t = func();\n            if (t === null) {\n                break;\n            }\n            res.push(t);\n        }\n        if (star || res.length > 0) {\n            return res;\n        }\n        this.reset(mrk);\n        return null;\n    }\n    private run<T>($$dpth: number, fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn()\n        if (res !== null)\n            return res;\n        this.reset(mrk);\n        return null;\n    }\n    private choice<T>(fns: Array<$$RuleType<T>>): Nullable<T> {\n        for (const f of fns) {\n            const res = f();\n            if (res !== null) {\n                return res;\n            }\n        }\n        return null;\n    }\n    private regexAccept(match: string, dpth: number, cr?: ErrorTracker): Nullable<string> {\n        return this.run<string>(dpth,\n            () => {\n                const reg = new RegExp(match, \"y\");\n                const mrk = this.mark();\n                reg.lastIndex = mrk.overallPos;\n                const res = this.tryConsume(reg);\n                if(cr) {\n                    cr.record(mrk, res, {\n                        kind: \"RegexMatch\",\n                        // We substring from 3 to len - 1 to strip off the\n                        // non-capture group syntax added as a WebKit workaround\n                        literal: match.substring(3, match.length - 1),\n                        negated: this.negating,\n                    });\n                }\n                return res;\n            });\n    }\n    private tryConsume(reg: RegExp): Nullable<string> {\n        const res = reg.exec(this.input);\n        if (res) {\n            let lineJmp = 0;\n            let lind = -1;\n            for (let i = 0; i < res[0].length; ++i) {\n                if (res[0][i] === \"\\n\") {\n                    ++lineJmp;\n                    lind = i;\n                }\n            }\n            this.pos = {\n                overallPos: reg.lastIndex,\n                line: this.pos.line + lineJmp,\n                offset: lind === -1 ? this.pos.offset + res[0].length : (res[0].length - lind - 1)\n            };\n            return res[0];\n        }\n        return null;\n    }\n    private noConsume<T>(fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn();\n        this.reset(mrk);\n        return res;\n    }\n    private negate<T>(fn: $$RuleType<T>): Nullable<boolean> {\n        const mrk = this.mark();\n        const oneg = this.negating;\n        this.negating = !oneg;\n        const res = fn();\n        this.negating = oneg;\n        this.reset(mrk);\n        return res === null ? true : null;\n    }\n    private memoise<K>(rule: $$RuleType<K>, memo: Map<number, [Nullable<K>, PosInfo]>): Nullable<K> {\n        const $scope$pos = this.mark();\n        const $scope$memoRes = memo.get($scope$pos.overallPos);\n        if(this.memoSafe && $scope$memoRes !== undefined) {\n        this.reset($scope$memoRes[1]);\n        return $scope$memoRes[0];\n        }\n        const $scope$result = rule();\n        if(this.memoSafe)\n        memo.set($scope$pos.overallPos, [$scope$result, this.mark()]);\n        return $scope$result;\n    }\n    private match$EOF(et?: ErrorTracker): Nullable<{kind: ASTKinds.$EOF}> {\n        const res: {kind: ASTKinds.$EOF} | null = this.finished() ? { kind: ASTKinds.$EOF } : null;\n        if(et)\n            et.record(this.mark(), res, { kind: \"EOF\", negated: this.negating });\n        return res;\n    }\n}\nexport function parse(s: string): ParseResult {\n    const p = new Parser(s);\n    return p.parse();\n}\nexport interface ParseResult {\n    ast: Nullable<Start>;\n    errs: SyntaxErr[];\n}\nexport interface PosInfo {\n    readonly overallPos: number;\n    readonly line: number;\n    readonly offset: number;\n}\nexport interface RegexMatch {\n    readonly kind: \"RegexMatch\";\n    readonly negated: boolean;\n    readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\nexport class SyntaxErr {\n    public pos: PosInfo;\n    public expmatches: MatchAttempt[];\n    constructor(pos: PosInfo, expmatches: MatchAttempt[]) {\n        this.pos = pos;\n        this.expmatches = [...expmatches];\n    }\n    public toString(): string {\n        return `Syntax Error at line ${this.pos.line}:${this.pos.offset}. Expected one of ${this.expmatches.map(x => x.kind === \"EOF\" ? \" EOF\" : ` ${x.negated ? 'not ': ''}'${x.literal}'`)}`;\n    }\n}\nclass ErrorTracker {\n    private mxpos: PosInfo = {overallPos: -1, line: -1, offset: -1};\n    private regexset: Set<string> = new Set();\n    private pmatches: MatchAttempt[] = [];\n    public record(pos: PosInfo, result: any, att: MatchAttempt) {\n        if ((result === null) === att.negated)\n            return;\n        if (pos.overallPos > this.mxpos.overallPos) {\n            this.mxpos = pos;\n            this.pmatches = [];\n            this.regexset.clear()\n        }\n        if (this.mxpos.overallPos === pos.overallPos) {\n            if(att.kind === \"RegexMatch\") {\n                if(!this.regexset.has(att.literal))\n                    this.pmatches.push(att);\n                this.regexset.add(att.literal);\n            } else {\n                this.pmatches.push(att);\n            }\n        }\n    }\n    public getErr(): SyntaxErr | null {\n        if (this.mxpos.overallPos !== -1)\n            return new SyntaxErr(this.mxpos, this.pmatches);\n        return null;\n    }\n}","/* AutoGenerated Code, changes may be overwritten\n* INPUT GRAMMAR:\n* Start := hand=Hand $\n* Hand := S=Suit '\\.' H=Suit '\\.' D=Suit '\\.' C=Suit\n* Suit := cards=Card*\n* Card := c='[AKQJT2-9]'\n*   .rank = number {\n*     const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A']\n*     return rankStrings.indexOf(c) + 2\n*   }\n* // ValidChar := '[AKQJT2-9.]{16}' // 13 + 3 dots\n*/\ntype Nullable<T> = T | null;\ntype $$RuleType<T> = () => Nullable<T>;\ninterface ASTNodeIntf {\n    kind: ASTKinds;\n}\nexport enum ASTKinds {\n    Start = \"Start\",\n    Hand = \"Hand\",\n    Suit = \"Suit\",\n    Card = \"Card\",\n    $EOF = \"$EOF\",\n}\nexport interface Start {\n    kind: ASTKinds.Start;\n    hand: Hand;\n}\nexport interface Hand {\n    kind: ASTKinds.Hand;\n    S: Suit;\n    H: Suit;\n    D: Suit;\n    C: Suit;\n}\nexport interface Suit {\n    kind: ASTKinds.Suit;\n    cards: Card[];\n}\nexport class Card {\n    public kind: ASTKinds.Card = ASTKinds.Card;\n    public c: string;\n    public rank: number;\n    constructor(c: string){\n        this.c = c;\n        this.rank = ((): number => {\n        const rankStrings = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A']\n    return rankStrings.indexOf(c) + 2\n        })();\n    }\n}\nexport class Parser {\n    private readonly input: string;\n    private pos: PosInfo;\n    private negating: boolean = false;\n    private memoSafe: boolean = true;\n    constructor(input: string) {\n        this.pos = {overallPos: 0, line: 1, offset: 0};\n        this.input = input;\n    }\n    public reset(pos: PosInfo) {\n        this.pos = pos;\n    }\n    public finished(): boolean {\n        return this.pos.overallPos === this.input.length;\n    }\n    public clearMemos(): void {\n    }\n    public matchStart($$dpth: number, $$cr?: ErrorTracker): Nullable<Start> {\n        return this.run<Start>($$dpth,\n            () => {\n                let $scope$hand: Nullable<Hand>;\n                let $$res: Nullable<Start> = null;\n                if (true\n                    && ($scope$hand = this.matchHand($$dpth + 1, $$cr)) !== null\n                    && this.match$EOF($$cr) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Start, hand: $scope$hand};\n                }\n                return $$res;\n            });\n    }\n    public matchHand($$dpth: number, $$cr?: ErrorTracker): Nullable<Hand> {\n        return this.run<Hand>($$dpth,\n            () => {\n                let $scope$S: Nullable<Suit>;\n                let $scope$H: Nullable<Suit>;\n                let $scope$D: Nullable<Suit>;\n                let $scope$C: Nullable<Suit>;\n                let $$res: Nullable<Hand> = null;\n                if (true\n                    && ($scope$S = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$H = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$D = this.matchSuit($$dpth + 1, $$cr)) !== null\n                    && this.regexAccept(String.raw`(?:\\.)`, $$dpth + 1, $$cr) !== null\n                    && ($scope$C = this.matchSuit($$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Hand, S: $scope$S, H: $scope$H, D: $scope$D, C: $scope$C};\n                }\n                return $$res;\n            });\n    }\n    public matchSuit($$dpth: number, $$cr?: ErrorTracker): Nullable<Suit> {\n        return this.run<Suit>($$dpth,\n            () => {\n                let $scope$cards: Nullable<Card[]>;\n                let $$res: Nullable<Suit> = null;\n                if (true\n                    && ($scope$cards = this.loop<Card>(() => this.matchCard($$dpth + 1, $$cr), true)) !== null\n                ) {\n                    $$res = {kind: ASTKinds.Suit, cards: $scope$cards};\n                }\n                return $$res;\n            });\n    }\n    public matchCard($$dpth: number, $$cr?: ErrorTracker): Nullable<Card> {\n        return this.run<Card>($$dpth,\n            () => {\n                let $scope$c: Nullable<string>;\n                let $$res: Nullable<Card> = null;\n                if (true\n                    && ($scope$c = this.regexAccept(String.raw`(?:[AKQJT2-9])`, $$dpth + 1, $$cr)) !== null\n                ) {\n                    $$res = new Card($scope$c);\n                }\n                return $$res;\n            });\n    }\n    public test(): boolean {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        const ans = res !== null;\n        this.reset(mrk);\n        return ans;\n    }\n    public parse(): ParseResult {\n        const mrk = this.mark();\n        const res = this.matchStart(0);\n        if (res)\n            return {ast: res, errs: []};\n        this.reset(mrk);\n        const rec = new ErrorTracker();\n        this.clearMemos();\n        this.matchStart(0, rec);\n        const err = rec.getErr()\n        return {ast: res, errs: err !== null ? [err] : []}\n    }\n    public mark(): PosInfo {\n        return this.pos;\n    }\n    private loop<T>(func: $$RuleType<T>, star: boolean = false): Nullable<T[]> {\n        const mrk = this.mark();\n        const res: T[] = [];\n        for (;;) {\n            const t = func();\n            if (t === null) {\n                break;\n            }\n            res.push(t);\n        }\n        if (star || res.length > 0) {\n            return res;\n        }\n        this.reset(mrk);\n        return null;\n    }\n    private run<T>($$dpth: number, fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn()\n        if (res !== null)\n            return res;\n        this.reset(mrk);\n        return null;\n    }\n    private choice<T>(fns: Array<$$RuleType<T>>): Nullable<T> {\n        for (const f of fns) {\n            const res = f();\n            if (res !== null) {\n                return res;\n            }\n        }\n        return null;\n    }\n    private regexAccept(match: string, dpth: number, cr?: ErrorTracker): Nullable<string> {\n        return this.run<string>(dpth,\n            () => {\n                const reg = new RegExp(match, \"y\");\n                const mrk = this.mark();\n                reg.lastIndex = mrk.overallPos;\n                const res = this.tryConsume(reg);\n                if(cr) {\n                    cr.record(mrk, res, {\n                        kind: \"RegexMatch\",\n                        // We substring from 3 to len - 1 to strip off the\n                        // non-capture group syntax added as a WebKit workaround\n                        literal: match.substring(3, match.length - 1),\n                        negated: this.negating,\n                    });\n                }\n                return res;\n            });\n    }\n    private tryConsume(reg: RegExp): Nullable<string> {\n        const res = reg.exec(this.input);\n        if (res) {\n            let lineJmp = 0;\n            let lind = -1;\n            for (let i = 0; i < res[0].length; ++i) {\n                if (res[0][i] === \"\\n\") {\n                    ++lineJmp;\n                    lind = i;\n                }\n            }\n            this.pos = {\n                overallPos: reg.lastIndex,\n                line: this.pos.line + lineJmp,\n                offset: lind === -1 ? this.pos.offset + res[0].length : (res[0].length - lind - 1)\n            };\n            return res[0];\n        }\n        return null;\n    }\n    private noConsume<T>(fn: $$RuleType<T>): Nullable<T> {\n        const mrk = this.mark();\n        const res = fn();\n        this.reset(mrk);\n        return res;\n    }\n    private negate<T>(fn: $$RuleType<T>): Nullable<boolean> {\n        const mrk = this.mark();\n        const oneg = this.negating;\n        this.negating = !oneg;\n        const res = fn();\n        this.negating = oneg;\n        this.reset(mrk);\n        return res === null ? true : null;\n    }\n    private memoise<K>(rule: $$RuleType<K>, memo: Map<number, [Nullable<K>, PosInfo]>): Nullable<K> {\n        const $scope$pos = this.mark();\n        const $scope$memoRes = memo.get($scope$pos.overallPos);\n        if(this.memoSafe && $scope$memoRes !== undefined) {\n        this.reset($scope$memoRes[1]);\n        return $scope$memoRes[0];\n        }\n        const $scope$result = rule();\n        if(this.memoSafe)\n        memo.set($scope$pos.overallPos, [$scope$result, this.mark()]);\n        return $scope$result;\n    }\n    private match$EOF(et?: ErrorTracker): Nullable<{kind: ASTKinds.$EOF}> {\n        const res: {kind: ASTKinds.$EOF} | null = this.finished() ? { kind: ASTKinds.$EOF } : null;\n        if(et)\n            et.record(this.mark(), res, { kind: \"EOF\", negated: this.negating });\n        return res;\n    }\n}\nexport function parse(s: string): ParseResult {\n    const p = new Parser(s);\n    return p.parse();\n}\nexport interface ParseResult {\n    ast: Nullable<Start>;\n    errs: SyntaxErr[];\n}\nexport interface PosInfo {\n    readonly overallPos: number;\n    readonly line: number;\n    readonly offset: number;\n}\nexport interface RegexMatch {\n    readonly kind: \"RegexMatch\";\n    readonly negated: boolean;\n    readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\nexport class SyntaxErr {\n    public pos: PosInfo;\n    public expmatches: MatchAttempt[];\n    constructor(pos: PosInfo, expmatches: MatchAttempt[]) {\n        this.pos = pos;\n        this.expmatches = [...expmatches];\n    }\n    public toString(): string {\n        return `Syntax Error at line ${this.pos.line}:${this.pos.offset}. Expected one of ${this.expmatches.map(x => x.kind === \"EOF\" ? \" EOF\" : ` ${x.negated ? 'not ': ''}'${x.literal}'`)}`;\n    }\n}\nclass ErrorTracker {\n    private mxpos: PosInfo = {overallPos: -1, line: -1, offset: -1};\n    private regexset: Set<string> = new Set();\n    private pmatches: MatchAttempt[] = [];\n    public record(pos: PosInfo, result: any, att: MatchAttempt) {\n        if ((result === null) === att.negated)\n            return;\n        if (pos.overallPos > this.mxpos.overallPos) {\n            this.mxpos = pos;\n            this.pmatches = [];\n            this.regexset.clear()\n        }\n        if (this.mxpos.overallPos === pos.overallPos) {\n            if(att.kind === \"RegexMatch\") {\n                if(!this.regexset.has(att.literal))\n                    this.pmatches.push(att);\n                this.regexset.add(att.literal);\n            } else {\n                this.pmatches.push(att);\n            }\n        }\n    }\n    public getErr(): SyntaxErr | null {\n        if (this.mxpos.overallPos !== -1)\n            return new SyntaxErr(this.mxpos, this.pmatches);\n        return null;\n    }\n}","import { either, eitherT, option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, string } from 'fp-ts';\nimport { constant, flow, identity, pipe } from 'fp-ts/lib/function';\n\nimport { assertUnreachable } from '../lib';\nimport { Bid, Strain, zeroSpecificShape } from '../model/bridge';\nimport { constConstraintFalse, constConstraintTrue, ConstrainedBid, Constraint, SuitComparisonOperator, SuitRangeSpecifier } from '../model/constraints';\nimport { rankFromString, ranks, Suit } from '../model/deck';\nimport * as AST from '../parse/bid.peg.g';\n\nconst getConnectiveItems = (items: ReadonlyArray<AST.Constraint>) =>\n  pipe(items,\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.map(flow(\n      readonlyNonEmptyArray.map(constraintFromAST),\n      either.fromPredicate(i => i.length > 1, i => i[0]))))\n\nconst connectiveFromAST = (type: \"Conjunction\" | \"Disjunction\", zero: () => Constraint) =>\n  flow(getConnectiveItems,\n    eitherT.match(option.Functor)(identity, constraints => ({\n      type,\n      constraints\n    }) as const),\n    option.getOrElse(zero))\n\nconst suitFromAST = (s: AST.Suit) : Suit =>\n  s.kind === AST.ASTKinds.Club    ? 'C' :\n  s.kind === AST.ASTKinds.Diamond ? 'D' :\n  s.kind === AST.ASTKinds.Heart   ? 'H' :\n                                    'S'\n\nconst strainFromAST = (s: AST.Strain) : Strain =>\n  s.kind === AST.ASTKinds.Notrump ? 'N' :\n  suitFromAST(s)\n\nconst suitSpecifierFromAST = (s: AST.SuitRangeSpecifier) : SuitRangeSpecifier =>\n  // s.kind === AST.ASTKinds.Major ? \"Major\" :\n  // s.kind === AST.ASTKinds.Minor ? \"Minor\" :\n  suitFromAST(s)\n\nconst bindValueFromASTQualifier = (s: AST.BoundQualifier, value: number) => (type: 'min' | 'max') =>\n  pipe(value,\n    option.of,\n    option.filter(_ =>\n      s.kind === AST.ASTKinds.Equals\n      || (type === 'min' && s.kind === AST.ASTKinds.Plus)\n      || (type === 'max' && s.kind === AST.ASTKinds.Minus)))\n\nexport const constraintFromAST = (c: AST.Constraint) : Constraint => {\n  switch (c.kind) {\n\n    case AST.ASTKinds.True:\n      return constConstraintTrue()\n\n    case AST.ASTKinds.False:\n      return constConstraintFalse()\n\n    case AST.ASTKinds.And:\n      return pipe(\n        c.constraints,\n        readonlyArray.map(c => c.constraint),\n        connectiveFromAST(\"Conjunction\", constConstraintTrue))\n\n    case AST.ASTKinds.Otherwise:\n      return { type: \"Otherwise\" }\n\n    case AST.ASTKinds.Or:\n      const flatten = (head: AST.Constraint, ...items: ReadonlyArray<AST.Constraint>) : readonlyNonEmptyArray.ReadonlyNonEmptyArray<AST.Constraint> =>\n        head.kind === AST.ASTKinds.Or\n        ? flatten(head.left, head.right, ...items)\n        : pipe(items,\n            readonlyNonEmptyArray.fromReadonlyArray,\n            option.fold(\n              () => [head],\n              items => [head, ...flatten(items[0], ...items.slice(1))]))\n      return pipe(\n        flatten(c.left, c.right),\n        connectiveFromAST(\"Disjunction\", constConstraintFalse))\n\n    case AST.ASTKinds.Not:\n      return {\n        type: \"Negation\",\n        constraint: constraintFromAST(c.constraint)\n      }\n\n    case AST.ASTKinds.OtherBid:\n      return {\n        type: \"OtherBid\",\n        bid: {\n          level: c.level.value,\n          strain: strainFromAST(c.strain)\n        }\n      }\n\n    case AST.ASTKinds.PointRange:\n      return {\n        type: \"PointRange\",\n        min: c.lower.value,\n        max: c.upper.value\n      }\n\n    case AST.ASTKinds.PointBound:\n      return {\n        type: \"PointRange\",\n        min: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('min'), option.getOrElse(constant(0))),\n        max: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('max'), option.getOrElse(constant(37))),\n      }\n\n    case AST.ASTKinds.SuitRange:\n      return {\n        type: \"SuitRange\",\n        min: c.lower.value,\n        max: c.upper.value,\n        suit: suitSpecifierFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitComparison:\n      return {\n        type: \"SuitComparison\",\n        op: c.op.v as SuitComparisonOperator,\n        left: suitFromAST(c.left),\n        right: suitFromAST(c.right)\n      }\n\n    case AST.ASTKinds.Primary:\n    case AST.ASTKinds.Secondary:\n      return {\n        type: `Suit${c.kind}`,\n        suit: suitFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitBound:\n      return {\n        type: \"SuitRange\",\n        min: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('min'), option.getOrElse(constant(0))),\n        max: pipe(bindValueFromASTQualifier(c.qualifier, c.value.value)('max'), option.getOrElse(constant(13))),\n        suit: suitSpecifierFromAST(c.suit)\n      }\n\n    case AST.ASTKinds.SuitHonors:\n      return {\n        type: \"SuitHonors\",\n        suit: suitFromAST(c.suit),\n        honors: pipe(c.honors,\n          readonlyArray.fromArray,\n          readonlyArray.traverse(option.Applicative)(flow(h => h.v, rankFromString)),\n          option.getOrElseW(() => []))\n      }\n\n    case AST.ASTKinds.SuitTop:\n      return {\n        type: \"SuitTop\",\n        suit: suitFromAST(c.suit),\n        count: parseInt(c.x),\n        minRank: ranks[ranks.length - parseInt(c.y)]\n      }\n\n    case AST.ASTKinds.AnyShape:\n      return {\n        type: \"AnyShape\",\n        counts: pipe(c.v, string.split(''), readonlyArray.map(parseInt)) as [number, number, number, number]\n      }\n\n    case AST.ASTKinds.SpecificShape:\n      return {\n        type: \"SpecificShape\",\n        suits: pipe(zeroSpecificShape, readonlyRecord.mapWithIndex((s, _) => c[s].value))\n      }\n\n    case AST.ASTKinds.Relay:\n      return {\n        type: \"Relay\",\n        bid: {\n          level: c.bid.level.value,\n          strain: strainFromAST(c.bid.strain)\n        }\n      }\n    \n    default:\n      return { type: c.kind }\n  }\n}\n\nexport const bidFromAST = (bid: AST.Bid): Bid => {\n  switch (bid.kind) {\n    case AST.ASTKinds.ContractBid:\n      return {\n        level: bid.level.value,\n        strain: strainFromAST(bid.specifier as AST.Strain),\n      }\n    case AST.ASTKinds.Pass:\n      return \"Pass\"\n    default:\n      return assertUnreachable(bid)\n  }\n}\n\nexport const constrainedBidFromAST = (bidSpec: AST.BidSpec) : ConstrainedBid => ({\n  bid: bidFromAST(bidSpec.bid),\n  constraint: pipe(\n    bidSpec.constraints?.constraints,\n    option.fromNullable,\n    option.fold(() => [], readonlyArray.map(c => c.constraint)),\n    connectiveFromAST(\"Conjunction\", constConstraintFalse))\n})\n\nexport const parseBid = AST.parse\n","import { ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlySet, readonlyTuple, string } from 'fp-ts';\nimport { Right } from 'fp-ts/lib/Either';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport * as e from 'io-ts/Encoder';\nimport { Board, directions, ordDirection } from '../model/bridge';\nimport { Card, eqCard, getOrdGroupedHand, groupHandBySuits, Hand, ordRankDescending, Rank, RankC, Suit, suits } from '../model/deck';\nimport * as AST from '../parse/hand.peg.g';\n\n\nconst suitFromAST = (hand: AST.Hand) => (suit: Suit) : ReadonlyArray<Card> =>\n  pipe(hand[suit].cards,\n    readonlyArray.map(card => ({ suit, rank: (RankC.decode(card.rank) as Right<Rank>).right })))\n\nexport const handFromAST = (hand: AST.Hand) : Hand =>\n  pipe(suits,\n    readonlyArray.map(suitFromAST(hand)),\n    readonlyArray.flatten,\n    readonlySet.fromReadonlyArray(eqCard))\n\nexport const parseHand = AST.parse\n\n// PBN hand notation\nexport const handE : e.Encoder<string, Hand> = {\n  encode: flow(\n    groupHandBySuits,\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.sort(getOrdGroupedHand<ReadonlyArray<Rank>>()),\n    readonlyArray.map(flow(\n      readonlyTuple.snd,\n      readonlyArray.sort(ordRankDescending),\n      readonlyArray.reduce(\"\", (cur, rank) => cur + RankC.encode(rank)))),\n    readonlyArray.intersperse(\".\"),\n    readonlyArray.foldMap(string.Monoid)(identity))\n}\n\n// PBN board notation\nexport const boardE : e.Encoder<string, Board> = {\n  encode: ({ dealer, deal }) => pipe(deal,\n    readonlyRecord.map(handE.encode),\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.sort(ord.contramap(readonlyTuple.fst)(ordDirection)),\n    readonlyArray.rotate(directions.indexOf(dealer)),\n    readonlyArray.map(readonlyTuple.snd),\n    readonlyArray.intersperse(\" \"),\n    readonlyArray.prepend(dealer + \":\"),\n    readonlyNonEmptyArray.concatAll(string.Semigroup))\n}","import { either, option, readonlyArray, readonlyNonEmptyArray as RNEA } from 'fp-ts';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport * as d from 'io-ts/Decoder';\nimport * as DE from 'io-ts/lib/DecodeError';\nimport * as FS from 'io-ts/lib/FreeSemigroup';\n\nimport { constrainedBidFromAST, parseBid } from './bid';\nimport { handFromAST, parseHand } from './hand';\n\nexport interface PosInfo {\n  readonly overallPos: number;\n  readonly line: number;\n  readonly offset: number;\n}\nexport interface RegexMatch {\n  readonly kind: \"RegexMatch\";\n  readonly negated: boolean;\n  readonly literal: string;\n}\nexport type EOFMatch = { kind: \"EOF\"; negated: boolean };\nexport type MatchAttempt = RegexMatch | EOFMatch;\ninterface SyntaxErr {\n  pos: PosInfo;\n  expmatches: MatchAttempt[];\n  toString(): string\n}\ninterface ParseResult<T> {\n  ast: T | null;\n  errs: SyntaxErr[];\n}\n// above is generalized from generated tsPEG code\n\nconst convertErrors = (errs: ReadonlyArray<readonly [string, SyntaxErr]>): d.DecodeError =>\n  pipe(errs,\n    RNEA.fromReadonlyArray,\n    option.fold(constant(d.error(null, \"No syntax errors reported\")),\n      RNEA.foldMap(FS.getSemigroup<DE.DecodeError<string>>())(([actual, err]) =>\n        FS.of(DE.key(actual, \"required\",\n          FS.of(DE.index(err.pos.offset, \"required\",\n            pipe(err.expmatches,\n              RNEA.fromReadonlyArray,\n              option.fold(constant(FS.of(DE.leaf(actual, \"\"))),\n                RNEA.foldMapWithIndex(FS.getSemigroup<DE.DecodeError<string>>())((i, x)=>\n                  FS.of(DE.leaf(actual.substring(err.pos.offset), x.kind === \"EOF\" ? \"EOF\" : `${x.negated ? 'not ': ''}'${x.literal}'`))))))))))))\n\nconst parseResultToEither = <T>(result: ParseResult<T>) =>\n  either.fromNullable(result.errs)(result.ast)\n\nconst getDecoder = <T>(parser: (input: string) => ParseResult<T>) : d.Decoder<string, T> =>\n  pipe(\n    d.string,\n    d.parse(input => pipe(input,\n      parser,\n      parseResultToEither,\n      either.mapLeft(flow(\n        readonlyArray.map(x => [input, x] as const),\n        convertErrors)))))\n\nexport const decodeBid = flow(\n  getDecoder(parseBid).decode,\n  either.map(x => constrainedBidFromAST(x.spec)))\n\nexport const decodeHand = flow(\n  getDecoder(parseHand).decode,\n  either.map(x => handFromAST(x.hand)))","import { readonlyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { from, Observable } from 'rxjs';\n\nexport const maxProcessors = Math.max(window.navigator.hardwareConcurrency - 2, 1)\n\nexport const parallelize = <T>(make: (concurrency: number) => (idx: number) => Observable<T>) : Observable<Observable<T>> =>\n  pipe(\n    maxProcessors,\n    make,\n    f => readonlyArray.makeBy(maxProcessors, f),\n    t => from(t))","/* eslint-disable import/no-webpack-loader-syntax */\n\nimport DDSWorker from 'comlink-loader!./dds.worker'; // inline loader\nimport DealWorker from 'comlink-loader!./deal.worker'; // inline loader\nimport { readonlyArray, readonlyNonEmptyArray } from 'fp-ts';\nimport { observable } from 'fp-ts-rxjs';\nimport { pipe } from 'fp-ts/lib/function';\nimport { from, Observable, repeat, take } from 'rxjs';\nimport { parallelize } from '../lib/concurrency';\nimport { SerializedBoard } from '../model/serialization';\nimport { DoubleDummyResult } from './dds.worker';\n\n\nconst observeBatchedDealsInfinite = (batchSize: number) => {\n  const w = new DealWorker()\n  return pipe(() => w.genDeals(batchSize),\n    observable.fromTask).pipe(\n      repeat())\n}\n\nexport const observeDealsSerial = (count: number) => pipe(\n  observeBatchedDealsInfinite(Math.ceil(Math.log(count))),\n  observable.chain(x => from(x))).pipe(\n    take(count))\n\nexport const observeDealsParallel = (count: number) =>\n  parallelize(concurrency => {\n    const perWorker = Math.floor(count / concurrency)\n    const remainder = Math.floor(count % concurrency)\n    return idx => observeDealsSerial(idx === 0\n      ? perWorker + remainder\n      : perWorker)\n  })\n\nexport const observeResultsSerial = (boards: ReadonlyArray<SerializedBoard>): Observable<DoubleDummyResult> => {\n  const w = new DDSWorker()\n  return pipe(from(boards),\n    observable.chain(board => from(w.getResult(board))))\n}\n\nexport const observeResultsParallel = (boards: readonlyNonEmptyArray.ReadonlyNonEmptyArray<SerializedBoard>) =>\n  parallelize(concurrency => {\n    const perWorker = Math.floor(boards.length / concurrency)\n    const remainder = Math.floor(boards.length % concurrency)\n    return idx => observeResultsSerial(idx === concurrency - 1\n      ? pipe(boards, readonlyArray.takeRight(perWorker + remainder))\n      : pipe(boards.slice(idx * perWorker, (idx + 1) * perWorker)))\n    })","import { either, option, predicate, readonlyArray, readonlyNonEmptyArray, readonlySet, separated } from 'fp-ts';\nimport { observable } from 'fp-ts-rxjs';\nimport { tailRec } from 'fp-ts/lib/ChainRec';\nimport { constFalse, constTrue, flow, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\nimport { WritableDraft } from 'immer/dist/internal';\nimport memoize from 'proxy-memoize';\nimport { O } from 'ts-toolbelt';\n\nimport { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { Board, deal, getHcp } from '../model/bridge';\nimport { satisfiesPath } from '../model/constraints';\nimport { eqCard, Hand, newDeck, ordCardDescending } from '../model/deck';\nimport { DecodedHand, DecodedSerializedHand, decodedSerializedHandL, serializedBoardL, SerializedHand, serializedHandL } from '../model/serialization';\nimport { BidPath } from '../model/system';\nimport { decodeHand } from '../parse';\nimport { observeResultsSerial } from '../workers';\nimport { DoubleDummyResult } from '../workers/dds.worker';\n\nconst name = 'selection'\n\ninterface State {\n  selectedBlockKey: option.Option<string>\n  opener?: DecodedSerializedHand\n  responder?: DecodedSerializedHand\n  result?: DoubleDummyResult\n}\nexport type AuctionPositionType = O.SelectKeys<State, DecodedHand>\n\nconst initialState : State = {\n  selectedBlockKey: option.none\n}\n\ninterface Hands {\n  opener: SerializedHand\n  responder: SerializedHand\n}\n\nconst setHands = (state: WritableDraft<State>) => (hands: readonly [Hand, Hand]) => {\n  const [opener, responder] = hands\n  state.opener = pipe(opener, either.right, decodedSerializedHandL.get, castDraft)\n  state.responder = pipe(responder, either.right, decodedSerializedHandL.get, castDraft)\n}\n\nconst genBoardFromHands = (opener: Hand, responder: Hand) =>\n  pipe(newDeck(),\n    readonlyArray.difference(eqCard)(pipe(opener, readonlySet.toReadonlyArray(ordCardDescending))),\n    readonlyArray.difference(eqCard)(pipe(responder, readonlySet.toReadonlyArray(ordCardDescending))),\n    readonlyArray.chunksOf(13),\n    readonlyArray.map(readonlySet.fromReadonlyArray(eqCard)),\n    ([l, r]) : Board => ({\n      dealer: 'N',\n      deal: {\n        N: opener,\n        S: responder,\n        E: l,\n        W: r\n      }\n    }))\n\nconst getResult = createAsyncThunk('abc', ({ opener, responder}: Hands) =>\n  pipe(\n    genBoardFromHands(serializedHandL.reverseGet(opener), serializedHandL.reverseGet(responder)),\n    serializedBoardL.get,\n    readonlyNonEmptyArray.of,\n    observeResultsSerial,\n    observable.toTask,\n    t => t()))\n\nconst genUntilCondition = (limit: option.Option<number>) => (condition: predicate.Predicate<readonly [Hand, Hand]>) =>\n  tailRec(limit, l => {\n    if (pipe(l, option.fold(constFalse, i => i === 0))) {\n      return either.right(option.none)\n    } else {\n      const d = deal(newDeck())\n      const hands = [d.N, d.S] as const\n      const result = condition(hands)\n      return result\n        ? either.right(option.some(hands))\n        : either.left(pipe(l, option.map(i => i - 1)))\n    }\n  })\n\nconst genMatchingOf = (length: predicate.Predicate<number>) => (paths: readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>) =>\n  genUntilCondition(option.some(10000))(hands =>\n    pipe(paths,\n      readonlyArray.partition(satisfiesPath(...hands)),\n      separated.right,\n      x => length(x.length)))\n\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setSelectedBlockKey: (state, action: PayloadAction<option.Option<string>>) => {\n      state.selectedBlockKey = action.payload\n    },\n    setHand: {\n      reducer: (state, action: PayloadAction<string, string, AuctionPositionType>) => {\n        state[action.meta] = pipe(action.payload, decodeHand, decodedSerializedHandL.get, castDraft)\n      },\n      prepare: (payload, meta) => ({ payload, meta })\n    },\n    genOnce: (state) => {\n      pipe(\n        genUntilCondition(option.none)(constTrue),\n        option.map(setHands(state)))\n    },\n    getHandsMatchingPath: (state, action: PayloadAction<BidPath>) => {\n      pipe(\n        genUntilCondition(option.some(10000))(hands =>\n          satisfiesPath(...hands)(action.payload)),\n        option.map(setHands(state)))\n    },\n    genHandsNotMatchingAnyOf: {\n      reducer: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>, string, number>) => {\n        pipe(\n          genUntilCondition(option.some(10000))(hands =>\n            getHcp(hands[0]) >= action.meta\n            && pipe(action.payload, readonlyArray.every(predicate.not(satisfiesPath(...hands))))),\n          option.map(setHands(state)))\n      },\n      prepare: (payload: readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>, openerMinHcp: number) =>\n        ({ payload, meta: openerMinHcp })\n    },\n    genHandsMatchingExactlyOneOf: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>>) => {\n      pipe(\n        genMatchingOf(l => l === 1)(action.payload),\n        option.map(setHands(state)))\n    },\n    genHandsMatchingMoreThanOneOf: (state, action: PayloadAction<readonlyNonEmptyArray.ReadonlyNonEmptyArray<BidPath>>) => {\n      pipe(\n        genMatchingOf(l => l > 1)(action.payload),\n        option.map(setHands(state)))\n    }\n  },\n  extraReducers: builder => builder\n    .addCase(getResult.fulfilled, (state, action) => {\n      state.result = pipe(action.payload, castDraft)\n    })\n  })\n\n\nexport const { setSelectedBlockKey, setHand, genOnce, getHandsMatchingPath, genHandsNotMatchingAnyOf, genHandsMatchingExactlyOneOf, genHandsMatchingMoreThanOneOf } = slice.actions\nexport { getResult };\n\nexport default slice.reducer\n\nexport const selectBlockKey = memoize((state: State) =>\n  pipe(state.selectedBlockKey,\n    option.toNullable))\n\nexport const selectHand = memoize(({ state, type } : {state: State, type: AuctionPositionType}) : option.Option<Hand> =>\n  pipe(state[type],\n    option.fromNullable,\n    option.chain(flow(decodedSerializedHandL.reverseGet, option.fromEither))))","import { either, eq, option as O, readonlyArray as RA, readonlyNonEmptyArray as RNEA, string, tree } from 'fp-ts';\nimport { flow, identity, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\nimport memoize from 'proxy-memoize';\n\nimport { createEntityAdapter, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { validateTree } from '../model/constraints';\nimport { BidTree, flatten, getAllLeafPaths, getBidInfo, getPathUpTo, withImplicitPasses } from '../model/system';\nimport { decodeBid } from '../parse';\n\ntype BlockKey = string\nconst eqBlockKey : eq.Eq<BlockKey> = string.Eq\n\nexport type DecodedBid = ReturnType<typeof decodeBid>\ninterface ConstrainedBidItem {\n  id: BlockKey\n  value: DecodedBid\n}\nconst constrainedBidAdapter = createEntityAdapter<ConstrainedBidItem>()\n\ntype BlockTree = tree.Forest<BlockKey>\ninterface State {\n  system: BlockTree\n  constrainedBids: ReturnType<typeof constrainedBidAdapter.getInitialState>\n}\n\nconst initialState: State = {\n  system: [],\n  constrainedBids: constrainedBidAdapter.getInitialState()\n}\n\nexport interface BlockKeyDescriptor {\n  key: BlockKey\n  depth: number\n}\nconst buildForest = (items: ReadonlyArray<BlockKeyDescriptor>): BlockTree => {\n  const root = tree.make<BlockKey>(\"ROOT\")\n  var parents = [root]\n  items.forEach(item => {\n    const curr = parents[item.depth + 1] = {\n      forest: [],\n      value: item.key\n    }\n    parents[item.depth].forest.push(curr)\n  })\n  return root.forest\n}\n\nexport interface BlockItem {\n  key: string\n  text: string\n}\n\nconst name = 'system'\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setSystem: (state, action: PayloadAction<ReadonlyArray<BlockKeyDescriptor>>) => {\n      state.system = pipe(buildForest(action.payload), castDraft)\n    },\n    removeConstraintsByBlockKey: (state, action: PayloadAction<RNEA.ReadonlyNonEmptyArray<BlockKey>>) => {\n      constrainedBidAdapter.removeMany(state.constrainedBids, action.payload)\n    },\n    cacheSystemConstraints: (state, action: PayloadAction<RNEA.ReadonlyNonEmptyArray<BlockItem>>) => {\n      constrainedBidAdapter.setMany(state.constrainedBids, pipe(\n        action.payload,\n        RNEA.map(i => ({ id: i.key, value: decodeBid(i.text) }))))\n    }\n  }\n})\n\nexport const { setSystem, removeConstraintsByBlockKey, cacheSystemConstraints } = slice.actions\n\nconst constrainedBidSelectors = constrainedBidAdapter.getSelectors()\n\ninterface KeyedState {\n  state: State\n  key: BlockKey\n}\n\nexport const selectPathUpToKey = memoize(({ state, key }: KeyedState) =>\n  pipe(state.system,\n    getPathUpTo(eqBlockKey)(key)))\n\nconst getCachedBidByKey = (constrainedBids: State['constrainedBids']) => (key: BlockKey) =>\n  pipe(\n    O.fromNullableK(constrainedBidSelectors.selectById)(constrainedBids, key),\n    O.map(i => i.value))\n\nexport const selectBidByKey = memoize(({ state, key }: KeyedState) =>\n  pipe(key,\n    getCachedBidByKey(state.constrainedBids),\n    O.chain(O.fromEither)))\n\nexport const selectBidPathUpToKey = memoize(({ state, key }: KeyedState) =>\n  pipe(\n    state.system,\n    getPathUpTo(eqBlockKey)(key),\n    O.getOrElse(() => RA.zero()),\n    RA.filterMap(getCachedBidByKey(state.constrainedBids)),\n    RA.sequence(either.Applicative)))\n\nexport const selectRules = memoize((state: State) =>\n  pipe(state.system,\n    flatten,\n    RA.filterMap(getCachedBidByKey(state.constrainedBids))))\n\nexport const selectErrors = memoize(\n  flow(\n    selectRules,\n    RA.lefts))\n\nconst getCompleteForest = (constrainedBids: State['constrainedBids']) =>\n  RA.filterMap(flow(\n    tree.traverse(O.Applicative)(flow(\n      getCachedBidByKey(constrainedBids),\n      O.chain(O.fromEither)))))\n\nexport const selectCompleteBidPathUpToKey = memoize(({ state, key }: KeyedState) =>\n  pipe(state.system,\n    getPathUpTo(eqBlockKey)(key),\n    O.chain(keys => pipe(\n      tree.unfoldTree<BlockKey, ReadonlyArray<BlockKey>>(keys, ([n0, ...ns]) =>\n        [n0, ns.length === 0 ? [] : [ns]]),\n      RA.of,\n      getCompleteForest(state.constrainedBids),\n      getBidInfo,\n      getAllLeafPaths,\n      RA.head))))\n\nexport const selectCompleteBidSubtree = memoize(({ state, options }: { state: State, options?: { implicitPass: boolean }} ): BidTree =>\n  pipe(state.system,\n    getCompleteForest(state.constrainedBids),\n    options?.implicitPass ? withImplicitPasses : identity,\n    getBidInfo))\n\nexport const selectAllCompleteBidPaths = memoize(\n  flow(selectCompleteBidSubtree,\n    getAllLeafPaths))\n\nexport const selectSystemValid = memoize(\n  flow(selectCompleteBidSubtree,\n    validateTree))\n    \nexport default slice.reducer","import 'draft-js/dist/Draft.css';\n\nimport { ContentBlock, convertFromRaw, convertToRaw, Editor as DraftJsEditor, EditorState, getDefaultKeyBinding, RichUtils } from 'draft-js';\nimport { eq, monoid, option, ord, readonlyArray, readonlyNonEmptyArray, readonlySet, string } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { selectBlockKey, setSelectedBlockKey } from '../reducers/selection';\nimport { BlockItem, BlockKeyDescriptor, cacheSystemConstraints, removeConstraintsByBlockKey, setSystem } from '../reducers/system';\n\nconst getDescriptorFromContentBlock = (x: ContentBlock): BlockKeyDescriptor & BlockItem => ({\n  key: x.getKey(),\n  text: x.getText(),\n  depth: x.getDepth()\n})\n\nconst eqContentBlock = monoid.concatAll(eq.getMonoid<ContentBlock>())([\n  eq.contramap((b: ContentBlock) => b.getKey())(string.Eq),\n  eq.contramap((b: ContentBlock) => b.getText())(string.Eq)\n])\nconst getBlocks = (editorState: EditorState) => pipe(\n  editorState.getCurrentContent().getBlocksAsArray(),\n  readonlySet.fromReadonlyArray(eqContentBlock))\n\nconst Editor = () => {\n  const [editorState, setEditorState] = useState(() => EditorState.createEmpty())\n  const [blocks, setBlocks] = useState(() => getBlocks(editorState))\n  const dispatch = useAppDispatch()\n  const selectedBlockKey = useAppSelector(state => selectBlockKey(state.selection))\n\n  const onChange = useCallback((editorState: EditorState) => {\n    setEditorState(editorState)\n    setTimeout(() => localStorage.setItem(\"editor\", JSON.stringify(convertToRaw(editorState.getCurrentContent()))), 0)\n    const newBlocks = getBlocks(editorState)\n    const same = readonlySet.intersection(eqContentBlock)(blocks, newBlocks)\n    const removed = readonlySet.difference(eqContentBlock)(blocks, same)\n    const added = readonlySet.difference(eqContentBlock)(newBlocks, same)\n    setBlocks(newBlocks)\n\n    if (!readonlySet.isEmpty(monoid.concatAll(readonlySet.getUnionMonoid<ContentBlock>(eqContentBlock))([removed, added]))) {\n      dispatch(pipe(\n        newBlocks,\n        readonlySet.toReadonlyArray<ContentBlock>(ord.trivial),\n        readonlyArray.map(getDescriptorFromContentBlock),\n        setSystem))\n      pipe(\n        removed,\n        readonlySet.toReadonlyArray<ContentBlock>(ord.trivial),\n        readonlyNonEmptyArray.fromReadonlyArray,\n        option.map(flow(\n          readonlyNonEmptyArray.map(b => b.getKey()),\n          x => dispatch(removeConstraintsByBlockKey(x)))))\n      pipe(\n        added,\n        readonlySet.toReadonlyArray<ContentBlock>(ord.trivial),\n        readonlyNonEmptyArray.fromReadonlyArray,\n        option.map(flow(\n          readonlyNonEmptyArray.map(getDescriptorFromContentBlock),\n          x => dispatch(cacheSystemConstraints(x)))))\n    }\n    \n    const newSelectedBlockKey = editorState.getSelection().getFocusKey()\n    if (newSelectedBlockKey !== selectedBlockKey) {\n      dispatch(setSelectedBlockKey(option.some(newSelectedBlockKey)))\n    }\n  }, [blocks, dispatch, selectedBlockKey])\n\n  useEffect(() => {\n    const savedEditorState = localStorage.getItem(\"editor\")\n    if (savedEditorState) {\n      setEditorState(() => EditorState.createWithContent(convertFromRaw(JSON.parse(savedEditorState))))\n    } else {\n      setEditorState(() => RichUtils.toggleBlockType(editorState, 'unordered-list-item'))\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  \n  return (\n    <DraftJsEditor\n      editorState={editorState}\n      onChange={onChange}\n      // https://github.com/facebook/draft-js/blob/master/examples/draft-0-10-0/rich/rich.html#L61\n      keyBindingFn={e => {\n        if (e.keyCode === 9 /* TAB */) {\n          const newEditorState = RichUtils.onTab(e, editorState, 10, /* maxDepth */);\n          if (newEditorState !== editorState) {\n            onChange(newEditorState)\n          }\n          return null;\n        }\n        return getDefaultKeyBinding(e);\n      }}\n    />\n  )\n}\n\nexport default Editor","import { either, eq, number, option, ord, readonlyArray, readonlyRecord, writer } from 'fp-ts';\nimport { constant, flow, identity, pipe } from 'fp-ts/lib/function';\nimport * as t from 'io-ts';\nimport { assertUnreachable } from '../lib';\nimport { Contract, ContractModifier, eqStrain, minors, Strain } from './bridge';\n\n\nexport interface ScoreInfo {\n  contract: Contract\n  tricks: number\n  isVulnerable: boolean\n}\n\ntype ScoreComponent = (info: ScoreInfo) => number\n\nconst contractPointMultiplier = (strain: Strain) => \n  pipe(minors, readonlyArray.elem(eqStrain)(strain)) ? 20 : 30\n\nconst contractModMultiplier = (modifier: ContractModifier) => {\n  switch (modifier) {\n    case \"Undoubled\": return 1\n    case \"Doubled\"  : return 2\n    case \"Redoubled\": return 4\n    default: return assertUnreachable(modifier)\n  }\n}\n\nconst contractFirstTrickModifier = (strain: Strain) =>\n  strain === \"N\" ? 10 : 0\n\nconst subtractBookTricks = (tricks: number) =>\n  tricks - 6\n\nexport const making = (contract: Contract, tricks: number) =>\n  pipe(\n    tricks,\n    subtractBookTricks,\n    either.fromPredicate(\n      oddTricks => oddTricks >= contract.level,\n      oddTricks => contract.level - oddTricks))\n\nconst getOddTricks =\n  flow(making, option.fromEither)\n\nconst getOvertricks = (contract: Contract, tricks: number) =>\n  pipe(making(contract, tricks),\n    option.fromEither,\n    option.map(oddTricks => oddTricks - contract.level))\n\nconst getUndertricks = (contract: Contract, tricks: number) =>\n  pipe(making(contract, tricks),\n    either.swap,\n    option.fromEither)\n\nconst whenMaking = (f: (oddTricks: number) => number) => (info: ScoreInfo) =>\n  pipe(getOddTricks(info.contract, info.tricks),\n    option.fold(constant(0), f))\n\nconst contractPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(() =>\n    contractModMultiplier(info.contract.modifier) *\n    ((info.contract.level * contractPointMultiplier(info.contract.strain)) + contractFirstTrickModifier(info.contract.strain))))\n\nconst vulnerableMultiplier = (isVulnerable: boolean) =>\n  50 * (isVulnerable ? 2 : 1)\n\nconst getModified = (modifier: ContractModifier) : option.Option<\"Doubled\" | \"Redoubled\"> =>\n  modifier === \"Undoubled\" ? option.none : option.some(modifier)\n\nconst overtrickBonus = (isVulnerable: boolean, modifier: ContractModifier) => \n  pipe(modifier,\n    getModified,\n    option.map(contractModMultiplier),\n    option.map(x => x * vulnerableMultiplier(isVulnerable)))\n\nconst overtrickPoints: ScoreComponent = info =>\n  pipe(getOvertricks(info.contract, info.tricks),\n    option.fold(constant(0), overtricks =>\n      pipe(\n        overtrickBonus(info.isVulnerable, info.contract.modifier),\n        option.getOrElseW(() => contractPointMultiplier(info.contract.strain)),\n        multiplier => overtricks * multiplier)))\n\nconst slamPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(oddTricks =>\n    (info.isVulnerable ? 1.5 : 1) *\n    (info.contract.level === 6 && oddTricks >= 6 ? 500 :\n      info.contract.level === 7 && oddTricks >= 7 ? 1000 : 0)))\n\nconst modifierPoints: ScoreComponent = info =>\n  pipe(info, whenMaking(() => {\n    switch (info.contract.modifier) {\n      case \"Undoubled\": return 0\n      case \"Doubled\"  : return 50\n      case \"Redoubled\": return 100\n      default: return assertUnreachable(info.contract.modifier)\n    }\n  }))\n\nconst doubledPenalties = [100, 200, 200, ...readonlyArray.replicate(10, 300)]\n\nconst penaltyPoints: ScoreComponent = info =>\n  pipe(getUndertricks(info.contract, info.tricks),\n    option.fold(constant(0), undertricks =>\n      pipe(info.contract.modifier,\n        getModified,\n        option.fold(\n          () => undertricks * vulnerableMultiplier(info.isVulnerable),\n          flow(contractModMultiplier,\n            multiplier => (multiplier / 2) * pipe(\n              doubledPenalties,\n              readonlyArray.takeLeft(undertricks + (info.isVulnerable ? 1 : 0)),\n              readonlyArray.foldMap(number.MonoidSum)(identity)))),\n        x => -x)))\n\nconst partScorePoints: ScoreComponent =\n  flow(contractPoints, score =>\n    score > 0 && score <= 100 ? 50 : 0)\n\nconst gamePoints: ScoreComponent = info =>\n  pipe(info, contractPoints, score =>\n    score >= 100 ? (info.isVulnerable ? 500 : 300) : 0)\n\nconst scoreComponents : readonlyRecord.ReadonlyRecord<string, ScoreComponent> = {\n  contractPoints : contractPoints,\n  overtrickPoints: overtrickPoints,\n  slamPoints     : slamPoints,\n  modifierPoints : modifierPoints,\n  penaltyPoints  : penaltyPoints,\n  partScorePoints: partScorePoints,\n  gamePoints     : gamePoints,\n}\n\nconst ScoreC = t.brand(t.number, (i) : i is t.Branded<number, { readonly Score: unique symbol }> => typeof i === \"number\", 'Score')\nexport type Score = t.TypeOf<typeof ScoreC>\nexport const zeroScore = (ScoreC.decode(0) as either.Right<Score>).right\nexport const eqScore : eq.Eq<Score> = number.Eq\nexport const ordScore : ord.Ord<Score> = pipe(number.Ord, ord.reverse)\n\nexport type ScoreComponentLog = readonly [string, number]\n\ntype W = ReadonlyArray<ScoreComponentLog>\nexport const scoreW = (info: ScoreInfo): writer.Writer<W, Score> => \n  pipe(\n    scoreComponents,\n    readonlyRecord.flap(info),\n    readonlyRecord.traverseWithIndex(writer.getApplicative(readonlyArray.getMonoid<ScoreComponentLog>()))((name, score) => pipe(\n      writer.tell([[name, score]] as const),\n      writer.map(constant(score)))),\n    writer.map(flow(\n      readonlyRecord.foldMap(ord.trivial)(number.MonoidSum)(identity),\n      ScoreC.decode,\n      s => (s as either.Right<Score>).right)),\n    writer.map((s): [Score, (w: W) => W] => [s, cs => [[\"TOTAL\", s], ...cs]]),\n    writer.pass)\n\nexport const score = flow(scoreW, writer.evaluate)","import { either, eitherT, option, readonlyArray, readonlyMap, readonlyNonEmptyArray as RNEA, readonlyRecord as RR, readonlyTuple, refinement, semigroup } from 'fp-ts';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport { ordAscending, ordDescending } from '../lib';\nimport { ContractBid, contractBids, ContractModifier, Direction, getIsVulnerable, ordContractBid, Strain, Vulnerability } from './bridge';\nimport { eqScore, making, ordScore, Score, score, zeroScore } from './score';\n\n\nexport type TrickCountsByStrain = RR.ReadonlyRecord<Strain, number>\nexport type TrickCountsByDirection = RR.ReadonlyRecord<Direction, number>\nexport type TrickCountsByStrainThenDirection = RR.ReadonlyRecord<Strain, TrickCountsByDirection>\nexport type TrickCountsByDirectionThenStrain = RR.ReadonlyRecord<Direction, TrickCountsByStrain>\n\nexport const flattenNestedCounts = <K1 extends string, K2 extends string, T>(table: RR.ReadonlyRecord<K1, RR.ReadonlyRecord<K2, T>>) =>\n  pipe(readonlyArray.Do,\n    readonlyArray.apS('inner', pipe(table, RR.toReadonlyArray)),\n    readonlyArray.bind('outer', ({ inner }) => pipe(inner[1], RR.toReadonlyArray)),\n    readonlyArray.map(({ outer, inner }) => ({ outerKey: outer[0], innerKey: inner[0], value: outer[1] })))\n\nexport const transpose = <K1 extends string, K2 extends string, T>(table: RR.ReadonlyRecord<K1, RR.ReadonlyRecord<K2, T>>) : RR.ReadonlyRecord<K2, RR.ReadonlyRecord<K1, T>> =>\n  pipe(table,\n    flattenNestedCounts,\n    RNEA.fromReadonlyArray,\n    option.fold(() => ({}),\n    RNEA.groupBy(x => x.outerKey)),\n    RR.map(flow(\n      RNEA.fromReadonlyArray,\n      option.fold(() => ({}),\n      RNEA.groupBy(x => x.innerKey)),\n      RR.map(x => x[0].value))))\n\n\ntype OptimalBid = ContractBid | \"Pass\"\nconst initialContractBid: refinement.Refinement<OptimalBid, ContractBid> = (b): b is ContractBid => b !== \"Pass\"\nconst initialBids = pipe(\n  contractBids,\n  readonlyArray.sort(ordContractBid),\n  readonlyArray.prepend<OptimalBid>(\"Pass\"))\nconst ordInitialBidsAscending = ordAscending(initialBids)\nconst ordInitialBidsDescending = ordDescending(initialBids)\n\ntype ContractScorePair = readonly [OptimalBid, Score]\nconst getDirectionScores = (counts: TrickCountsByStrain) => (isVulnerable: boolean) =>\n  pipe(initialBids,\n    readonlyArray.map(either.fromPredicate(initialContractBid, () => \"Pass\" as const)),\n    eitherT.match(readonlyArray.Functor)(\n      (pass): ContractScorePair => [pass, zeroScore],\n      (bid): ContractScorePair => {\n        const tricks = counts[bid.strain]\n        const modifier: ContractModifier = pipe(\n          making({ ...bid, modifier: \"Undoubled\" }, tricks),\n          either.fold(constant(\"Doubled\"), constant(\"Undoubled\")))\n        return [bid, score({ contract: { ...bid, modifier}, tricks, isVulnerable })]\n      }))\n\nconst getAllScores = (table: TrickCountsByDirectionThenStrain) => (vulnerability: Vulnerability) =>\n  pipe(table,\n    RR.mapWithIndex((direction, counts) =>\n      getDirectionScores(counts)(getIsVulnerable(direction, vulnerability))))\n\n// const byContractDescending : ord.Ord<ContractScorePair> =\n//   ord.contramap(readonlyTuple.fst)(ordInitialBidsDescending)\n\nconst shakeContracts = (contractScorePairs: RNEA.ReadonlyNonEmptyArray<ContractScorePair>) =>\n  pipe(contractScorePairs,\n    RNEA.map(readonlyTuple.swap),\n    readonlyMap.fromFoldable(eqScore, semigroup.max(ordInitialBidsDescending), RNEA.Foldable),\n    readonlyMap.toReadonlyArray(ordScore))\n\nconst pvs = (direction: Direction, availableMoves: RNEA.ReadonlyNonEmptyArray<ContractScorePair>): OptimalBid => \"Pass\"\n\nexport interface IndependentVariables {\n  dealer: Direction\n  vulnerability: Vulnerability\n}\nexport const parScore = (table: TrickCountsByStrainThenDirection) => (vars: IndependentVariables): Score => zeroScore\n","import { either, option, ord, readonlyArray, readonlyRecord, readonlySet, readonlyTuple, semigroup, task, taskEither } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { Encoder } from 'io-ts/lib/Encoder';\nimport { Uuid } from 'uuid-tool';\nimport { TrickCountsByDirectionThenStrain, TrickCountsByStrain } from '../model/analyze';\nimport { Deal, Direction, directions, getHandSpecificShape, getHcp, SpecificShape } from '../model/bridge';\nimport { Card, ordCardDescending } from '../model/deck';\n\n\n// const Uuid = t.brand(t.string, (s: string): s is t.Branded<string, { readonly Uuid: unique symbol }> => validate(s), 'Uuid')\n// type Uuid = t.TypeOf<typeof Uuid>\n\ntype CardDirectionPair = readonly [Card, number]\nconst encode: Encoder<Uuid, Deal> = {\n  encode: flow(\n      readonlyRecord.foldMapWithIndex(ord.trivial)(readonlyArray.getMonoid<CardDirectionPair>())((direction, cards) =>\n        pipe(cards,\n          readonlySet.toReadonlyArray<Card>(ord.trivial),\n          readonlyArray.map(c => [c, directions.indexOf(direction)]))),\n      readonlyArray.sort(ord.contramap((p: CardDirectionPair) => p[0])(ordCardDescending)),\n      readonlyArray.map(readonlyTuple.snd),\n      readonlyArray.chunksOf(4),\n      readonlyArray.map(readonlyArray.reduce(0, (byte, directionIndex) => (byte << 2) + directionIndex)),\n      readonlyArray.concat(readonlyArray.replicate(3, 0)),\n      readonlyArray.toArray,\n      x => new Uuid(x))\n}\n\nconst baseUrl = process.env.REACT_APP_API_URL\n\nconst safeFetch = (t: task.Task<Response>) =>\n  taskEither.tryCatchK(t, either.toError)()\n\nexport const ping =\n  pipe(() => fetch(`${baseUrl}/ping`),\n    safeFetch,\n    taskEither.chainTaskK(response => () => response.text()),\n    taskEither.filterOrElse(response => response === \"pong\", () => new Error(\"'pong' was not received\")))\n\ninterface DirectionMetadata {\n  hcp: number\n  shape: SpecificShape\n  tricks?: TrickCountsByStrain\n}\n\ntype DealWithSolution = readonly [Deal, option.Option<TrickCountsByDirectionThenStrain>]\n\nconst getRequestBody =\n  readonlyArray.foldMap(readonlyRecord.getUnionMonoid(semigroup.first<Detail>()))(([deal, table]: DealWithSolution) => ({\n    [encode.encode(deal).toString()]: pipe(deal,\n      readonlyRecord.mapWithIndex((d, h): DirectionMetadata => ({\n        hcp: getHcp(h),\n        shape: getHandSpecificShape(h),\n        tricks: pipe(table, option.map(t => t[d]), option.toUndefined)\n      })))\n    }))\n\nconst getRequestBodyWithoutSolution =\n  flow(\n    readonlyArray.map((deal: Deal) => ([deal, option.none] as const)),\n    getRequestBody)\n\ntype Detail = readonlyRecord.ReadonlyRecord<Direction, DirectionMetadata>\nexport const postDeals = (deals: ReadonlyArray<Deal>) =>\n  pipe(deals,\n    getRequestBodyWithoutSolution,\n    JSON.stringify,\n    task.of,\n    task.chain(body => () =>\n      fetch(`${baseUrl}/deals`, {\n        method: \"POST\",\n        body\n      })),\n    safeFetch)\n\nexport const putDeals = (deals: ReadonlyArray<DealWithSolution>) =>\n  pipe(deals,\n    getRequestBody,\n    JSON.stringify,\n    task.of,\n    task.chain(body => () =>\n      fetch(`${baseUrl}/deals`, {\n        method: \"PUT\",\n        body\n      })),\n    safeFetch)\n\nexport const postDeal = (deal: Deal) => postDeals([deal])","import { magma, number, option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { observable, observableEither } from 'fp-ts-rxjs';\nimport { constant, flow, pipe } from 'fp-ts/lib/function';\nimport { castDraft } from 'immer';\nimport memoize from 'proxy-memoize';\nimport { Epic } from 'redux-observable';\nimport { bufferCount, concatWith, EMPTY, filter, from } from 'rxjs';\n\nimport { AnyAction, createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { RootState } from '../app/store';\nimport { maxProcessors } from '../lib/concurrency';\nimport { transpose } from '../model/analyze';\nimport { makeBoard } from '../model/bridge';\nimport { SerializedBidPath, serializedBidPathL, serializedBoardL, SerializedDeal, serializedDealL } from '../model/serialization';\nimport { BidPath } from '../model/system';\nimport { ping, postDeals, putDeals } from '../services/server';\nimport { observeDealsParallel, observeDealsSerial, observeResultsParallel, observeResultsSerial } from '../workers';\nimport { DoubleDummyResult } from '../workers/dds.worker';\n\nconst name = 'generator'\n\ntype Deals = ReadonlyArray<SerializedDeal>\ntype Results = readonlyRecord.ReadonlyRecord<SerializedBidPath, readonlyNonEmptyArray.ReadonlyNonEmptyArray<DoubleDummyResult>>\ntype Progress<T> = readonly [T, number]\n\nconst getProgress = <T>(a: T): Progress<T> => [a, 0]\nconst updateProgress = <T>(M: magma.Magma<T>) => (decrement: number) => (payload: T) => (progress: Progress<T>): Progress<T> =>\n  pipe(progress,\n    readonlyTuple.bimap(p => p - decrement, current => M.concat(current, payload)))\ninterface State {\n  deals: Progress<Deals>\n  results: Progress<Results>\n  working: boolean\n}\nconst initialState: State = {\n  deals: getProgress([]),\n  results: getProgress({}),\n  working: false\n}\n\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    generate: (state, action: PayloadAction<number>) => {\n      state.deals = pipe(state.deals, readonlyTuple.mapSnd(constant(action.payload)), castDraft)\n      state.working = true\n    },\n    getResults: (state, action: PayloadAction<{ path: BidPath, deals: Deals }>) => {\n      state.results = pipe(state.results, readonlyTuple.mapSnd(constant(action.payload.deals.length)), castDraft)\n      state.working = true\n    },\n    reportDeals: (state, action: PayloadAction<Deals>) => {\n      state.deals = pipe(state.deals,\n        updateProgress\n          (readonlyArray.getSemigroup<SerializedDeal>())\n          (action.payload.length)\n          (action.payload),\n        castDraft)\n    },\n    reportResults: (state, action: PayloadAction<Results>) => {\n      state.results = pipe(state.results,\n        updateProgress\n          (readonlyRecord.getUnionSemigroup(readonlyNonEmptyArray.getSemigroup<DoubleDummyResult>()))\n          (pipe(action.payload,\n            readonlyRecord.toReadonlyArray,\n            readonlyArray.foldMap(number.MonoidSum)(([_, values]) => values.length)))\n          (action.payload),\n        castDraft)\n    },\n    done: (state) => {\n      state.working = false\n    }\n  }\n})\n\nexport const { generate, getResults, reportDeals, reportResults, done } = slice.actions\nexport default slice.reducer\n\ntype E = Epic<AnyAction, AnyAction, RootState>\nexport const analyzeDealsEpic : E = (action$, state$) =>\n  action$.pipe(\n    filter(generate.match),\n    observable.map(a => a.payload),\n    observable.chain(flow(\n      count => count > maxProcessors\n        ? pipe(observeDealsParallel(count), observable.flatten)\n        : observeDealsSerial(count),\n      bufferCount(1000),\n      observable.map(reportDeals),\n      concatWith([done()]))))\n\nexport const analyzeResultsEpic : E = (action$, state$) =>\n  action$.pipe(\n    filter(getResults.match),\n    observable.chain(a =>\n      pipe(\n        a.payload.deals,\n        readonlyArray.mapWithIndex((i, d) =>\n          pipe(d,\n            serializedDealL.reverseGet,\n            makeBoard(i + 1),\n            serializedBoardL.get)),\n        readonlyNonEmptyArray.fromReadonlyArray,\n        option.fold(() => from([]),\n          boards =>\n            a.payload.deals.length > maxProcessors\n            ? pipe(boards, observeResultsParallel, observable.flatten)\n            : pipe(boards, observeResultsSerial)),\n        bufferCount(5),\n        observable.map(flow(\n          readonlyNonEmptyArray.fromReadonlyArray,\n          option.fold(\n            () => reportResults({}),\n            results => pipe(\n              a.payload.path,\n              readonlyNonEmptyArray.map(a => a.bid ),\n              serializedBidPathL.get,\n              path => reportResults(({ [path]: results })))))),\n        concatWith([done()]))))\n\nexport const saveDealsToApiEpic: Epic<AnyAction> = (action$, state$) =>\n  action$.pipe(\n    filter(reportDeals.match),\n    observable.map(a => a.payload),\n    observableEither.fromObservable,\n    observableEither.chainFirst(() => pipe(ping, observableEither.fromTaskEither)),\n    observableEither.chainFirst(flow(\n      readonlyArray.map(serializedDealL.reverseGet),\n      postDeals,\n      observableEither.fromTaskEither)),\n    observable.chain(_ => EMPTY))\n\nexport const saveSolutionsToApiEpic: Epic<AnyAction> = (action$, state$) =>\n  action$.pipe(\n    filter(reportResults.match),\n    observable.map(a => a.payload),\n    observableEither.fromObservable,\n    observableEither.chainFirst(() => pipe(ping, observableEither.fromTaskEither)),\n    observableEither.chainFirst(flow(\n      readonlyRecord.toReadonlyArray,\n      readonlyArray.chain(readonlyTuple.snd),\n      readonlyArray.map(x => [serializedDealL.reverseGet(x.board.deal), pipe(x.results, transpose, option.some)] as const),\n      putDeals,\n      observableEither.fromTaskEither)),\n    observable.chain(_ => EMPTY))    \n        \nexport const selectAllDeals = memoize((state: State) =>\n  pipe(state.deals,\n    readonlyTuple.fst))\n\nexport const selectAllNorthSouthPairs = memoize(\n  flow(\n    selectAllDeals,\n    readonlyArray.map(flow(\n      serializedDealL.reverseGet,\n      deal => [deal.N, deal.S] as const))))\n\nexport const selectProgress = memoize((state: State) => ({\n  deals: state.deals[1],\n  results: state.results[1],\n}))\n\nexport const selectResultsByPath = memoize(({ state, path }: { state: State, path: SerializedBidPath }) =>\n  pipe(state.results[0],\n    readonlyRecord.lookup(path),\n    option.toNullable))","import { readonlyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\n\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\ninterface State {\n  implicitPass: boolean\n  generateCount: number\n}\n\nconst initialState: State = {\n  implicitPass: false,\n  generateCount: 10000\n}\n\nconst name = 'settings'\nconst slice = createSlice({\n  name,\n  initialState,\n  reducers: {\n    setInitial: (state, action: PayloadAction<SettingsState>) => {\n      pipe(Object.keys(action.payload) as ReadonlyArray<keyof State>,\n        readonlyArray.map(p => (state as any)[p] = action.payload[p] as any))\n    },\n    setProperty: {\n      reducer: (state, action: PayloadAction<any, string, keyof State>) => {\n        (state as any)[action.meta] = action.payload\n      },\n      prepare: <K extends keyof State, V extends State[K]>(key: K, value: V) =>\n        ({ payload: value, meta: key })\n    }\n  }\n})\n\nexport const { setProperty: setSettingsProperty, setInitial: setInitialSettings } = slice.actions\nexport type SettingsState = State\nexport default slice.reducer","import { number, option, ord, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport { ReadonlyNonEmptyArray } from 'fp-ts/lib/ReadonlyNonEmptyArray';\nimport memoize from 'proxy-memoize';\nimport { combineEpics } from 'redux-observable';\n\nimport { AnyAction } from '@reduxjs/toolkit';\n\nimport { RootState } from '../app/store';\nimport { satisfiesPath, satisfiesPathWithoutSiblingCheck } from '../model/constraints';\nimport { serializedBidPathL, SerializedDeal, serializedDealL } from '../model/serialization';\nimport { BidInfo } from '../model/system';\nimport generator, { analyzeDealsEpic, analyzeResultsEpic, saveDealsToApiEpic, saveSolutionsToApiEpic, selectAllDeals } from './generator';\nimport selection, { selectHand } from './selection';\nimport settings from './settings';\nimport system, { selectAllCompleteBidPaths, selectBidPathUpToKey } from './system';\n\nconst reducers = {\n  system,\n  selection,\n  generator,\n  settings\n}\nexport default reducers\n\nexport const rootEpic = combineEpics<AnyAction, AnyAction, RootState>(\n  analyzeDealsEpic,\n  analyzeResultsEpic,\n  saveDealsToApiEpic,\n  saveSolutionsToApiEpic)\n\nexport const selectHandsSatisfySelectedPath = (state: RootState) =>\n  pipe(option.Do,\n    option.apS('key', state.selection.selectedBlockKey),\n    option.apS('opener', selectHand({ state: state.selection, type: 'opener' })),\n    option.apS('responder', selectHand({ state: state.selection, type: 'responder' })),\n    option.chain(o => pipe(\n      selectBidPathUpToKey({ state: state.system, key: o.key }),\n      option.fromEither,\n      option.chain(readonlyNonEmptyArray.fromReadonlyArray),\n      option.map(satisfiesPathWithoutSiblingCheck(o.opener, o.responder)))),\n    option.toNullable)\n\ninterface BidResult {\n  path: ReadonlyNonEmptyArray<BidInfo>\n  result: boolean\n}\nexport const selectPathsSatisfyHands = memoize((state: RootState) : ReadonlyArray<BidResult> | null =>\n  pipe(option.Do,\n    option.apS('opener', selectHand({ state: state.selection, type: 'opener' })),\n    option.apS('responder', selectHand({ state: state.selection, type: 'responder' })),\n    option.map(o => pipe(\n      selectAllCompleteBidPaths({ state: state.system, options: state.settings }),\n      readonlyArray.map(path => ({\n        path,\n        result: satisfiesPath(o.opener, o.responder)(path)\n      })))),\n    option.toNullable))\n\nexport interface BidPathResult {\n  path: ReadonlyNonEmptyArray<BidInfo>\n  count: number\n  deals: ReadonlyNonEmptyArray<SerializedDeal>\n}\nconst ordStats = pipe(\n  number.Ord,\n  ord.reverse,\n  ord.contramap<number, BidPathResult>(r => r.count))\n\nexport const selectSatisfyStats = memoize((state: RootState) : ReadonlyArray<BidPathResult> | null =>\n  pipe(readonlyArray.Do,\n    readonlyArray.apS('deal', selectAllDeals(state.generator)),\n    readonlyArray.apS('path', selectAllCompleteBidPaths({ state: state.system, options: state.settings })),\n    readonlyArray.map(ra => ({\n      deal: ra.deal,\n      path: ra.path,\n      result: pipe(ra.deal, serializedDealL.reverseGet, d => satisfiesPath(d[\"N\"], d[\"S\"]))(ra.path)\n    })),\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.map(\n      flow(\n        readonlyNonEmptyArray.groupBy(x =>\n          pipe(x.path,\n            readonlyNonEmptyArray.map(p => p.bid),\n            serializedBidPathL.get)),\n        readonlyRecord.filterMap(flow(\n          readonlyNonEmptyArray.filter(a => a.result),\n          option.map(r => ({\n            path: r[0].path,\n            count: r.length,\n            deals: pipe(r, readonlyNonEmptyArray.map(x => x.deal)),\n          })))),\n        readonlyRecord.toReadonlyArray,\n        readonlyArray.map(readonlyTuple.snd),\n        readonlyArray.sort(ordStats))),\n    option.toNullable))","import { option } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport JSONPretty from 'react-json-pretty';\n\nimport { useAppSelector } from '../app/hooks';\nimport { selectHandsSatisfySelectedPath } from '../reducers';\nimport { selectBidByKey, selectPathUpToKey } from '../reducers/system';\n\nconst SelectionDetails = () => {\n  const selected = useAppSelector(state => state.selection.selectedBlockKey)\n\n  const path = useAppSelector(state => pipe(selected,\n    option.chain(key => selectPathUpToKey({ state: state.system, key })),\n    option.toNullable))\n  const bid = useAppSelector(state => pipe(selected,\n    option.chain(key => selectBidByKey({ state: state.system, key })),\n    option.toNullable))\n  const satisfies = useAppSelector(selectHandsSatisfySelectedPath)\n\n  return (\n    <section>\n      <h3>Selection</h3>\n\n      {path && <div>\n        <h4>Selected Path</h4>\n        {path.map(x => x).join(\" > \")}\n      </div>}\n\n      {bid && <div>\n        <h4>Selected Bid</h4>\n        <JSONPretty data={bid} />\n        {satisfies !== null && <div>\n        <h4>Satisfies</h4>\n        {satisfies.toString()}\n      </div>}\n      </div>}\n    </section>\n  )\n}\n\nexport default SelectionDetails","import { constVoid, flow, pipe } from 'fp-ts/lib/function';\nimport { useCallback, useEffect } from 'react';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { setInitialSettings, setSettingsProperty, SettingsState } from '../reducers/settings';\n\ninterface SettingsValueProps<K, V> {\n  label?: string\n  prop: K\n  parse: (value: string) => V\n  children?: (props: { value: V, onChange: (v: string) => void }) => JSX.Element\n  onChanged?: (v: V) => void\n}\nconst SettingsItem = <K extends keyof SettingsState>({ label, prop, parse, onChanged, children }: SettingsValueProps<K, SettingsState[K]>) => {\n  const value = useAppSelector(state => state.settings[prop])\n  const dispatch = useAppDispatch()\n  const onChange = useCallback((newValue: typeof value) => {\n    dispatch(setSettingsProperty(prop, newValue))\n    onChanged && onChanged(newValue)\n  }, [dispatch, onChanged, prop])\n  return (\n    <p>\n      <span>{label ?? prop}</span>\n      <span>{children\n        ? children({ value, onChange: flow(parse, onChange, constVoid) })\n        : <input type=\"text\" value={value.toString()} onChange={e => pipe(e.target.value, parse, onChange)} style={{width: \"100px\"}} />\n      }</span>\n    </p>\n  )\n}\n\nconst key = \"settings\"\nconst Settings = () => {\n  const settings = useAppSelector(state => state.settings)\n  const dispatch = useAppDispatch()\n  useEffect(() => {\n    const stored = localStorage.getItem(key)\n    if (stored !== null) {\n      const settings: SettingsState = JSON.parse(stored)\n      dispatch(setInitialSettings(settings))\n    }\n  }, [dispatch])\n  const onChanged = useCallback((prop: keyof SettingsState, value: SettingsState[typeof prop]) => {\n    const newSettings: SettingsState = {...settings, [prop]: value }\n    localStorage.setItem(key, JSON.stringify(newSettings))\n  }, [settings])\n  return (\n    <section>\n      <SettingsItem label=\"Implicit Pass\" prop=\"implicitPass\" parse={s => s === \"true\"} onChanged={v => onChanged(\"implicitPass\", v)}>\n        {({ value, onChange}) =>\n          <input type=\"checkbox\" checked={value} onChange={e => onChange(e.target.checked.toString())} />\n      }</SettingsItem>\n      <SettingsItem label=\"Generate Count\" prop=\"generateCount\" parse={parseInt} onChanged={v => onChanged(\"generateCount\", v)} />\n    </section>\n  )\n}\n\nexport default Settings","import * as aq from 'arquero';\nimport { option, readonlyArray, readonlyNonEmptyArray, readonlyRecord, readonlyTuple, semigroup } from 'fp-ts';\nimport { sequenceT } from 'fp-ts/lib/Apply';\nimport { flow, pipe } from 'fp-ts/lib/function';\nimport * as iso from 'monocle-ts/Iso';\nimport { DoubleDummyTable } from '../workers/dds.worker';\nimport { flattenNestedCounts } from './analyze';\nimport { Direction, directions, Strain, strains } from './bridge';\n\n\nconst SerializedKeyL : iso.Iso<readonly [Direction, Strain], string> = iso.iso(\n  ([d, s]) => d + s,\n  s => [s.charAt(0) as Direction, s.charAt(1) as Strain] as const\n)\n\nconst columns =\n  pipe(\n    sequenceT(readonlyNonEmptyArray.Apply)(\n      directions,\n      strains),\n    readonlyNonEmptyArray.map(SerializedKeyL.get))\n    \nconst toRow = (ddt: DoubleDummyTable) =>\n  pipe(ddt,\n    flattenNestedCounts,\n    readonlyArray.map(({ outerKey: direction, innerKey: strain, value: count }) => [`${direction}${strain}`, count] as const),\n    readonlyRecord.fromFoldable(semigroup.first<number>(), readonlyArray.Foldable)\n)\nexport const getStats = flow(\n  readonlyArray.map(toRow),\n  aq.from)\n\nexport const aggregate = (f: (field: any) => number) => (table: aq.internal.ColumnTable): DoubleDummyTable =>\n  pipe(columns,\n    readonlyNonEmptyArray.groupBy(c => c),\n    readonlyRecord.map(c => f(c)),\n    x => table.rollup(x),\n    table => table.object() as readonlyRecord.ReadonlyRecord<string, number>,\n    readonlyRecord.toReadonlyArray,\n    readonlyArray.map(readonlyTuple.mapFst(SerializedKeyL.reverseGet)),\n    readonlyNonEmptyArray.fromReadonlyArray,\n    option.fold(() => ({}), flow(\n      readonlyNonEmptyArray.groupBy(([[_, strain], __]) => strain),\n      readonlyRecord.map(flow(\n        readonlyNonEmptyArray.groupBy(([[direction, _], __]) => direction),\n        readonlyRecord.map(flow(\n          readonlyNonEmptyArray.head,\n          ([_, agg]) => agg)))))))\n\nexport const average = aggregate(aq.op.mean)\nexport const stdev = aggregate(aq.op.stdev)","import { Fragment } from 'react';\nimport styled from 'styled-components';\n\nimport { ContractBid, NonContractBid } from '../../model/bridge';\nimport { ConstrainedBid } from '../../model/constraints';\n\nconst SuitSpan = styled.span `\n  &.S::after { content: \"\"; color: #0000FF; }\n  &.H::after { content: \"\"; color: #FF0000; }\n  &.D::after { content: \"\"; color: #FFA500; }\n  &.C::after { content: \"\"; color: #32CD32; }\n  &.N::after { content: \"NT\" }\n`\n\nconst ContractBidView = (bid: ContractBid) =>\n  <>\n    <span>{bid.level}</span>\n    <SuitSpan className={bid.strain}></SuitSpan>\n  </>\n\nconst NonContractBidView = ({ bid }: { bid: NonContractBid }) =>\n  <span>{bid}</span>\n\ninterface Props {\n  path: ReadonlyArray<ConstrainedBid>\n}\nconst BidPath = ({ path }: Props) => \n  <>{path.map(b => b.bid ).map((bid, i) =>\n    <Fragment key={i}>\n      &nbsp;\n      {typeof bid === \"string\"\n        ? <NonContractBidView bid={bid} />\n        : <ContractBidView {...bid} />}\n    </Fragment>)\n  }</>\n\nexport default BidPath","import { readonlyArray, readonlyRecord, readonlyTuple } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport styled from 'styled-components';\nimport { getOrdGroupedHand, groupHandBySuits, Hand, Rank, rankStrings, Suit } from '../../model/deck';\n\n\nconst RankList = styled.ol `\n  padding-left: 0;\n`\n\nconst RankListItem = styled.li `\n  list-style-type: none;\n  display: inline;\n  float: left;\n`\n\ninterface RankProps {\n  rank: Rank\n}\nconst RankView = ({ rank }: RankProps) =>\n  <RankListItem>{rankStrings[rank - 2]}</RankListItem>\n\nconst SuitList = styled.ol `\n  white-space: nowrap;\n  width: 15em;\n  margin: 0;\n  padding-left: 0;\n  list-style: decimal url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) inside;\n`\n\nconst suitBase = `\n  &.S::before { content: \"\"; color: #0000FF }\n  &.H::before { content: \"\"; color: #FF0000 }\n  &.D::before { content: \"\"; color: #FFA500 }\n  &.C::before { content: \"\"; color: #32CD32 }\n`\n\nconst SuitListItem = styled.li `\n  display: inline;\n  &::before {\n    display: inline;\n    float: left;\n    margin-left: 5px;\n  }\n  ${suitBase}\n`\n\ninterface SuitProps {\n  suit: Suit\n  ranks: ReadonlyArray<Rank>\n}\nconst SuitView = ({ suit, ranks }: SuitProps) => {\n  return <SuitListItem className={suit}>\n    <RankList>\n      {ranks.map((r, i) => <RankView key={i} rank={r} />)}\n      {ranks.length === 0 && <RankListItem>-</RankListItem> }\n    </RankList>\n </SuitListItem>\n}\n\ninterface HandProps {\n  hand: Hand\n}\nconst HandView = ({ hand }: HandProps) => {\n  const groupedHand = groupHandBySuits(hand)\n  return (\n    <SuitList>\n      {pipe(groupedHand,\n        readonlyRecord.mapWithIndex((suit, ranks) =>\n          <SuitView key={suit} suit={suit} ranks={ranks} />),\n        readonlyRecord.toReadonlyArray,\n        readonlyArray.sort(getOrdGroupedHand<JSX.Element>()),\n        readonlyArray.map(readonlyTuple.snd))}\n    </SuitList>\n  )\n}\n\nexport default HandView","import styled from 'styled-components';\nimport { directions, strains } from '../../model/bridge';\nimport { serializedDealL } from '../../model/serialization';\nimport { DoubleDummyResult, DoubleDummyTable } from '../../workers/dds.worker';\nimport HandView from './HandView';\n\n\nconst suitBase = `\n  &.S::before { content: \"\"; color: #0000FF }\n  &.H::before { content: \"\"; color: #FF0000 }\n  &.D::before { content: \"\"; color: #FFA500 }\n  &.C::before { content: \"\"; color: #32CD32 }\n`\n\nconst StrainSpan = styled.span `\n  ${suitBase}\n  &.N::before { content: \"NT\"; color: #000000; font-size: 12px; }\n`\n\ninterface DoubleDummyTableProps {\n  table: DoubleDummyTable\n}\nexport const DoubleDummyTableView = ({ table }: DoubleDummyTableProps) => {\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th></th>\n          {strains.map((s, i) => <th style={{fontWeight: \"normal\", verticalAlign: \"middle\"}} key={i}><StrainSpan className={s} /></th>)}\n        </tr>\n      </thead>\n      <tbody>\n        {directions.map((d, i) => <tr key={i}>\n          <td>{d}</td>\n          {strains.map((s, i) => <td key={i}>{Math.round(table[s][d] * 100) / 100}</td>)}\n        </tr>)}\n      </tbody>\n    </table>\n  )\n}\n\ninterface Props {\n  result: DoubleDummyResult\n}\nconst DoubleDummyResultView = ({ result }: Props) => {\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th></th>\n          {strains.map((s, i) => <th style={{fontWeight: \"normal\", verticalAlign: \"middle\"}} key={i}><StrainSpan className={s} /></th>)}\n        </tr>\n      </thead>\n      <tbody>\n        {directions.map((d, i) => <tr key={i}>\n          <td>{d}</td>\n          {strains.map((s, i) => <td key={i}>{result.results[s][d]}</td>)}\n          <td><HandView hand={serializedDealL.reverseGet(result.board.deal)[d]} /></td>\n        </tr>)}\n      </tbody>\n    </table>\n  )\n}\n\nexport default DoubleDummyResultView","import { either, readonlyNonEmptyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { draw } from 'io-ts/lib/Decoder';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { serializedBidPathL } from '../model/serialization';\nimport { average, getStats, stdev } from '../model/stats';\nimport { BidPathResult, selectSatisfyStats } from '../reducers';\nimport { generate, getResults, selectProgress, selectResultsByPath } from '../reducers/generator';\nimport { selectAllCompleteBidPaths, selectErrors, selectSystemValid } from '../reducers/system';\nimport BidPath from './core/BidPath';\nimport { DoubleDummyTableView } from './core/DoubleDummyResultView';\n\ninterface StatsPathProps {\n  result: BidPathResult\n}\nconst StatsPath = ({ result }: StatsPathProps) => {\n  const dispatch = useAppDispatch()\n  const dds = useAppSelector(state => pipe(\n    result.path,\n    readonlyNonEmptyArray.map(p => p.bid),\n    serializedBidPathL.get,\n    path => selectResultsByPath({ state: state.generator, path })))\n  const stats = dds && getStats(pipe(dds, readonlyNonEmptyArray.map(d => d.results)))\n  const averages = stats && average(stats)\n  const stdevs = stats && stdev(stats)\n  return (\n    <>\n      <BidPath path={result.path} />\n      : &nbsp;\n      <span>{result.count.toString()}</span>\n      {averages !== null && <section>\n        <h4>Average</h4>\n        {averages !== null && <DoubleDummyTableView table={averages} />}\n      </section>}\n      {stdevs !== null && <section>\n        <h4>Std. Dev.</h4>\n        <DoubleDummyTableView table={stdevs} />\n      </section>}\n      {dds === null && <button onClick={e => dispatch(getResults({ path: result.path, deals: result.deals }))}>DDS</button>}\n      {/* {dds === null\n        ? <button onClick={e => dispatch(getResults({ path: result.path, deals: result.deals }))}>DDS</button>\n        : <ul>{dds.map((ddr, i) => <li  key={i}><DoubleDummyResultView result={ddr} /></li>)}</ul>} */}\n    </>)\n}\n\nconst SatisfyStats = () => {\n  const stats = useAppSelector(selectSatisfyStats)\n  return (\n    <>\n      {stats !== null && <div>\n        <h3>Results</h3>\n        <ul>\n          {stats.map((result, i) => <li key={i}><StatsPath result={result} /></li>)}\n        </ul>\n      </div>}\n    </>\n  )\n}\n\nconst Progress = () => {\n  const progress = useAppSelector(state => selectProgress(state.generator))\n  return <div>\n    <p>Deals: {progress.deals} remaining</p>\n    <p>Results: {progress.results} remaining</p>\n  </div>\n}\n\nconst Stats = () => {\n  const generating = useAppSelector(state => pipe(state.generator.working))\n  const count = useAppSelector(state => state.settings.generateCount)\n  const dispatch = useAppDispatch()\n  const rules = useAppSelector(state => selectAllCompleteBidPaths({ state: state.system, options: state.settings }))\n  const errors = useAppSelector(state => selectErrors(state.system))\n  const valid = useAppSelector(state => selectSystemValid({ state: state.system, options: state.settings }))\n  const showGenerate = rules !== null && rules.length > 0 && errors.length === 0 && either.isRight(valid)\n  return (\n    <section>\n      <h3>Stats</h3>\n      {!showGenerate && <div>\n        <p>Select the system and/or fix errors</p>\n        {rules === null && <p>No complete rules found or system not selected</p>}\n        {either.isLeft(valid) && <p>System is not valid</p>}\n        {errors.length > 0 && <div>\n          <h4>Errors</h4>\n          <ul>{errors.map((e, i) => <li key={i}><pre>{draw(e)}</pre></li>)}</ul>\n        </div>}\n      </div>}\n      {showGenerate && <div>\n        <button type=\"button\" onClick={() => dispatch(generate(count))}>Generate deals</button>\n        {generating ? <span>Generating...</span> : <span>Ready!</span>}\n        {generating && <Progress />}\n        {!generating && <SatisfyStats />}\n      </div>}\n    </section>\n  )\n}\n\nexport default Stats","import { either, option } from \"fp-ts\"\n\nimport { DecodeError } from \"io-ts/Decoder\"\nimport { draw } from \"io-ts/lib/Decoder\"\nimport { pipe } from \"fp-ts/lib/function\"\n\ninterface OptionProps<T> {\n  value: option.Option<T>\n  children: (value: T) => JSX.Element\n  onNone?: () => JSX.Element\n}\nexport const Option = <T extends {}>({value, children: onSuccess, onNone }: OptionProps<T>) => \n  pipe(value, option.fold(\n    () => onNone ? onNone() : <></>,\n    onSuccess))\n\ninterface DecodeProps<T> {\n  value: either.Either<DecodeError, T>\n  children: (value: T) => JSX.Element\n  onError?: (error: DecodeError) => JSX.Element\n}\nexport const Decode = <T extends {}>({value, children: onSuccess, onError }: DecodeProps<T>) => \n  pipe(value, either.fold(\n    e => onError ? onError(e) : <span>{draw(e)}</span>,\n    onSuccess))","import { option, readonlyNonEmptyArray } from 'fp-ts';\nimport { pipe } from 'fp-ts/lib/function';\nimport { useState } from 'react';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { BidPaths } from '../model/system';\nimport { genHandsMatchingExactlyOneOf, genHandsMatchingMoreThanOneOf, genHandsNotMatchingAnyOf, genOnce, getHandsMatchingPath } from '../reducers/selection';\nimport { selectAllCompleteBidPaths, selectCompleteBidPathUpToKey } from '../reducers/system';\n\nconst GenerateOnce = () => {\n  const dispatch = useAppDispatch()\n  return (\n    <button type=\"button\" onClick={() => dispatch(genOnce())}>Random</button>\n  )\n}\n\ninterface GenerateSystemProps {\n  bidPaths: BidPaths | null\n}\n\nconst GenerateMatchZero = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  const [minHcp, setMinHcp] = useState<number>(11)\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsNotMatchingAnyOf(bidPaths, minHcp))}>Zero</button>\n      Min HCP\n      <input type=\"number\" style={{width: 50}} value={minHcp} onChange={e => setMinHcp(parseInt(e.target.value))} />\n    </span>}\n  </>\n}\n\nconst GenerateMatchOne = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsMatchingExactlyOneOf(bidPaths))}>One</button>\n    </span>}\n  </>\n}\n\nconst GenerateMatchMany = ({ bidPaths }: GenerateSystemProps) => {\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPaths && <span>\n      <button type=\"button\" onClick={() => dispatch(genHandsMatchingMoreThanOneOf(bidPaths))}>Many</button>\n    </span>}\n  </>\n}\n\nconst GenerateMatchSelected = () => {\n  const selected = useAppSelector(state => state.selection.selectedBlockKey)\n  const bidPath = useAppSelector(state => pipe(selected,\n    option.chain(key => selectCompleteBidPathUpToKey({ state: state.system, key })),\n    option.toNullable))\n  const dispatch = useAppDispatch()\n  return <>\n    {bidPath && <button type=\"button\" onClick={() => dispatch(getHandsMatchingPath(bidPath))}>Selected</button>}\n  </>\n}\n\nconst SelectionGenerators = () => {\n  const bidPaths = useAppSelector(state =>\n    pipe(selectAllCompleteBidPaths({ state: state.system, options: state.settings }),\n      readonlyNonEmptyArray.fromReadonlyArray,\n      option.toNullable)) \n  return (\n    <section>\n      <h4>Generate Hands</h4>\n      <GenerateOnce />\n      <GenerateMatchSelected />\n      <GenerateMatchZero bidPaths={bidPaths} />\n      <GenerateMatchOne bidPaths={bidPaths} />\n      <GenerateMatchMany bidPaths={bidPaths} />\n    </section>)\n}\n\nexport default SelectionGenerators","import { option, readonlyRecord } from 'fp-ts';\nimport { constVoid, flow, pipe } from 'fp-ts/lib/function';\nimport { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\nimport { useAppDispatch, useAppSelector } from '../app/hooks';\nimport { serializedHandL } from '../model/serialization';\nimport { handE } from '../parse/hand';\nimport { AuctionPositionType, getResult, selectHand, setHand } from '../reducers/selection';\nimport DoubleDummyResultView from './core/DoubleDummyResultView';\nimport HandView from './core/HandView';\nimport { Option } from './core/Monad';\nimport SelectionGenerators from './SelectionGenerators';\n\ninterface HandInputProps {\n  type: AuctionPositionType\n}\nconst HandInput = ({ type }: HandInputProps) => {\n  const dispatch = useAppDispatch()\n  const [value, setValue] = useState<string>(\"\")\n  const storageKey = `hand.${type}`\n\n  const encodedHand = useAppSelector(state => pipe(\n    selectHand({ state: state.selection, type }),\n    option.map(handE.encode),\n    option.toNullable))\n\n  const onSetHand = useCallback((hand: string) => {\n    setValue(hand)\n    dispatch(setHand(hand, type))\n  }, [dispatch, type])\n\n  useEffect(() => {\n    const savedHand = localStorage.getItem(storageKey)\n    if (savedHand) {\n      onSetHand(savedHand)\n    }\n  }, [onSetHand, storageKey, type])\n\n  return <input type=\"text\" placeholder=\"AKQJ.T987.654.32\" value={encodedHand ?? value} onChange={e => onSetHand(e.target.value)} onBlur={() => localStorage.setItem(storageKey, value)} />\n}\n\nconst HandCol = styled.th `\n  width: 15em;\n`\n\nconst HandEditor = () => {\n  const dispatch = useAppDispatch()\n  const [o, r] = [\n    useAppSelector(state => selectHand({ state: state.selection, type: 'opener' })),\n    useAppSelector(state => selectHand({ state: state.selection, type: 'responder' }))\n  ]\n  const getResultCallback = useCallback(() => pipe(\n    option.Do,\n    option.apS('opener', o),\n    option.apS('responder', r),\n    option.map(flow(\n      readonlyRecord.map(serializedHandL.get),\n      getResult,\n      dispatch)),\n    constVoid), [dispatch, o, r])\n\n  const result = useAppSelector(state => state.selection.result)\n  \n  return (\n    <>\n      <table>\n        <thead>\n          <tr>\n            <HandCol>Opener</HandCol>\n            <HandCol>Responder</HandCol>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><HandInput type=\"opener\" /></td>\n            <td><HandInput type=\"responder\" /></td>\n          </tr>\n          <tr>\n            <td><Option value={o}>{hand => <HandView hand={hand} />}</Option></td>\n            <td><Option value={r}>{hand => <HandView hand={hand} />}</Option></td>\n          </tr>\n        </tbody>\n      </table>\n      <SelectionGenerators />\n      <p>\n        <button type=\"button\" onClick={getResultCallback}>Solution</button> \n        {result && <DoubleDummyResultView result={result} /> }\n      </p>\n    </>\n  )\n}\n\nexport default HandEditor","import { either } from 'fp-ts';\nimport { constTrue, identity, pipe } from 'fp-ts/lib/function';\nimport JSONPretty from 'react-json-pretty';\n\nimport { useAppSelector } from '../app/hooks';\nimport { selectPathsSatisfyHands } from '../reducers';\nimport { selectSystemValid } from '../reducers/system';\nimport BidPath from './core/BidPath';\nimport HandEditor from './HandEditor';\n\nconst TestHands = () => {\n  const valid = useAppSelector(state => selectSystemValid({ state: state.system, options: state.settings }))\n  const results = useAppSelector(selectPathsSatisfyHands)\n  \n  return (\n    <section>\n      <h3>Test Hands</h3>\n      <HandEditor />\n      {either.isLeft(valid) && <>\n        <h4>Validation Error</h4>\n        <JSONPretty data={pipe(valid, either.foldW(identity, identity))} />\n      </>}\n      {results !== null && <div>\n        <h4>Results</h4>\n        <ul>\n          {results.map((r, i) => <li key={i}>\n            <BidPath path={r.path} />\n            : &nbsp;\n            <span>{r.result.toString()}</span>\n          </li>)}\n        </ul>\n      </div>}\n    </section>\n  )\n}\n\nexport default TestHands","import Editor from './Editor';\nimport SelectionDetails from './SelectionDetails';\nimport Settings from './Settings';\nimport Stats from './Stats';\nimport TestHands from './TestHands';\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <div style={{display: \"inline-block\", width: '50%'}}>\n        <div style={{float: \"left\"}}>\n          <Editor />\n        </div>\n        <div style={{float: \"right\", width: \"300px\"}}>\n          <Settings />\n        </div>\n        <div style={{clear: \"both\"}}>\n          <Stats />\n        </div>\n      </div>\n      <div style={{display: \"inline-block\", width: '50%', float: \"right\"}}>\n        <div style={{display: \"inline-block\", float: 'right'}}>\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge#documentation\">Documentation</a>\n          &nbsp;|&nbsp;\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge/discussions\">Share ideas</a>\n          &nbsp;|&nbsp;\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/kdblocher/bridge/issues/new\">Report issue</a>\n        </div>\n        <TestHands />\n        <SelectionDetails />\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import { Action, AnyAction, ThunkAction, configureStore } from '@reduxjs/toolkit';\nimport reducer, { rootEpic } from '../reducers';\n\nimport { createEpicMiddleware } from 'redux-observable';\n\ntype R = typeof reducer\nexport type RootState = { [K in keyof R]: ReturnType<R[K]> }\n\nconst epicMiddleware = createEpicMiddleware<AnyAction, AnyAction, RootState>()\nexport const store = configureStore({\n  reducer: reducer,\n  middleware: (getDefaultMiddleware => [...getDefaultMiddleware(), epicMiddleware])\n})\nepicMiddleware.run(rootEpic)\n\nexport type AppDispatch = typeof store.dispatch;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;","import './index.css';\n\nimport * as serviceWorker from './serviceWorker';\n\nimport App from './components';\nimport { Provider } from 'react-redux';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { store } from './app/store';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}